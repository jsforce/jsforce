!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).jsforce=t()}(function(){return function r(i,o,s){function a(e,t){if(!o[e]){if(!i[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=o[e]={exports:{}},i[e][0].call(n.exports,function(t){return a(i[e][1][t]||t)},n,n.exports,r,i,o,s)}return o[e].exports}for(var u="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,n){"use strict";var r=t("../core");r.browser=t("./client"),t("../api"),e.exports=r},{"../api":8,"../core":20,"./client":15}],2:[function(t,e,n){"use strict";e.exports="1.10.0"},{}],3:[function(t,e,n){"use strict";e.exports={inherits:t("inherits"),util:t("util"),events:t("events"),"lodash/core":t("lodash/core"),"readable-stream":t("readable-stream"),multistream:t("multistream"),"./VERSION":t("./VERSION"),"./cache":t("./cache"),"./connection":t("./connection"),"./core":t("./core"),"./csv":t("./csv"),"./date":t("./date"),"./http-api":t("./http-api"),"./logger":t("./logger"),"./oauth2":t("./oauth2"),"./process":t("./process"),"./promise":t("./promise"),"./query":t("./query"),"./quick-action":t("./quick-action"),"./record-stream":t("./record-stream"),"./record":t("./record"),"./soap":t("./soap"),"./sobject":t("./sobject"),"./soql-builder":t("./soql-builder"),"./transport":t("./transport")}},{"./VERSION":2,"./cache":18,"./connection":19,"./core":20,"./csv":21,"./date":22,"./http-api":23,"./logger":24,"./oauth2":25,"./process":26,"./promise":27,"./query":28,"./quick-action":29,"./record":31,"./record-stream":30,"./soap":33,"./sobject":34,"./soql-builder":35,"./transport":36,events:48,inherits:85,"lodash/core":89,multistream:90,"readable-stream":108,util:118}],4:[function(t,e,n){"use strict";function r(t,e){this._report=t,this._conn=t._conn,this.id=e}var o=t("lodash/core"),i=t("../core");t("../promise");r.prototype.retrieve=function(t){var e=this._conn,n=this._report,n=[e._baseUrl(),"analytics","reports",n.id,"instances",this.id].join("/");return e.request(n).thenCall(t)};function s(t,e){this._conn=t,this.id=e}s.prototype.describe=function(t){var e=[this._conn._baseUrl(),"analytics","reports",this.id,"describe"].join("/");return this._conn.request(e).thenCall(t)},s.prototype.delete=s.prototype.del=s.prototype.destroy=function(t){var e=[this._conn._baseUrl(),"analytics","reports",this.id].join("/");return this._conn.request({method:"DELETE",url:e}).thenCall(t)},s.prototype.clone=function(t,e){var n=[this._conn._baseUrl(),"analytics","reports"].join("/"),t={reportMetadata:{name:t}},t={method:"POST",url:n+="?cloneId="+this.id,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return this._conn.request(t).thenCall(e)},s.prototype.explain=function(t){var e="/query/?explain="+this.id;return this._conn.request(e).thenCall(t)},s.prototype.run=s.prototype.exec=s.prototype.execute=function(t,e){t=t||{},o.isFunction(t)&&(e=t,t={});var n=[this._conn._baseUrl(),"analytics","reports",this.id].join("/");n+="?includeDetails="+(t.details?"true":"false");n={method:t.metadata?"POST":"GET",url:n};return t.metadata&&(n.headers={"Content-Type":"application/json"},n.body=JSON.stringify(t.metadata)),this._conn.request(n).thenCall(e)},s.prototype.executeAsync=function(t,e){t=t||{},o.isFunction(t)&&(e=t,t={});var n=[this._conn._baseUrl(),"analytics","reports",this.id,"instances"].join("/");t.details&&(n+="?includeDetails=true");n={method:"POST",url:n,body:""};return t.metadata&&(n.headers={"Content-Type":"application/json"},n.body=JSON.stringify(t.metadata)),this._conn.request(n).thenCall(e)},s.prototype.instance=function(t){return new r(this,t)},s.prototype.instances=function(t){var e=[this._conn._baseUrl(),"analytics","reports",this.id,"instances"].join("/");return this._conn.request(e).thenCall(t)};function a(t,e){this._conn=t,this.id=e}a.prototype.describe=function(t){var e=[this._conn._baseUrl(),"analytics","dashboards",this.id,"describe"].join("/");return this._conn.request(e).thenCall(t)},a.prototype.components=function(t,e){var n=[this._conn._baseUrl(),"analytics","dashboards",this.id].join("/"),r={};o.isFunction(t)?e=t:o.isArray(t)?r.componentIds=t:o.isString(t)&&(r.componentIds=[t]);r={method:"POST",url:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};return this._conn.request(r).thenCall(e)},a.prototype.status=function(t){var e=[this._conn._baseUrl(),"analytics","dashboards",this.id,"status"].join("/");return this._conn.request(e).thenCall(t)},a.prototype.refresh=function(t){var e={method:"PUT",url:[this._conn._baseUrl(),"analytics","dashboards",this.id].join("/"),body:""};return this._conn.request(e).thenCall(t)},a.prototype.clone=function(t,e,n){var r=[this._conn._baseUrl(),"analytics","dashboards"].join("/");r+="?cloneId="+this.id;var i={};o.isObject(t)?(i=t,n=e):(i.name=t,i.folderId=e);i={method:"POST",url:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)};return this._conn.request(i).thenCall(n)},a.prototype.delete=a.prototype.del=a.prototype.destroy=function(t){var e=[this._conn._baseUrl(),"analytics","dashboards",this.id].join("/");return this._conn.request({method:"DELETE",url:e}).thenCall(t)};function u(t){this._conn=t}u.prototype.report=function(t){return new s(this._conn,t)},u.prototype.reports=function(t){var e=[this._conn._baseUrl(),"analytics","reports"].join("/");return this._conn.request(e).thenCall(t)},u.prototype.dashboard=function(t){return new a(this._conn,t)},u.prototype.dashboards=function(t){var e=[this._conn._baseUrl(),"analytics","dashboards"].join("/");return this._conn.request(e).thenCall(t)},i.on("connection:new",function(t){t.analytics=new u(t)}),e.exports=u},{"../core":20,"../promise":27,"lodash/core":89}],5:[function(t,e,n){"use strict";function r(t){this._conn=t}t=t("../core");r.prototype._baseUrl=function(){return this._conn.instanceUrl+"/services/apexrest"},r.prototype._createRequestParams=function(t,e,n,r){var i={method:t,url:this._baseUrl()+e},e={};return r&&"object"==typeof r.headers&&(e=r.headers),/^(GET|DELETE)$/i.test(t)||(e["Content-Type"]="application/json"),i.headers=e,n&&(e=i.headers["Content-Type"],i.body=e&&"application/json"!==e?n:JSON.stringify(n)),i},r.prototype.get=function(t,e,n){return"function"==typeof e&&(n=e,e=void 0),this._conn.request(this._createRequestParams("GET",t,void 0,e)).thenCall(n)},r.prototype.post=function(t,e,n,r){"function"==typeof e&&(r=e,n=e=void 0),"function"==typeof n&&(r=n,n=void 0);n=this._createRequestParams("POST",t,e,n);return this._conn.request(n).thenCall(r)},r.prototype.put=function(t,e,n,r){"function"==typeof e&&(r=e,n=e=void 0),"function"==typeof n&&(r=n,n=void 0);n=this._createRequestParams("PUT",t,e,n);return this._conn.request(n).thenCall(r)},r.prototype.patch=function(t,e,n,r){"function"==typeof e&&(r=e,n=e=void 0),"function"==typeof n&&(r=n,n=void 0);n=this._createRequestParams("PATCH",t,e,n);return this._conn.request(n).thenCall(r)},r.prototype.del=r.prototype.delete=function(t,e,n){return"function"==typeof e&&(n=e,e=void 0),this._conn.request(this._createRequestParams("DELETE",t,void 0,e)).thenCall(n)},t.on("connection:new",function(t){t.apex=new r(t)}),e.exports=r},{"../core":20}],6:[function(y,m,t){(function(n){"use strict";function r(t,e,n,r,i){this._bulk=t,this.type=e,this.operation=n,this.options=r||{},this.id=i,this.state=this.id?"Open":"Unknown",this._batches={}}var t=y("inherits"),e=y("readable-stream"),i=e.Duplex,o=y("events"),c=y("lodash/core"),s=y("multistream"),a=y("../core"),u=y("../record-stream"),l=y("../promise"),h=y("../http-api");t(r,o.EventEmitter),r.prototype.info=function(t){return this._jobInfo||(this._jobInfo=this.check()),this._jobInfo.thenCall(t)},r.prototype.open=function(t){var e,n=this,r=this._bulk;r._logger;return this._jobInfo||("harddelete"===(e=this.operation.toLowerCase())&&(e="hardDelete"),e=['<?xml version="1.0" encoding="UTF-8"?>','<jobInfo  xmlns="http://www.force.com/2009/06/asyncapi/dataload">',"<operation>"+e+"</operation>","<object>"+this.type+"</object>",this.options.extIdField?"<externalIdFieldName>"+this.options.extIdField+"</externalIdFieldName>":"",this.options.concurrencyMode?"<concurrencyMode>"+this.options.concurrencyMode+"</concurrencyMode>":"",this.options.assignmentRuleId?"<assignmentRuleId>"+this.options.assignmentRuleId+"</assignmentRuleId>":"","<contentType>CSV</contentType>","</jobInfo>"].join(""),this._jobInfo=r._request({method:"POST",path:"/job",body:e,headers:{"Content-Type":"application/xml; charset=utf-8"},responseType:"application/xml"}).then(function(t){return n.emit("open",t.jobInfo),n.id=t.jobInfo.id,n.state=t.jobInfo.state,t.jobInfo},function(t){throw n.emit("error",t),t})),this._jobInfo.thenCall(t)},r.prototype.createBatch=function(){var t=new f(this),e=this;return t.on("queue",function(){e._batches[t.id]=t}),t},r.prototype.batch=function(t){var e=this._batches[t];return e||(e=new f(this,t),this._batches[t]=e),e},r.prototype.check=function(t){var e=this,n=this._bulk,r=n._logger;return this._jobInfo=this._waitAssign().then(function(){return n._request({method:"GET",path:"/job/"+e.id,responseType:"application/xml"})}).then(function(t){return r.debug(t.jobInfo),e.id=t.jobInfo.id,e.type=t.jobInfo.object,e.operation=t.jobInfo.operation,e.state=t.jobInfo.state,t.jobInfo}),this._jobInfo.thenCall(t)},r.prototype._waitAssign=function(t){return(this.id?l.resolve({id:this.id}):this.open()).thenCall(t)},r.prototype.list=function(t){var e=this,n=this._bulk,r=n._logger;return this._waitAssign().then(function(){return n._request({method:"GET",path:"/job/"+e.id+"/batch",responseType:"application/xml"})}).then(function(t){r.debug(t.batchInfoList.batchInfo);t=t.batchInfoList;return t=c.isArray(t.batchInfo)?t.batchInfo:[t.batchInfo]}).thenCall(t)},r.prototype.close=function(){var e=this;return this._changeState("Closed").then(function(t){return e.id=null,e.emit("close",t),t},function(t){throw e.emit("error",t),t})},r.prototype.abort=function(){var e=this;return this._changeState("Aborted").then(function(t){return e.id=null,e.emit("abort",t),t},function(t){throw e.emit("error",t),t})},r.prototype._changeState=function(e,t){var n=this,r=this._bulk,i=r._logger;return this._jobInfo=this._waitAssign().then(function(){var t=['<?xml version="1.0" encoding="UTF-8"?>','<jobInfo xmlns="http://www.force.com/2009/06/asyncapi/dataload">',"<state>"+e+"</state>","</jobInfo>"].join("");return r._request({method:"POST",path:"/job/"+n.id,body:t,headers:{"Content-Type":"application/xml; charset=utf-8"},responseType:"application/xml"})}).then(function(t){return i.debug(t.jobInfo),n.state=t.jobInfo.state,t.jobInfo}),this._jobInfo.thenCall(t)};var f=function(t,e){f.super_.call(this,{objectMode:!0}),this.job=t,this.id=e,this._bulk=t._bulk,this._deferred=l.defer(),this._setupDataStreams()};t(f,e.Writable),f.prototype._setupDataStreams=function(){var r=this,t={nullValue:"#N/A"};this._uploadStream=new u.Serializable,this._uploadDataStream=this._uploadStream.stream("csv",t),this._downloadStream=new u.Parsable,this._downloadDataStream=this._downloadStream.stream("csv",t),this.on("finish",function(){r._uploadStream.end()}),this._uploadDataStream.once("readable",function(){r.job.open().then(function(){r._uploadDataStream.pipe(r._createRequestStream())})});var n=this._dataStream=new i;n._write=function(t,e,n){r._uploadDataStream.write(t,e,n)},n.on("finish",function(){r._uploadDataStream.end()}),this._downloadDataStream.on("readable",function(){n.read(0)}),this._downloadDataStream.on("end",function(){n.push(null)}),n._read=function(t){for(var e;null!==(e=r._downloadDataStream.read());)n.push(e)}},f.prototype._createRequestStream=function(){var n=this,t=n._bulk,r=t._logger;return t._request({method:"POST",path:"/job/"+n.job.id+"/batch",headers:{"Content-Type":"text/csv"},responseType:"application/xml"},function(t,e){t?n.emit("error",t):(r.debug(e.batchInfo),n.id=e.batchInfo.id,n.emit("queue",e.batchInfo))}).stream()},f.prototype._write=function(t,e,n){t=c.clone(t),"insert"===this.job.operation?delete t.Id:"delete"===this.job.operation&&(t={Id:t.Id}),delete t.type,delete t.attributes,this._uploadStream.write(t,e,n)},f.prototype.stream=function(){return this._dataStream},f.prototype.run=f.prototype.exec=f.prototype.execute=function(t,e){var n=this;if("function"==typeof t&&(e=t,t=null),this._result)throw new Error("Batch already executed.");var r=l.defer();return this._result=r.promise,this._result.then(function(t){n._deferred.resolve(t)},function(t){n._deferred.reject(t)}),this.once("response",function(t){r.resolve(t)}),this.once("error",function(t){r.reject(t)}),c.isObject(t)&&c.isFunction(t.pipe)?t.pipe(this._dataStream):c.isArray(t)?(c.forEach(t,function(e){Object.keys(e).forEach(function(t){"boolean"==typeof e[t]&&(e[t]=String(e[t]))}),n.write(e)}),n.end()):c.isString(t)&&(this._dataStream.write(t,"utf8"),this._dataStream.end()),this.thenCall(e)},f.prototype.then=function(t,e,n){return this._deferred.promise.then(t,e,n)},f.prototype.thenCall=function(e){return c.isFunction(e)&&this.then(function(t){n.nextTick(function(){e(null,t)})},function(t){n.nextTick(function(){e(t)})}),this},f.prototype.check=function(t){var e=this._bulk,n=e._logger,r=this.job.id,i=this.id;if(!r||!i)throw new Error("Batch not started.");return e._request({method:"GET",path:"/job/"+r+"/batch/"+i,responseType:"application/xml"}).then(function(t){return n.debug(t.batchInfo),t.batchInfo}).thenCall(t)},f.prototype.poll=function(n,e){var r=this,i=this.job.id,o=this.id;if(!i||!o)throw new Error("Batch not started.");var s=(new Date).getTime(),a=function(){var t=(new Date).getTime();if(s+e<t){t=new Error("Polling time out. Job Id = "+i+" , batch Id = "+o);return t.name="PollingTimeout",t.jobId=i,t.batchId=o,void r.emit("error",t)}r.check(function(t,e){t?r.emit("error",t):"Failed"===e.state?0<parseInt(e.numberRecordsProcessed,10)?r.retrieve():r.emit("error",new Error(e.stateMessage)):"Completed"===e.state?r.retrieve():(r.emit("progress",e),setTimeout(a,n))})};setTimeout(a,n)},f.prototype.retrieve=function(t){var n=this,r=this._bulk,i=this.job.id,o=this.job,s=this.id;if(!i||!s)throw new Error("Batch not started.");return o.info().then(function(t){return r._request({method:"GET",path:"/job/"+i+"/batch/"+s+"/result"})}).then(function(t){var e;return e="query"===o.operation?(r._conn,t["result-list"].result,e=t["result-list"].result,c.map(c.isArray(e)?e:[e],function(t){return{id:t,batchId:s,jobId:i}})):c.map(t,function(t){return{id:t.Id||null,success:"true"===t.Success,errors:t.Error?[t.Error]:[]}}),n.emit("response",e),e}).fail(function(t){throw n.emit("error",t),t}).thenCall(t)},f.prototype.result=function(t){var e=this.job.id,n=this.id;if(!e||!n)throw new Error("Batch not started.");var r=new u.Parsable,i=r.stream("csv");this._bulk._request({method:"GET",path:"/job/"+e+"/batch/"+n+"/result/"+t,responseType:"application/octet-stream"}).stream().pipe(i);return r};var p=function(){p.super_.apply(this,arguments)};t(p,h),p.prototype.beforeSend=function(t){t.headers=t.headers||{},t.headers["X-SFDC-SESSION"]=this._conn.accessToken},p.prototype.isSessionExpired=function(t){return 400===t.statusCode&&/<exceptionCode>InvalidSessionId<\/exceptionCode>/.test(t.body)},p.prototype.hasErrorInResponseBody=function(t){return!!t.error},p.prototype.parseError=function(t){return{errorCode:t.error.exceptionCode,message:t.error.exceptionMessage}};function d(t){this._conn=t,this._logger=t._logger}d.prototype.pollInterval=1e3,d.prototype.pollTimeout=1e4,d.prototype._request=function(t,e){var n=this._conn;t=c.clone(t);n=[n.instanceUrl,"services/async",n.version].join("/");t.url=n+t.path;n={responseType:t.responseType};return delete t.path,delete t.responseType,new p(this._conn,n).request(t).thenCall(e)},d.prototype.load=function(t,e,n,r,i){var o=this;if(!t||!e)throw new Error("Insufficient arguments. At least, 'type' and 'operation' are required.");c.isObject(n)&&n.constructor===Object||(i=r,r=n,n=null);var s=this.createJob(t,e,n);s.once("error",function(t){u&&u.emit("error",t)});function a(){u=null,s.close()}var u=s.createBatch();return u.on("response",a),u.on("error",function(t){"PollingTimeout"!==t.name&&a()}),u.on("queue",function(){u.poll(o.pollInterval,o.pollTimeout)}),u.execute(r,i)},d.prototype.query=function(t){var e=t.replace(/\([\s\S]+\)/g,"").match(/FROM\s+(\w+)/i);if(!e)throw new Error("No sobject type found in query, maybe caused by invalid SOQL.");var e=e[1],n=this,r=new u.Parsable,i=r.stream("csv");return this.load(e,"query",t).then(function(t){t=t.map(function(t){return n.job(t.jobId).batch(t.batchId).result(t.id).stream()});s(t).pipe(i)}).fail(function(t){r.emit("error",t)}),r},d.prototype.createJob=function(t,e,n){return new r(this,t,e,n)},d.prototype.job=function(t){return new r(this,null,null,null,t)},a.on("connection:new",function(t){t.bulk=new d(t)}),m.exports=d}).call(this,y("_process"))},{"../core":20,"../http-api":23,"../promise":27,"../record-stream":30,_process:92,events:48,inherits:85,"lodash/core":89,multistream:90,"readable-stream":108}],7:[function(t,e,n){"use strict";var r=t("inherits"),i=t("lodash/core"),o=t("../core"),s=t("../promise"),a=e.exports=function(t){this._conn=t};a.prototype._request=function(t,e){return/^(put|post|patch)$/i.test(t.method)&&i.isObject(t.body)&&(t.headers={"Content-Type":"application/json"},t.body=JSON.stringify(t.body)),t.url=this._normalizeUrl(t.url),this._conn.request(t,e)},a.prototype._normalizeUrl=function(t){return 0===t.indexOf("/chatter/")||0===t.indexOf("/connect/")?"/services/data/v"+this._conn.version+t:/^\/v[\d]+\.[\d]+\//.test(t)?"/services/data"+t:0!==t.indexOf("/services/")&&"/"===t[0]?"/services/data/v"+this._conn.version+"/chatter"+t:t},a.prototype.request=function(t,e){return new u(this,t).thenCall(e)},a.prototype.resource=function(t,e){return new c(this,t,e)},a.prototype.batch=function(t,e){var n=[],r=[];i.forEach(t,function(t){var e=s.defer();t._promise=e.promise,n.push(t.batchParams()),r.push(e)});t={method:"POST",url:this._normalizeUrl("/connect/batch"),body:{batchRequests:n}};return this.request(t).then(function(t){return i.forEach(t.results,function(t,e){e=r[e];400<=t.statusCode?e.reject(t.result):e.resolve(t.result)}),t}).thenCall(e)};var u=function(t,e){this._chatter=t,this._params=e,this._promise=null};u.prototype.batchParams=function(){var t=this._params,t={method:t.method,url:this._chatter._normalizeUrl(t.url)};return this._params.body&&(t.richInput=this._params.body),t},u.prototype.promise=function(){return this._promise||this._chatter._request(this._params)},u.prototype.stream=function(){return this._chatter._request(this._params).stream()},u.prototype.then=function(t,e){return this.promise().then(t,e)},u.prototype.thenCall=function(t){return i.isFunction(t)?this.promise().thenCall(t):this};var c=function(t,e,n){var r;n&&(r=i.map(i.keys(n),function(t){return t+"="+encodeURIComponent(n[t])}).join("&"),e+=(0<e.indexOf("?")?"&":"?")+r),c.super_.call(this,t,{method:"GET",url:e}),this._url=e};r(c,u),c.prototype.create=function(t,e){return this._chatter.request({method:"POST",url:this._url,body:t}).thenCall(e)},c.prototype.retrieve=function(t){return this.thenCall(t)},c.prototype.update=function(t,e){return this._chatter.request({method:"PATCH",url:this._url,body:t}).thenCall(e)},c.prototype.del=c.prototype.delete=function(t){return this._chatter.request({method:"DELETE",url:this._url}).thenCall(t)},o.on("connection:new",function(t){t.chatter=new a(t)})},{"../core":20,"../promise":27,inherits:85,"lodash/core":89}],8:[function(t,e,n){t("./analytics"),t("./apex"),t("./bulk"),t("./chatter"),t("./metadata"),t("./soap"),t("./streaming"),t("./tooling")},{"./analytics":4,"./apex":5,"./bulk":6,"./chatter":7,"./metadata":9,"./soap":10,"./streaming":12,"./tooling":13}],9:[function(m,_,t){(function(n,s){"use strict";var t=m("inherits"),e=m("events"),r=m("readable-stream"),c=m("lodash/core"),i=m("../core"),a=m("../promise"),o=m("../soap"),u=_.exports=function(t){this._conn=t};function l(t){t=c.clone(t);return t.success="true"===t.success,t}function h(t){t=l(t);return t.created="true"===t.created,t}function f(t){t=c.clone(t);return delete t.$,t}u.prototype.pollInterval=1e3,u.prototype.pollTimeout=1e4,u.prototype._invoke=function(t,e,n){return new o(this._conn,{xmlns:"http://soap.sforce.com/2006/04/metadata",endpointUrl:this._conn.instanceUrl+"/services/Soap/m/"+this._conn.version}).invoke(t,e).then(function(t){return t.result}).thenCall(n)},u.prototype.createAsync=function(e,t,n){if(30<Number(this._conn.version))throw new Error("Async metadata CRUD calls are not supported on ver 31.0 or later.");function r(t){return t["@xsi:type"]=e,t}var i=c.isArray(t);t=i?c.map(t,r):r(t);t=this._invoke("create",{metadata:t});return new p(this,t,i).thenCall(n)},u.prototype.createSync=u.prototype.create=function(e,t,n){function r(t){return t["@xsi:type"]=e,t}return t=c.isArray(t)?c.map(t,r):r(t),this._invoke("createMetadata",{metadata:t}).then(function(t){return c.isArray(t)?c.map(t,l):l(t)}).thenCall(n)},u.prototype.readSync=u.prototype.read=function(t,e,n){return this._invoke("readMetadata",{type:t,fullNames:e}).then(function(t){return c.isArray(t.records)?c.map(t.records,f):f(t.records)}).thenCall(n)},u.prototype.updateAsync=function(e,t,n){if(30<Number(this._conn.version))throw new Error("Async metadata CRUD calls are not supported on ver 31.0 or later.");function r(t){return t.metadata["@xsi:type"]=e,t}var i=c.isArray(t);t=i?c.map(t,r):r(t);t=this._invoke("update",{updateMetadata:t});return new p(this,t,i).thenCall(n)},u.prototype.updateSync=u.prototype.update=function(e,t,n){function r(t){return t["@xsi:type"]=e,t}return t=c.isArray(t)?c.map(t,r):r(t),this._invoke("updateMetadata",{metadata:t}).then(function(t){return c.isArray(t)?c.map(t,l):l(t)}).thenCall(n)},u.prototype.upsertSync=u.prototype.upsert=function(e,t,n){function r(t){return t["@xsi:type"]=e,t}return t=c.isArray(t)?c.map(t,r):r(t),this._invoke("upsertMetadata",{metadata:t}).then(function(t){return c.isArray(t)?c.map(t,h):h(t)}).thenCall(n)},u.prototype.deleteAsync=function(e,t,n){if(30<Number(this._conn.version))throw new Error("Async metadata CRUD calls are not supported on ver 31.0 or later.");function r(t){return c.isString(t)&&(t={fullName:t}),t["@xsi:type"]=e,t}var i=c.isArray(t);t=i?c.map(t,r):r(t);t=this._invoke("delete",{metadata:t});return new p(this,t,i).thenCall(n)},u.prototype.del=u.prototype.deleteSync=u.prototype.delete=function(t,e,n){return this._invoke("deleteMetadata",{type:t,fullNames:e}).then(function(t){return c.isArray(t)?c.map(t,l):l(t)}).thenCall(n)},u.prototype.rename=function(t,e,n,r){return this._invoke("renameMetadata",{type:t,oldFullName:e,newFullName:n}).then(l).thenCall(r)},u.prototype.checkStatus=function(t,e){var n=c.isArray(t),t=this._invoke("checkStatus",{asyncProcessId:t});return new p(this,t,n).thenCall(e)},u.prototype.describe=function(t,e){return c.isString(t)||(e=t,t=this._conn.version),this._invoke("describeMetadata",{asOfVersion:t}).then(function(t){return t.metadataObjects=c.isArray(t.metadataObjects)?t.metadataObjects:[t.metadataObjects],t.metadataObjects=c.map(t.metadataObjects,function(t){return t.childXmlNames&&(t.childXmlNames=c.isArray(t.childXmlNames)?t.childXmlNames:[t.childXmlNames]),t.inFolder="true"===t.inFolder,t.metaFile="true"===t.metaFile,t}),t.partialSaveAllowed="true"===t.partialSaveAllowed,t.testRequired="true"===t.testRequired,t}).thenCall(e)},u.prototype.list=function(t,e,n){return c.isString(e)||(n=e,e=this._conn.version),c.isArray(t)||(t=[t]),this._invoke("listMetadata",{queries:t,asOfVersion:e},n)},u.prototype.retrieve=function(t,e){t=this._invoke("retrieve",{request:t});return new d(this,t).thenCall(e)},u.prototype.checkRetrieveStatus=function(t,e){return this._invoke("checkRetrieveStatus",{asyncProcessId:t},e)},u.prototype.deploy=function(t,e,n){e&&!c.isFunction(e)||(n=e,e={});var r=a.defer();if(c.isObject(t)&&c.isFunction(t.pipe)){var i=[];t.on("data",function(t){i.push(t)}),t.on("end",function(){r.resolve(s.concat(i).toString("base64"))})}else if(t instanceof s)r.resolve(t.toString("base64"));else{if(!(t instanceof String||"string"==typeof t))throw"Unexpected zipInput type";r.resolve(t)}var o=this,t=r.promise.then(function(t){return o._invoke("deploy",{ZipFile:t,DeployOptions:e},n)});return new y(this,t).thenCall(n)},u.prototype.checkDeployStatus=function(t,e,n){return e=c.isObject(e)||c.isBoolean(e)?!!e:(n=e,!1),this._invoke("checkDeployStatus",{asyncProcessId:t,includeDetails:e}).then(function(t){return t.done="true"===t.done,t.success="true"===t.success,t.checkOnly="true"===t.checkOnly,t.runTestsEnabled="true"===t.runTestsEnabled,t.ignoreWarnings&&(t.ignoreWarnings="true"===t.ignoreWarnings),t.rollbackOnError&&(t.rollbackOnError="true"===t.rollbackOnError),t.numberComponentErrors=Number(t.numberComponentErrors),t.numberComponentsDeployed=Number(t.numberComponentsDeployed),t.numberComponentsTotal=Number(t.numberComponentsTotal),t.numberTestErrors=Number(t.numberTestErrors),t.numberTestsCompleted=Number(t.numberTestsCompleted),t.numberTestsTotal=Number(t.numberTestsTotal),t}).thenCall(n)};var p=function(t,e,n){this._meta=t,this._results=e,this._isArray=n};t(p,e.EventEmitter),p.prototype.then=function(n,t){var r=this;return this._results.then(function(t){function e(t){return t.$&&"true"===t.$["xsi:nil"]?null:(t.done="true"===t.done,t)}return t=c.isArray(t)?c.map(t,e):e(t),r._isArray&&!c.isArray(t)&&(t=[t]),n(t)},t)},p.prototype.thenCall=function(e){return c.isFunction(e)?this.then(function(t){n.nextTick(function(){e(null,t)})},function(t){n.nextTick(function(){e(t)})}):this},p.prototype.check=function(t){var e=this,n=this._meta;return this.then(function(t){t=c.isArray(t)?c.map(t,function(t){return t.id}):t.id;return e._ids=t,n.checkStatus(t)}).thenCall(t)},p.prototype.poll=function(s,e){var a=this,n=(new Date).getTime(),u=function(){var t=(new Date).getTime();if(n+e<t){t="Polling time out.";return a._ids&&(t+=" Process Id = "+a._ids),void a.emit("error",new Error(t))}a.check().then(function(t){for(var e=!0,n=c.isArray(t)?t:[t],r=0,i=n.length;r<i;r++){var o=n[r];o&&!o.done&&(a.emit("progress",o),e=!1)}e?a.emit("complete",t):setTimeout(u,s)},function(t){a.emit("error",t)})};setTimeout(u,s)},p.prototype.complete=function(t){var e=a.defer();this.on("complete",function(t){e.resolve(t)}),this.on("error",function(t){e.reject(t)});var n=this._meta;return this.poll(n.pollInterval,n.pollTimeout),e.promise.thenCall(t)};var d=function(t,e){d.super_.call(this,t,e)};t(d,p),d.prototype.complete=function(t){var e=this._meta;return d.super_.prototype.complete.call(this).then(function(t){return e.checkRetrieveStatus(t.id)}).thenCall(t)},d.prototype.stream=function(){var t=this,n=new r.Readable,e=!1;return n._read=function(){e||(e=!0,t.complete(function(t,e){t?n.emit("error",t):(n.push(s.from(e.zipFile,"base64")),n.push(null))}))},n};var y=function(t,e){y.super_.call(this,t,e)};t(y,p),y.prototype.complete=function(e,t){c.isFunction(e)&&(t=e,e=!1);var n=this._meta;return y.super_.prototype.complete.call(this).then(function(t){return n.checkDeployStatus(t.id,e)}).thenCall(t)},i.on("connection:new",function(t){t.metadata=new u(t)})}).call(this,m("_process"),m("buffer").Buffer)},{"../core":20,"../promise":27,"../soap":33,_process:92,buffer:41,events:48,inherits:85,"lodash/core":89,"readable-stream":108}],10:[function(t,e,n){"use strict";var i=t("lodash/core"),r=t("../core"),o=t("../soap"),s=e.exports=function(t){this._conn=t};s.prototype._invoke=function(t,e,n,r){return new o(this._conn,{xmlns:"urn:partner.soap.sforce.com",endpointUrl:this._conn.instanceUrl+"/services/Soap/u/"+this._conn.version}).invoke(t,e,{result:n}).then(function(t){return t.result}).thenCall(r)};var a={};s.prototype.convertLead=function(t,e){var n=i.isArray(t)?[a.LeadConvertResult]:a.LeadConvertResult;return this._invoke("convertLead",{leadConverts:t},n,e)},a.LeadConvertResult={success:"boolean",errors:[],leadId:"string",accountId:"string",contactId:"string",opportunityId:"string"},s.prototype.merge=function(t,e){var n=i.isArray(t)?[a.MergeResult]:a.MergeResult;return this._invoke("merge",{mergeRequests:t},n,e)},a.MergeResult={success:"boolean",errors:[],id:"string",mergedRecordIds:["string"],updatedRelatedIds:["string"]},s.prototype.emptyRecycleBin=function(t,e){return this._invoke("emptyRecycleBin",{ids:t},[a.EmptyRecycleBinResult],e)},a.EmptyRecycleBinResult={id:"string",success:"boolean",errors:[]},s.prototype.describeTabs=function(t){return this._invoke("describeTabs",{},[a.DescribeTabSetResult],t)},a.DescribeTabSetResult={label:"string",logoUrl:"string",namespace:"string",selected:"boolean",tabs:[{colors:[{theme:"string",color:"string",context:"string"}],iconUrl:"string",icons:[{theme:"string",height:"number",width:"number",url:"string",contentType:"string"}],label:"string",custom:"boolean",miniIconUrl:"string",name:"string",sobjectName:"string",url:"string"}]},s.prototype.getServerTimestamp=function(t){return this._invoke("getServerTimestamp",{},a.GetServerTimestampResult,t)},a.GetServerTimestampResult={timestamp:"string"},s.prototype.getUserInfo=function(t){return this._invoke("getUserInfo",{},a.GetUserInfoResult,t)},a.GetUserInfoResult={accessibilityMode:"boolean",currencySymbol:"string",orgAttachmentFileSizeLimit:"number",orgDefaultCurrencyIsoCode:"string",orgDisallowHtmlAttachments:"boolean",orgHasPersonAccounts:"boolean",organizationId:"string",organizationMultiCurrency:"boolean",organizationName:"string",profileId:"string",roleId:"string",sessionSecondsValid:"number",userDefaultCurrencyIsoCode:"string",userEmail:"string",userFullName:"string",userId:"string",userLanguage:"string",userLocale:"string",userName:"string",userTimeZone:"string",userType:"string",userUiSkin:"string"},s.prototype.setPassword=function(t,e,n){return this._invoke("setPassword",{userId:t,password:e},n)},s.prototype.resetPassword=function(t,e){return this._invoke("resetPassword",{userId:t},e)},s.prototype.create=function(t,e){var n=i.isArray(t)?[a.SaveResult]:a.SaveResult,t={"@xmlns":"urn:partner.soap.sforce.com","@xmlns:ns1":"sobject.partner.soap.sforce.com","ns1:sObjects":t};return this._invoke("create",t,n,e)},s.prototype.update=function(t,e){var n=i.isArray(t)?[a.SaveResult]:a.SaveResult,t={"@xmlns":"urn:partner.soap.sforce.com","@xmlns:ns1":"sobject.partner.soap.sforce.com","ns1:sObjects":t};return this._invoke("update",t,n,e)},a.SaveResult={success:"boolean",errors:[],id:"string"},s.prototype.upsert=function(t,e,n){var r=i.isArray(e)?[a.UpsertResult]:a.UpsertResult,e={"@xmlns":"urn:partner.soap.sforce.com","@xmlns:ns1":"sobject.partner.soap.sforce.com","ns1:externalIDFieldName":t,"ns1:sObjects":e};return this._invoke("upsert",e,r,n)},a.UpsertResult={created:"boolean",success:"boolean",errors:[],id:"string"},s.prototype.delete=function(t,e){var n=i.isArray(t)?[a.DeleteResult]:a.DeleteResult,t={"@xmlns":"urn:partner.soap.sforce.com","@xmlns:ns1":"sobject.partner.soap.sforce.com","ns1:ids":t};return this._invoke("delete",t,n,e)},a.DeleteResult={success:"boolean",errors:[],id:"string"},r.on("connection:new",function(t){t.soap=new s(t)}),e.exports=s},{"../core":20,"../soap":33,"lodash/core":89}],11:[function(t,e,n){var r={AuthFailure:function(n){this.incoming=function(t,e){("/meta/connect"!==t.channel&&"/meta/handshake"!==t.channel||!t.advice||"none"!=t.advice.reconnect?e:n)(t)}},Replay:function(t,e){var r=null!=e,i=e,o=t;this.setExtensionEnabled=function(t){r=t},this.setReplay=function(t){i=parseInt(t,10)},this.setChannel=function(t){o=t},this.incoming=function(t,e){"/meta/handshake"===t.channel?t.ext&&1==t.ext.replay&&(r=!0):t.channel===o&&t.data&&t.data.event&&t.data.event.replayId&&(i=t.data.event.replayId),e(t)},this.outgoing=function(t,e){var n;"/meta/subscribe"===t.channel&&t.subscription===o&&r&&(t.ext||(t.ext={}),(n={})[o]=i,t.ext.replay=n),e(t)}}};e.exports=r},{}],12:[function(t,e,n){"use strict";function r(t,e){this._streaming=t,this.name=e}var i=t("events"),o=t("inherits"),s=t("lodash/core"),a=t("faye"),u=t("./streaming-extension"),t=t("../core");r.prototype.subscribe=function(t){return this._streaming.subscribe(this.name,t)},r.prototype.unsubscribe=function(t){return this._streaming.unsubscribe(this.name,t),this};function c(t,e){this._streaming=t,this._name=e}c.prototype.subscribe=function(t){return this._streaming.subscribe(this._name,t)},c.prototype.unsubscribe=function(t){return this._streaming.unsubscribe(this._name,t),this},c.prototype.push=function(e,t){var n=s.isArray(e);e=n?e:[e];var r=this._streaming._conn;return this._id||(this._id=r.sobject("StreamingChannel").findOne({Name:this._name},"Id").then(function(t){return t.Id})),this._id.then(function(t){t="/sobjects/StreamingChannel/"+t+"/push";return r.requestPost(t,{pushEvents:e})}).then(function(t){return n?t:t[0]}).thenCall(t)};function l(t){this._conn=t}o(l,i.EventEmitter),l.prototype._createClient=function(t,e){var t="string"==typeof t&&0===t.indexOf("/u/"),t=[this._conn.instanceUrl,"cometd"+(!0==t&&"36.0"===this._conn.version?"/replay":""),this._conn.version].join("/"),n=new a.Client(t,{});return n.setHeader("Authorization","OAuth "+this._conn.accessToken),e instanceof Array&&e.forEach(function(t){n.addExtension(t)}),-1===n._dispatcher.getConnectionTypes().indexOf("callback-polling")&&(n._dispatcher.selectTransport("long-polling"),n._dispatcher._transport.batching=!1),n},l.prototype._getFayeClient=function(t){var e=0===t.indexOf("/u/")?"generic":"pushTopic";return this._fayeClients&&this._fayeClients[e]||(this._fayeClients=this._fayeClients||{},this._fayeClients[e]=this._createClient(t)),this._fayeClients[e]},l.prototype.topic=function(t){return this._topics=this._topics||{},this._topics[t]=this._topics[t]||new r(this,t)},l.prototype.channel=function(t){return new c(this,t)},l.prototype.subscribe=function(t,e){t=0===t.indexOf("/")?t:"/topic/"+t;return this._getFayeClient(t).subscribe(t,e)},l.prototype.unsubscribe=function(t,e){t=0===t.indexOf("/")?t:"/topic/"+t;return this._getFayeClient(t).unsubscribe(t,e),this},l.prototype.createClient=function(t){return this._createClient(null,t)},t.on("connection:new",function(t){t.streaming=new l(t)}),t.StreamingExtension=u,e.exports=l},{"../core":20,"./streaming-extension":11,events:48,faye:49,inherits:85,"lodash/core":89}],13:[function(t,e,n){"use strict";function r(e){this._conn=e,this._logger=e._logger,["query","queryMore","_toRecordResult","create","_createSingle","_createParallel","_createMany","insert","retrieve","_retrieveSingle","_retrieveParallel","_retrieveMany","update","_updateSingle","_updateParallel","_updateMany","upsert","del","delete","destroy","_destroySingle","_destroyParallel","_destroyMany","describe","describeGlobal","sobject"].forEach(function(t){this[t]=e.constructor.prototype[t]},this),this.cache=new s;var t={key:function(t){return t?"describe."+t:"describe"}};this.describe$=this.cache.makeCacheable(this.describe,this,t),this.describe=this.cache.makeResponseCacheable(this.describe,this,t),this.describeSObject$=this.describe$,this.describeSObject=this.describe,t={key:"describeGlobal"},this.describeGlobal$=this.cache.makeCacheable(this.describeGlobal,this,t),this.describeGlobal=this.cache.makeResponseCacheable(this.describeGlobal,this,t),this.initialize()}var i=t("../core"),o=t("lodash/core"),s=t("../cache");r.prototype.initialize=function(){this.sobjects={},this.cache.clear(),this.cache.get("describeGlobal").removeAllListeners("value"),this.cache.get("describeGlobal").on("value",o.bind(function(t){t.result&&o.map(t.result.sobjects,function(t){return t.name}).forEach(this.sobject,this)},this))},r.prototype._baseUrl=function(){return this._conn._baseUrl()+"/tooling"},r.prototype._supports=function(t){return"sobject-collection"!==t&&this._conn._supports.apply(this._conn,arguments)},r.prototype.request=function(){return this._conn.request.apply(this._conn,arguments)},r.prototype.executeAnonymous=function(t,e){t=this._baseUrl()+"/executeAnonymous?anonymousBody="+encodeURIComponent(t);return this.request(t).thenCall(e)},r.prototype.runTestsAsynchronous=function(t,e){var n=this._baseUrl()+"/runTestsAsynchronous/";return this._conn.requestPost(n,{classids:t.join(",")},void 0,e)},r.prototype.runTestsSynchronous=function(t,e){var n=this._baseUrl()+"/runTestsSynchronous/";return this._conn.requestPost(n,{classnames:t.join(",")},void 0,e)},r.prototype.completions=function(t,e){o.isString(t)||(e=t,t="apex");t=this._baseUrl()+"/completions?type="+encodeURIComponent(t);return this.request(t).thenCall(e)},i.on("connection:new",function(t){t.tooling=new r(t)}),e.exports=r},{"../cache":18,"../core":20,"lodash/core":89}],14:[function(t,e,n){"use strict";var c=t("readable-stream").Duplex,l=t("lodash/core");e.exports={supported:"object"==typeof Sfdc&&void 0!==Sfdc.canvas,createRequest:function(u){return function(r,i){var o,s=new c;s._read=function(t){o&&s.push(o.body)};var a=[],t=!1;function e(t){var e={client:u.client,method:r.method,data:t};if(r.headers)for(var n in e.headers={},r.headers)"content-type"===n.toLowerCase()?e.contentType=r.headers[n]:e.headers[n]=r.headers[n];e.success=function(t){var n,e=(r=t.responseHeaders,n={},r.split(/\n/).forEach(function(t){var e=t.split(/\s*:\s*/),t=e[0].toLowerCase(),e=e[1];n[t]=e}),n),r=t.payload;l.isString(r)||(r=JSON.stringify(r)),o={statusCode:t.status,headers:e,body:r},i&&i(null,o,o.body),s.end()},e.failure=function(t){i&&i(t)},Sfdc.canvas.client.ajax(r.url,e)}return s._write=function(t,e,n){a.push(t.toString(e)),n()},s.on("finish",function(){t||(e(a.join("")),t=!0)}),!r.body&&""!==r.body&&/^(put|post|patch)$/i.test(r.method)||(e(r.body),t=!0),s}}}},{"lodash/core":89,"readable-stream":108}],15:[function(t,e,n){"use strict";var r=t("events"),i=t("inherits"),o=t("querystring"),s=t("lodash/core"),a=t("../connection"),d=t("../oauth2");function u(){var t=function(){var t;if(window.location.hash){if((t=o.parse(window.location.hash.substring(1))).access_token)return{success:!0,body:t}}else if(window.location.search&&(t=o.parse(window.location.search.substring(1))).error)return{success:!1,body:t}}(),e=localStorage.getItem("jsforce_state");if(t&&e&&t.body.state===e){localStorage.removeItem("jsforce_state");var n=e.split("."),e=n[0],n=n[1],e=new c(e);return t.success?(e._storeTokens(t.body),location.hash=""):e._storeError(t.body),"popup"===n&&window.close(),1}}function c(t){this._prefix=t||"jsforce"+l++,this.connection=null}var l=0;i(c,r.EventEmitter),c.prototype.init=function(t){var e;u()||(this.config=t,this.connection=new a(t),(t=this._getTokens())&&(this.connection.initialize(t),e=this,setTimeout(function(){e.emit("connect",e.connection)},10)))},c.prototype.login=function(t,e){s.isFunction(t)&&(e=t,t={}),t=t||{},e=e||function(){},s.extend(t,this.config);this._prompt(t,e)},c.prototype._prompt=function(t,e){var n=this,r=new d(t),i=Math.random().toString(36).substring(2),o=[this._prefix,"popup",i].join(".");localStorage.setItem("jsforce_state",o);var s,a,u,c,l=r.getAuthorizationUrl({response_type:"token",scope:t.scope,state:o}),h=t.size||{},f=(s=l,a=h.width||912,u=h.height||513,c=screen.width/2-a/2,h=screen.height/2-u/2,window.open(s,null,"location=yes,toolbar=no,status=no,menubar=no,width="+a+",height="+u+",top="+h+",left="+c));if(!f)return o=[this._prefix,"redirect",i].join("."),localStorage.setItem("jsforce_state",o),l=r.getAuthorizationUrl({response_type:"token",scope:t.scope,state:o}),void(location.href=l);n._removeTokens();var p=setInterval(function(){try{var t;f&&!f.closed||(clearInterval(p),(t=n._getTokens())?(n.connection.initialize(t),n.emit("connect",n.connection),e(null,{status:"connect"})):(t=n._getError())?e(new Error(t.error+": "+t.error_description)):e(null,{status:"cancel"}))}catch(t){}},1e3)},c.prototype.isLoggedIn=function(){return!(!this.connection||!this.connection.accessToken)},c.prototype.logout=function(){this.connection.logout(),this._removeTokens(),this.emit("disconnect")},c.prototype._getTokens=function(){var t=new RegExp("(^|;\\s*)"+this._prefix+"_loggedin=true(;|$)");if(document.cookie.match(t)){t=Number(localStorage.getItem(this._prefix+"_issued_at"));if(Date.now()<t+72e5){var e,t=localStorage.getItem(this._prefix+"_id");return t&&(e={id:(e=t.split("/")).pop(),organizationId:e.pop(),url:t}),{accessToken:localStorage.getItem(this._prefix+"_access_token"),instanceUrl:localStorage.getItem(this._prefix+"_instance_url"),userInfo:e}}}return null},c.prototype._storeTokens=function(t){localStorage.setItem(this._prefix+"_access_token",t.access_token),localStorage.setItem(this._prefix+"_instance_url",t.instance_url),localStorage.setItem(this._prefix+"_issued_at",t.issued_at),localStorage.setItem(this._prefix+"_id",t.id),document.cookie=this._prefix+"_loggedin=true;"},c.prototype._removeTokens=function(){localStorage.removeItem(this._prefix+"_access_token"),localStorage.removeItem(this._prefix+"_instance_url"),localStorage.removeItem(this._prefix+"_issued_at"),localStorage.removeItem(this._prefix+"_id"),document.cookie=this._prefix+"_loggedin="},c.prototype._getError=function(){try{var t=JSON.parse(localStorage.getItem(this._prefix+"_error"));return localStorage.removeItem(this._prefix+"_error"),t}catch(t){}},c.prototype._storeError=function(t){localStorage.setItem(this._prefix+"_error",JSON.stringify(t))},e.exports=new c,e.exports.Client=c},{"../connection":19,"../oauth2":25,events:48,inherits:85,"lodash/core":89,querystring:97}],16:[function(t,e,n){"use strict";var c=0;e.exports={supported:"undefined"!=typeof window&&"undefined"!=typeof document,createRequest:function(a,u){return a=a||"callback",u=u||1e4,function(t,e){if("GET"!==t.method.toUpperCase())return e(new Error("JSONP only supports GET request."));var n="_jsforce_jsonpCallback_"+ ++c,r=window,t=t.url;t+=0<t.indexOf("?")?"&":"?",t+=a+"="+n;var i=document.createElement("script");i.type="text/javascript",i.src=t,document.documentElement.appendChild(i);var o=setTimeout(function(){s(),e(new Error("JSONP call time out."))},u);r[n]=function(t){s(),e(null,{statusCode:200,headers:{"content-type":"application/json"},body:JSON.stringify(t)})};var s=function(){clearTimeout(o),document.documentElement.removeChild(i),delete r[n]}}}}},{}],17:[function(t,e,n){"use strict";var u=t("readable-stream").Duplex,c=t("lodash/core");e.exports=function(t,n){var r,i=new XMLHttpRequest;if(i.open(t.method,t.url),t.headers)for(var e in t.headers)i.setRequestHeader(e,t.headers[e]);i.setRequestHeader("Accept","*/*");var o=new u;o._read=function(t){r&&o.push(r.body)};var s=[],a=!1;return o._write=function(t,e,n){s.push(t.toString("buffer"===e?"binary":e)),n()},o.on("finish",function(){a||(i.send(s.join("")),a=!0)}),!t.body&&""!==t.body&&/^(put|post|patch)$/i.test(t.method)||(i.send(t.body),a=!0),i.onreadystatechange=function(){var t,e;4===i.readyState&&(t=function(t){t=(t.getAllResponseHeaders()||"").split(/[\r\n]+/);return c.map(t,function(t){return t.split(/\s*:/)[0].toLowerCase()})}(i),e={},c.forEach(t,function(t){t&&(e[t]=i.getResponseHeader(t))}),(r={statusCode:i.status,headers:e,body:i.response}).statusCode||(r.statusCode=400,r.body="Access Declined"),n&&n(null,r,r.body),o.end())},o}},{"lodash/core":89,"readable-stream":108}],18:[function(t,e,n){"use strict";function r(){this.fetching=!1}var i=t("events"),o=t("inherits"),l=t("lodash/core");o(r,i.EventEmitter),r.prototype.get=function(t){if(!t)return this._value;this.once("value",t),l.isUndefined(this._value)||this.emit("value",this._value)},r.prototype.set=function(t){this._value=t,this.emit("value",this._value)},r.prototype.clear=function(){this.fetching=!1,delete this._value};i=function(){this._entries={}};function h(t,e){return e=Array.prototype.slice.apply(e),t+"("+l.map(e,function(t){return JSON.stringify(t)}).join(",")+")"}i.prototype.get=function(t){if(t&&this._entries[t])return this._entries[t];var e=new r;return this._entries[t]=e},i.prototype.clear=function(t){for(var e in this._entries)t&&0!==e.indexOf(t)||this._entries[e].clear()},i.prototype.makeResponseCacheable=function(s,a,u){var c=this;return u=u||{},function(){var t=Array.prototype.slice.apply(arguments),e=t.pop();l.isFunction(e)||(t.push(e),e=null);var n=l.isString(u.key)?u.key:l.isFunction(u.key)?u.key.apply(a,t):h(u.namespace,t);Array.isArray(n)||(n=[n]);var r,i,o=[];n.forEach(function(t){t=c.get(t);t.fetching=!0,o.push(t)}),e&&t.push(function(n,r){Array.isArray(r)&&r.length==o.length?o.forEach(function(t,e){t.set({error:n,result:r[e]})}):o.forEach(function(t){t.set({error:n,result:r})}),e(n,r)});try{r=s.apply(a||this,t)}catch(t){i=t}if(r&&l.isFunction(r.then))return e?r:r.then(function(n){return Array.isArray(n)&&n.length==o.length?o.forEach(function(t,e){t.set({error:void 0,result:n[e]})}):o.forEach(function(t){t.set({error:void 0,result:n})}),n},function(n){throw Array.isArray(n)&&n.length==o.length?o.forEach(function(t,e){t.set({error:n[e],result:void 0})}):o.forEach(function(t){t.set({error:n,result:void 0})}),n});if(Array.isArray(r)&&r.length==o.length?o.forEach(function(t,e){t.set({error:i,result:r[e]})}):o.forEach(function(t){t.set({error:i,result:r})}),i)throw i;return r}},i.prototype.makeCacheable=function(i,o,s){var a=this;s=s||{};function t(){var t=Array.prototype.slice.apply(arguments),e=t.pop();l.isFunction(e)||t.push(e);var n=l.isString(s.key)?s.key:l.isFunction(s.key)?s.key.apply(o,t):h(s.namespace,t),r=a.get(n);if(!l.isFunction(e)){n=r.get();if(!n)throw new Error("Function call result is not cached yet.");if(n.error)throw n.error;return n.result}r.get(function(t){e(t.error,t.result)}),r.fetching||(r.fetching=!0,t.push(function(t,e){r.set({error:t,result:e})}),i.apply(o||this,t))}return t.clear=function(){var t=l.isString(s.key)?s.key:l.isFunction(s.key)?s.key.apply(o,arguments):h(s.namespace,arguments);a.clear(t)},t},e.exports=i},{events:48,inherits:85,"lodash/core":89}],19:[function(T,x,t){(function(n){"use strict";var t=T("events"),e=T("inherits"),u=T("lodash/core"),c=T("./promise"),r=T("./logger"),i=T("./oauth2"),o=T("./query"),s=T("./sobject"),a=T("./quick-action"),l=T("./http-api"),h=T("./transport"),f=T("./process"),p=T("./cache"),d="https://login.salesforce.com",y="",m="42.0",_=200,g=x.exports=function(t){t=t||{},this._logger=new r(t.logLevel);var e=t.oauth2||{loginUrl:t.loginUrl,clientId:t.clientId,clientSecret:t.clientSecret,redirectUri:t.redirectUri,proxyUrl:t.proxyUrl,httpProxy:t.httpProxy};this.oauth2=e=e instanceof i?e:new i(e),this.loginUrl=t.loginUrl||e.loginUrl||d,this.version=t.version||m,this.maxRequest=t.maxRequest||this.maxRequest||10,t.proxyUrl?this._transport=new h.ProxyTransport(t.proxyUrl):t.httpProxy?this._transport=new h.HttpProxyTransport(t.httpProxy):this._transport=new h,this.callOptions=t.callOptions,T("./core").emit("connection:new",this),this.process=new f(this),this.cache=new p;var n=t.refreshFn;!n&&this.oauth2.clientId&&(n=b),n&&(this._refreshDelegate=new l.SessionRefreshDelegate(this,n));e={key:function(t){return t?t.type?"describe."+t.type:"describe."+t:"describe"}};this.describe$=this.cache.makeCacheable(this.describe,this,e),this.describe=this.cache.makeResponseCacheable(this.describe,this,e),this.describeSObject$=this.describe$,this.describeSObject=this.describe;n={key:function(t){var e=t.types,t=t.autofetch||!1,e=!(25<e.length)||t?e:e.slice(0,25),n=[];return e.forEach(function(t){n.push("describe."+t)}),n}};this.batchDescribe=this.cache.makeResponseCacheable(this.batchDescribe,this,n),this.batchDescribeSObjects=this.batchDescribe,e={key:"describeGlobal"},this.describeGlobal$=this.cache.makeCacheable(this.describeGlobal,this,e),this.describeGlobal=this.cache.makeResponseCacheable(this.describeGlobal,this,e),this.initialize(t)};function b(n,r){n.oauth2.refreshToken(n.refreshToken,function(t,e){if(t)return r(t);t=w(e.id);n.initialize({instanceUrl:e.instance_url,accessToken:e.access_token,userInfo:t}),r(null,e.access_token,e)})}function v(t){function e(t){return t<10?"0"+t:t}return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"+00:00"}function w(t){var e=t.split("/");return{id:e.pop(),organizationId:e.pop(),url:t}}function E(t){return t&&String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}e(g,t.EventEmitter),g.prototype.initialize=function(t){if(!t.instanceUrl&&t.serverUrl&&(t.instanceUrl=t.serverUrl.split("/").slice(0,3).join("/")),this.instanceUrl=t.instanceUrl||t.serverUrl||this.instanceUrl||y,this.accessToken=t.sessionId||t.accessToken||this.accessToken,this.refreshToken=t.refreshToken||this.refreshToken,this.refreshToken&&!this._refreshDelegate)throw new Error("Refresh token is specified without oauth2 client information or refresh function");this.signedRequest=t.signedRequest&&function(t){if(u.isString(t)){if("{"===t[0])return JSON.parse(t);var e=t.split(".").pop(),e=n.from(e,"base64").toString("utf-8");return JSON.parse(e)}return t}(t.signedRequest),this.signedRequest&&(this.accessToken=this.signedRequest.client.oauthToken,h.CanvasTransport.supported&&(this._transport=new h.CanvasTransport(this.signedRequest))),t.userInfo&&(this.userInfo=t.userInfo),this.limitInfo={},this.sobjects={},this.cache.clear(),this.cache.get("describeGlobal").removeAllListeners("value"),this.cache.get("describeGlobal").on("value",u.bind(function(t){t.result&&u.map(t.result.sobjects,function(t){return t.name}).forEach(this.sobject,this)},this)),this.tooling&&this.tooling.initialize(),this._sessionType=t.sessionId?"soap":"oauth2"},g.prototype._baseUrl=function(){return[this.instanceUrl,"services/data","v"+this.version].join("/")},g.prototype._normalizeUrl=function(t){return"/"===t[0]?0===t.indexOf("/services/")?this.instanceUrl+t:this._baseUrl()+t:t},g.prototype.request=function(t,e,n){"function"==typeof e&&(n=e,e=null),e=e||{};var r=this;u.isString(t)&&(t={method:"GET",url:t}),t.url=this._normalizeUrl(t.url);e=new l(this,e);return e.on("response",function(t){t.headers&&t.headers["sforce-limit-info"]&&((t=t.headers["sforce-limit-info"].match(/api\-usage=(\d+)\/(\d+)/))&&(r.limitInfo={apiUsage:{used:parseInt(t[1],10),limit:parseInt(t[2],10)}}))}),e.request(t).thenCall(n)},g.prototype.requestGet=function(t,e,n){t={method:"GET",url:t};return this.request(t,e,n)},g.prototype.requestPost=function(t,e,n,r){e={method:"POST",url:t,body:JSON.stringify(e),headers:{"content-type":"application/json"}};return this.request(e,n,r)},g.prototype.requestPut=function(t,e,n,r){e={method:"PUT",url:t,body:JSON.stringify(e),headers:{"content-type":"application/json"}};return this.request(e,n,r)},g.prototype.requestPatch=function(t,e,n,r){e={method:"PATCH",url:t,body:JSON.stringify(e),headers:{"content-type":"application/json"}};return this.request(e,n,r)},g.prototype.requestDelete=function(t,e,n){t={method:"DELETE",url:t};return this.request(t,e,n)},g.prototype.query=function(t,e,n){"function"==typeof e&&(n=e,e=void 0);e=new o(this,t,e);return n&&e.run(n),e},g.prototype.queryAll=function(t,e,n){"function"==typeof e&&(n=e,e=void 0);e=new o(this,t,e);return e.scanAll(!0),n&&e.run(n),e},g.prototype.queryMore=function(t,e,n){"function"==typeof e&&(n=e,e=void 0);e=new o(this,{locator:t},e);return n&&e.run(n),e},g.prototype._ensureVersion=function(t){var e=this.version.split(".");return parseInt(e[0],10)>=t},g.prototype._supports=function(t){return"sobject-collection"===t&&this._ensureVersion(42)},g.prototype.retrieve=function(t,e,n,r){return"function"==typeof n&&(r=n,n={}),n=n||{},(u.isArray(e)?this._supports("sobject-collection")?this._retrieveMany(t,e,n):this._retrieveParallel(t,e,n):this._retrieveSingle(t,e,n)).thenCall(r)},g.prototype._retrieveSingle=function(t,e,n){if(!e)return c.reject(new Error("Invalid record ID. Specify valid record ID value"));e=[this._baseUrl(),"sobjects",t,e].join("/");return n.fields&&(e+="?fields="+n.fields.join(",")),this.request({method:"GET",url:e,headers:n.headers})},g.prototype._retrieveParallel=function(e,t,n){if(t.length>this.maxRequest)return c.reject(new Error("Exceeded max limit of concurrent call"));var r=this;return c.all(t.map(function(t){return r._retrieveSingle(e,t,n).catch(function(t){if(n.allOrNone||"NOT_FOUND"!==t.errorCode)throw t;return null})}))},g.prototype._retrieveMany=function(t,e,n){if(0===e.length)return c.resolve([]);var r=[this._baseUrl(),"composite","sobjects",t].join("/"),i=this;return(n.fields?c.resolve(n.fields):new c(function(n,r){i.describe$(t,function(t,e){t?r(t):(e=e.fields.map(function(t){return t.name}),n(e))})})).then(function(t){return i.request({method:"POST",url:r,body:JSON.stringify({ids:e,fields:t}),headers:u.defaults(n.headers||{},{"Content-Type":"application/json"})})})},g.prototype._toRecordResult=function(t,e){var n={statusCode:e.errorCode,message:e.message};e.content&&(n.content=e.content),e.fields&&(n.fields=e.fields);n={success:!1,errors:[n]};return t&&(n.id=t),n},g.prototype.insert=g.prototype.create=function(t,e,n,r){return u.isString(t)||(r=n,n=e,e=t,t=null),"function"==typeof n&&(r=n,n={}),n=n||{},(u.isArray(e)?this._supports("sobject-collection")?this._createMany(t,e,n):this._createParallel(t,e,n):this._createSingle(t,e,n)).thenCall(r)},g.prototype._createSingle=function(t,e,n){t=t||e.attributes&&e.attributes.type||e.type;if(!t)return c.reject(new Error("No SObject Type defined in record"));delete(e=u.clone(e)).Id,delete e.type,delete e.attributes;t=[this._baseUrl(),"sobjects",t].join("/");return this.request({method:"POST",url:t,body:JSON.stringify(e),headers:u.defaults(n.headers||{},{"Content-Type":"application/json"})})},g.prototype._createParallel=function(e,t,n){if(t.length>this.maxRequest)return c.reject(new Error("Exceeded max limit of concurrent call"));var r=this;return c.all(t.map(function(t){return r._createSingle(e,t,n).catch(function(t){if(n.allOrNone||!t.errorCode)throw t;return this._toRecordResult(null,t)})}))},g.prototype._createMany=function(n,t,r){if(0===t.length)return c.resolve([]);if(t.length>_&&r.allowRecursive){var i=this;return i._createMany(n,t.slice(0,_),r).then(function(e){return i._createMany(n,t.slice(_),r).then(function(t){return e.concat(t)})})}t=u.map(t,function(t){var e=n||t.attributes&&t.attributes.type||t.type;return e?(delete(t=u.clone(t)).Id,delete t.type,t.attributes={type:e},t):c.reject(new Error("No SObject Type defined in record"))});var e=[this._baseUrl(),"composite","sobjects"].join("/");return this.request({method:"POST",url:e,body:JSON.stringify({allOrNone:r.allOrNone||!1,records:t}),headers:u.defaults(r.headers||{},{"Content-Type":"application/json"})})},g.prototype.update=function(t,e,n,r){return u.isString(t)||(r=n,n=e,e=t,t=null),"function"==typeof n&&(r=n,n={}),n=n||{},(u.isArray(e)?this._supports("sobject-collection")?this._updateMany(t,e,n):this._updateParallel(t,e,n):this._updateSingle(t,e,n)).thenCall(r)},g.prototype._updateSingle=function(t,e,n){var r=e.Id;if(!r)return c.reject(new Error("Record id is not found in record."));t=t||e.attributes&&e.attributes.type||e.type;if(!t)return c.reject(new Error("No SObject Type defined in record"));delete(e=u.clone(e)).Id,delete e.type,delete e.attributes;t=[this._baseUrl(),"sobjects",t,r].join("/");return this.request({method:"PATCH",url:t,body:JSON.stringify(e),headers:u.defaults(n.headers||{},{"Content-Type":"application/json"})},{noContentResponse:{id:r,success:!0,errors:[]}})},g.prototype._updateParallel=function(t,e,n){if(e.length>this.maxRequest)return c.reject(new Error("Exceeded max limit of concurrent call"));var r=this;return c.all(e.map(function(e){return r._updateSingle(t,e,n).catch(function(t){if(n.allOrNone||!t.errorCode)throw t;return this._toRecordResult(e.Id,t)})}))},g.prototype._updateMany=function(r,t,n){if(0===t.length)return c.resolve([]);if(t.length>_&&n.allowRecursive){var i=this;return i._updateMany(r,t.slice(0,_),n).then(function(e){return i._updateMany(r,t.slice(_),n).then(function(t){return e.concat(t)})})}t=u.map(t,function(t){var e=t.Id;if(!e)throw new Error("Record id is not found in record.");var n=r||t.attributes&&t.attributes.type||t.type;if(!n)throw new Error("No SObject Type defined in record");return delete(t=u.clone(t)).Id,t.id=e,delete t.type,t.attributes={type:n},t});var e=[this._baseUrl(),"composite","sobjects"].join("/");return this.request({method:"PATCH",url:e,body:JSON.stringify({allOrNone:n.allOrNone||!1,records:t}),headers:u.defaults(n.headers||{},{"Content-Type":"application/json"})})},g.prototype.upsert=function(r,t,i,o,e){u.isString(r)||(e=o,o=i,i=t,t=r,r=null),"function"==typeof o&&(e=o,o={}),o=o||{};var s=this,a=u.isArray(t);return((t=a?t:[t]).length>this.maxRequest?c.reject(new Error("Exceeded max limit of concurrent call")):c.all(u.map(t,function(t){var e=r||t.attributes&&t.attributes.type||t.type,n=t[i];delete(t=u.clone(t))[i],delete t.type,delete t.attributes;n=[s._baseUrl(),"sobjects",e,i,n].join("/");return s.request({method:"PATCH",url:n,body:JSON.stringify(t),headers:u.defaults(o.headers||{},{"Content-Type":"application/json"})},{noContentResponse:{success:!0,errors:[]}}).catch(function(t){if(!a||o.allOrNone||!t.errorCode)throw t;return s._toRecordResult(null,t)})})).then(function(t){return!a&&u.isArray(t)?t[0]:t})).thenCall(e)},g.prototype.delete=g.prototype.del=g.prototype.destroy=function(t,e,n,r){return"function"==typeof n&&(r=n,n={}),n=n||{},(u.isArray(e)?this._supports("sobject-collection")?this._destroyMany(t,e,n):this._destroyParallel(t,e,n):this._destroySingle(t,e,n)).thenCall(r)},g.prototype._destroySingle=function(t,e,n){t=[this._baseUrl(),"sobjects",t,e].join("/");return this.request({method:"DELETE",url:t,headers:n.headers||null},{noContentResponse:{id:e,success:!0,errors:[]}})},g.prototype._destroyParallel=function(t,e,n){if(e.length>this.maxRequest)return c.reject(new Error("Exceeded max limit of concurrent call"));var r=this;return c.all(e.map(function(e){return r._destroySingle(t,e,n).catch(function(t){if(n.allOrNone||!t.errorCode)throw t;return this._toRecordResult(e,t)})}))},g.prototype._destroyMany=function(t,n,r){if(0===n.length)return c.resolve([]);if(n.length>_&&r.allowRecursive){var i=this;return i._destroyMany(t,n.slice(0,_),r).then(function(e){return i._destroyMany(t,n.slice(_),r).then(function(t){return e.concat(t)})})}var e=[this._baseUrl(),"composite","sobjects?ids="].join("/")+n.join(",");return r.allOrNone&&(e+="&allOrNone=true"),this.request({method:"DELETE",url:e,headers:r.headers||null})},g.prototype.search=function(t,e){t=this._baseUrl()+"/search?q="+encodeURIComponent(t);return this.request(t).thenCall(e)},g.prototype.describe=g.prototype.describeSObject=function(t,e){var n=t.type||t,n=[this._baseUrl(),"sobjects",n,"describe"].join("/"),t=t.ifModifiedSince?{"If-Modified-Since":t.ifModifiedSince}:{};return this.request({method:"GET",url:n,headers:t}).then(function(t){return""===t?c.resolve(void 0):c.resolve(t)}).thenCall(e)},g.prototype.batchDescribe=g.prototype.batchDescribeSObjects=function(t,e){var n=t.types,r=t.autofetch||!1,i=Math.min(t.maxConcurrentRequests||15,15),o=[];do{var s=25<n.length?n.slice(0,25):n}while(o.push(s),0<(n=25<n.length?n.slice(25):[]).length&&r);var a=[];do{var u=o.length>i?o.slice(0,i):o}while(a.push(u),0<(o=o.length>i?o.slice(i):[]).length);return this.doBatchDescribeRequestBatches(a).thenCall(e)},g.prototype.doBatchDescribeRequestBatches=function(e){var n=this,r=[],t=e.shift();return n.doBatchOfBatchDescribeRequests(t).then(function(t){return t.forEach(function(t){r.push(t)}),0<e.length?n.doBatchDescribeRequestBatches(e).then(function(t){return t.forEach(function(t){r.push(t)}),c.resolve(r)}):c.resolve(r)})},g.prototype.doBatchOfBatchDescribeRequests=function(t){var e=this;return c.all(t.map(function(t){return e.doBatchDescribeRequest(t)})).then(function(t){var e=[];return t.forEach(function(t){t.forEach(function(t){e.push(t)})}),c.resolve(e)})},g.prototype.doBatchDescribeRequest=function(t){var r=[],e=[this._baseUrl(),"composite/batch"].join("/"),n="v"+this.version,i=[];return t.forEach(function(t){i.push({method:"GET",url:[n,"sobjects",t,"describe"].join("/")})}),this.request({method:"POST",url:e,body:JSON.stringify({batchRequests:i}),headers:{"Content-Type":"application/json"}}).then(function(t){if(t.results)for(var e=0,e=0;e<t.results.length;e++){var n=t.results[e];Array.isArray(n.result)?n.result[0].errorCode&&n.result[0].message&&this._logger.error("Error: "+n.result[0].errorCode+" "+n.result[0].message+" - "+typesToFetch[e]):r.push(n.result)}return c.resolve(r)})},g.prototype.describeGlobal=function(t){var e=this._baseUrl()+"/sobjects";return this.request(e).thenCall(t)},g.prototype.sobject=function(t){return this.sobjects=this.sobjects||{},this.sobjects[t]=this.sobjects[t]||new s(this,t)},g.prototype.identity=function(t,e){"function"==typeof t&&(e=t,t={}),t=t||{};var n=this,r=this.userInfo&&this.userInfo.url;return c.resolve(r?{identity:r}:this.request({method:"GET",url:this._baseUrl(),headers:t.headers})).then(function(t){t=t.identity;return n.request({method:"GET",url:t})}).then(function(t){return n.userInfo={id:t.user_id,organizationId:t.organization_id,url:t.id},t}).thenCall(e)},g.prototype.authorize=function(t,e,n){"function"==typeof e&&(n=e,e={});var r=this,i=this._logger;return this.oauth2.requestToken(t,e).then(function(t){var e=w(t.id);return r.initialize({instanceUrl:t.instance_url,accessToken:t.access_token,refreshToken:t.refresh_token,userInfo:e}),i.debug("<login> completed. user id = "+e.id+", org id = "+e.organizationId),e}).thenCall(n)},g.prototype.login=function(t,e,n){var r,i;return this._refreshDelegate=new l.SessionRefreshDelegate(this,(r=t,i=e,function(e,n){e.login(r,i,function(t){return t?n(t):void n(null,e.accessToken)})})),this.oauth2&&this.oauth2.clientId&&this.oauth2.clientSecret?this.loginByOAuth2(t,e,n):this.loginBySoap(t,e,n)},g.prototype.loginByOAuth2=function(t,e,n){var r=this,i=this._logger;return this.oauth2.authenticate(t,e).then(function(t){var e=w(t.id);return r.initialize({instanceUrl:t.instance_url,accessToken:t.access_token,userInfo:e}),i.debug("<login> completed. user id = "+e.id+", org id = "+e.organizationId),e}).thenCall(n)},g.prototype.loginBySoap=function(t,e,n){var o=this,s=this._logger,e=['<se:Envelope xmlns:se="http://schemas.xmlsoap.org/soap/envelope/">',"<se:Header/>","<se:Body>",'<login xmlns="urn:partner.soap.sforce.com">',"<username>"+E(t)+"</username>","<password>"+E(e)+"</password>","</login>","</se:Body>","</se:Envelope>"].join(""),a=[this.loginUrl,"services/Soap/u",this.version].join("/");return this._transport.httpRequest({method:"POST",url:a,body:e,headers:{"Content-Type":"text/xml",SOAPAction:'""'}}).then(function(t){if(400<=t.statusCode){var e=(i=t.body.match(/<faultstring>([^<]+)<\/faultstring>/))&&i[1];throw new Error(e||t.body)}s.debug("SOAP response = "+t.body);var n=(i=t.body.match(/<serverUrl>([^<]+)<\/serverUrl>/))&&i[1],r=(i=t.body.match(/<sessionId>([^<]+)<\/sessionId>/))&&i[1],e=(i=t.body.match(/<userId>([^<]+)<\/userId>/))&&i[1],t=(i=t.body.match(/<organizationId>([^<]+)<\/organizationId>/))&&i[1],i=a.split("/").slice(0,3).join("/"),i={id:e,organizationId:t,url:i+="/id/"+t+"/"+e};return o.initialize({serverUrl:n.split("/").slice(0,3).join("/"),sessionId:r,userInfo:i}),s.debug("<login> completed. user id = "+e+", org id = "+t),i}).thenCall(n)},g.prototype.logout=function(t,e){return"function"==typeof t&&(e=t,t=!1),"oauth2"===this._sessionType?this.logoutByOAuth2(t,e):this.logoutBySoap(t,e)},g.prototype.logoutByOAuth2=function(t,e){"function"==typeof t&&(e=t,t=!1);var n=this;this._logger;return this.oauth2.revokeToken(t?this.refreshToken:this.accessToken).then(function(){n.accessToken=null,n.userInfo=null,n.refreshToken=null,n.instanceUrl=null,n.cache.clear()}).thenCall(e)},g.prototype.logoutBySoap=function(t,e){"function"==typeof t&&(e=t,t=!1);var n=this,r=this._logger,t=['<se:Envelope xmlns:se="http://schemas.xmlsoap.org/soap/envelope/">',"<se:Header>",'<SessionHeader xmlns="urn:partner.soap.sforce.com">',"<sessionId>"+E(t?this.refreshToken:this.accessToken)+"</sessionId>","</SessionHeader>","</se:Header>","<se:Body>",'<logout xmlns="urn:partner.soap.sforce.com"/>',"</se:Body>","</se:Envelope>"].join("");return this._transport.httpRequest({method:"POST",url:[this.instanceUrl,"services/Soap/u",this.version].join("/"),body:t,headers:{"Content-Type":"text/xml",SOAPAction:'""'}}).then(function(t){if(r.debug("SOAP statusCode = "+t.statusCode+", response = "+t.body),400<=t.statusCode){var e=t.body.match(/<faultstring>([^<]+)<\/faultstring>/),e=e&&e[1];throw new Error(e||t.body)}n.accessToken=null,n.userInfo=null,n.refreshToken=null,n.instanceUrl=null,n.cache.clear()}).thenCall(e)},g.prototype.recent=function(t,e,n){var r;return u.isString(t)||(n=e,e=t,t=void 0),u.isNumber(e)||(n=e,e=void 0),t?(r=[this._baseUrl(),"sobjects",t].join("/"),this.request(r).then(function(t){return e?t.recentItems.slice(0,e):t.recentItems}).thenCall(n)):(r=this._baseUrl()+"/recent",e&&(r+="?limit="+e),this.request(r).thenCall(n))},g.prototype.updated=function(t,e,n,r){t=[this._baseUrl(),"sobjects",t,"updated"].join("/");return"string"==typeof e&&(e=new Date(e)),e instanceof Date&&(e=v(e)),e&&(t+="?start="+encodeURIComponent(e)),"string"==typeof n&&(n=new Date(n)),n instanceof Date&&(n=v(n)),n&&(t+="&end="+encodeURIComponent(n)),this.request(t).thenCall(r)},g.prototype.deleted=function(t,e,n,r){t=[this._baseUrl(),"sobjects",t,"deleted"].join("/");return"string"==typeof e&&(e=new Date(e)),e instanceof Date&&(e=v(e)),e&&(t+="?start="+encodeURIComponent(e)),"string"==typeof n&&(n=new Date(n)),n instanceof Date&&(n=v(n)),n&&(t+="&end="+encodeURIComponent(n)),this.request(t).thenCall(r)},g.prototype.tabs=function(t){var e=[this._baseUrl(),"tabs"].join("/");return this.request(e).thenCall(t)},g.prototype.limits=function(t){var e=[this._baseUrl(),"limits"].join("/");return this.request(e).thenCall(t)},g.prototype.theme=function(t){var e=[this._baseUrl(),"theme"].join("/");return this.request(e).thenCall(t)},g.prototype.quickActions=function(t){return this.request("/quickActions").thenCall(t)},g.prototype.quickAction=function(t){return new a(this,"/quickActions/"+t)}}).call(this,T("buffer").Buffer)},{"./cache":18,"./core":20,"./http-api":23,"./logger":24,"./oauth2":25,"./process":26,"./promise":27,"./query":28,"./quick-action":29,"./sobject":34,"./transport":36,buffer:41,events:48,inherits:85,"lodash/core":89}],20:[function(t,e,n){"use strict";var r=t("events").EventEmitter,r=e.exports=new r;r.VERSION=t("./VERSION"),r.Connection=t("./connection"),r.OAuth2=t("./oauth2"),r.Date=r.SfDate=t("./date"),r.RecordStream=t("./record-stream"),r.Promise=t("./promise"),r.require=t("./require")},{"./VERSION":2,"./connection":19,"./date":22,"./oauth2":25,"./promise":27,"./record-stream":30,"./require":32,events:48}],21:[function(t,e,n){"use strict";var r=t("lodash/core"),i=t("csv-parse/lib/es5"),o=t("csv-parse/lib/es5/sync"),s=t("csv-stringify"),a=t("csv-stringify/lib/sync");e.exports={parseCSV:function(t,e){return e=r.extend({},e,{columns:!0}),o(t,e)},toCSV:function(t,e){return e=r.extend({},e,{header:!0}),a(t,e)},parseCSVStream:function(t){return t=r.extend({},t,{columns:!0}),i(t)},serializeCSVStream:function(t){return t=r.extend({},t,{header:!0}),s(t)}}},{"csv-parse/lib/es5":44,"csv-parse/lib/es5/sync":45,"csv-stringify":46,"csv-stringify/lib/sync":47,"lodash/core":89}],22:[function(t,e,n){"use strict";var s=t("lodash/core"),a=e.exports=function(t){this._literal=t};function u(t){return(t<10?"0":"")+t}a.prototype.toString=a.prototype.toJSON=function(){return this._literal},a.toDateLiteral=function(t){s.isNumber(t)?t=new Date(t):s.isString(t)&&(t=a.parseDate(t));var e=t.getFullYear(),n=t.getMonth()+1,t=t.getDate(),t=[e,u(n),u(t)].join("-");return new a(t)},a.toDateTimeLiteral=function(t){s.isNumber(t)?t=new Date(t):s.isString(t)&&(t=a.parseDate(t));var e=t.getUTCFullYear(),n=t.getUTCMonth()+1,r=t.getUTCDate(),i=t.getUTCHours(),o=t.getUTCMinutes(),t=t.getUTCSeconds(),t=[e,u(n),u(r)].join("-")+"T"+[u(i),u(o),u(t)].join(":")+"Z";return new a(t)},a.parseDate=function(t){var e=new Date,n=t.match(/^([\d]{4})-?([\d]{2})-?([\d]{2})(T([\d]{2}):?([\d]{2}):?([\d]{2})(.([\d]{3}))?(Z|([\+\-])([\d]{2}):?([\d]{2})))?$/);if(n){var r,e=new Date(0);return n[4]?(e.setUTCFullYear(parseInt(n[1],10)),e.setUTCDate(parseInt(n[3],10)),e.setUTCMonth(parseInt(n[2],10)-1),e.setUTCHours(parseInt(n[5],10)),e.setUTCMinutes(parseInt(n[6],10)),e.setUTCSeconds(parseInt(n[7],10)),e.setUTCMilliseconds(parseInt(n[9]||"0",10)),n[10]&&"Z"!==n[10]&&(r=60*parseInt(n[12],10)+parseInt(n[13],10),e.setTime(("+"===n[11]?-1:1)*r*60*1e3+e.getTime()))):(e.setFullYear(parseInt(n[1],10)),e.setDate(parseInt(n[3],10)),e.setMonth(parseInt(n[2],10)-1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)),e}throw new Error("Invalid date format is specified : "+t)};var r,i={YESTERDAY:1,TODAY:1,TOMORROW:1,LAST_WEEK:1,THIS_WEEK:1,NEXT_WEEK:1,LAST_MONTH:1,THIS_MONTH:1,NEXT_MONTH:1,LAST_90_DAYS:1,NEXT_90_DAYS:1,LAST_N_DAYS:2,NEXT_N_DAYS:2,NEXT_N_WEEKS:2,LAST_N_WEEKS:2,NEXT_N_MONTHS:2,LAST_N_MONTHS:2,THIS_QUARTER:1,LAST_QUARTER:1,NEXT_QUARTER:1,NEXT_N_QUARTERS:2,LAST_N_QUARTERS:2,THIS_YEAR:1,LAST_YEAR:1,NEXT_YEAR:1,NEXT_N_YEARS:2,LAST_N_YEARS:2,THIS_FISCAL_QUARTER:1,LAST_FISCAL_QUARTER:1,NEXT_FISCAL_QUARTER:1,NEXT_N_FISCAL_QUARTERS:2,LAST_N_FISCAL_QUARTERS:2,THIS_FISCAL_YEAR:1,LAST_FISCAL_YEAR:1,NEXT_FISCAL_YEAR:1,NEXT_N_FISCAL_YEARS:2,LAST_N_FISCAL_YEARS:2};for(r in i){var o=i[r];a[r]=1===o?new a(r):function(e){return function(t){return new a(e+":"+t)}}(r)}},{"lodash/core":89}],23:[function(e,t,n){"use strict";function r(e,t){t=t||{},this._conn=e,this.on("resume",function(t){e.emit("resume",t)}),this._responseType=t.responseType,this._transport=t.transport||e._transport,this._noContentResponse=t.noContentResponse}var i=e("inherits"),o=e("events"),s=e("lodash/core"),l=e("./promise");function a(t){return JSON.parse(t)}function u(t){var n={};if(e("xml2js").parseString(t,{explicitArray:!1},function(t,e){n={error:t,result:e}}),n.error)throw n.error;return n.result}function c(t){return e("./csv").parseCSV(t)}function h(t){return t}i(r,o.EventEmitter),r.prototype.request=function(n,t){function r(t){t?u.reject(t):(a!==e.instanceUrl&&(n.url=n.url.replace(a,e.instanceUrl)),i.request(n).then(function(t){u.resolve(t)},function(t){u.reject(t)}))}var i=this,e=this._conn,o=e._logger,s=this.getRefreshDelegate(),a=e.instanceUrl,u=l.defer();if(s&&s._refreshing)return s.once("resume",r),u.promise.thenCall(t);i.beforeSend(n),i.emit("request",n),o.debug("<request> method="+n.method+", url="+n.url);var c=Date.now();return this._transport.httpRequest(n).then(function(t){var e=Date.now();if(o.debug("elapsed time : "+(e-c)+"msec"),o.debug("<response> status="+t.statusCode+", url="+n.url),i.emit("response",t),i.isSessionExpired(t)&&s)return s.refresh(c,r),u.promise;if(i.isErrorResponse(t))throw i.getError(t);return i.getResponseBody(t)},function(t){var e=Date.now();throw o.debug("elapsed time : "+(e-c)+"msec"),o.error(t),t}).thenCall(t)},r.prototype.getRefreshDelegate=function(){return this._conn._refreshDelegate},r.prototype.beforeSend=function(t){if(t.headers=t.headers||{},this._conn.accessToken&&(t.headers.Authorization="Bearer "+this._conn.accessToken),this._conn.callOptions){var e,n=[];for(e in this._conn.callOptions)n.push(e+"="+this._conn.callOptions[e]);t.headers["Sforce-Call-Options"]=n.join(", ")}},r.prototype.getResponseContentType=function(t){return this._responseType||t.headers&&t.headers["content-type"]},r.prototype.parseResponseBody=function(e){var t=this.getResponseContentType(e),n=/^(text|application)\/xml(;|$)/.test(t)?u:/^application\/json(;|$)/.test(t)?a:/^text\/csv(;|$)/.test(t)?c:h;try{return n(e.body)}catch(t){return e.body}},r.prototype.getResponseBody=function(t){if(204===t.statusCode)return this._noContentResponse;var e,n=this.parseResponseBody(t);if(this.hasErrorInResponseBody(n))throw e=this.getError(t,n);if(300===t.statusCode)throw(e=new Error("Multiple records found")).name="MULTIPLE_CHOICES",e.content=n,e;return n},r.prototype.isSessionExpired=function(t){return 401===t.statusCode},r.prototype.isErrorResponse=function(t){return 400<=t.statusCode},r.prototype.hasErrorInResponseBody=function(t){return!1},r.prototype.parseError=function(t){return s.isArray(t)?t[0]:t},r.prototype.getError=function(t,e){var n;try{n=this.parseError(e||this.parseResponseBody(t))}catch(t){}n=s.isObject(n)&&s.isString(n.message)?n:{errorCode:"ERROR_HTTP_"+t.statusCode,message:t.body};var r,i=new Error(n.message);for(r in i.name=n.errorCode,n)i[r]=n[r];return i};function f(t,e){this._conn=t,this._refreshFn=e,this._refreshing=!1}i(f,o.EventEmitter),f.prototype.refresh=function(t,e){if(this._lastRefreshedAt>t)return e();var r=this,i=this._conn,o=i._logger;return r.once("resume",e),r._refreshing?void 0:(o.debug("<refresh token>"),r._refreshing=!0,r._refreshFn(i,function(t,e,n){t||(o.debug("Connection refresh completed."),i.accessToken=e,i.emit("refresh",e,n)),r._lastRefreshedAt=Date.now(),r._refreshing=!1,r.emit("resume",t)}))},r.SessionRefreshDelegate=f,t.exports=r},{"./csv":21,"./promise":27,events:48,inherits:85,"lodash/core":89,xml2js:124}],24:[function(t,e,n){"use strict";var r,i=e.exports=function(t){"string"==typeof t&&(t=o[t]),t=t||o.INFO,this._logLevel=t},o=i.LogLevels={DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5};for(r in i.prototype.log=function(t,e){this._logLevel<=t&&(t<o.ERROR?console.log(e):console.error(e))},o)i.prototype[r.toLowerCase()]=function(e){return function(t){this.log(e,t)}}(o[r])},{}],25:[function(t,e,n){"use strict";var r=t("querystring"),i=t("lodash/core"),o=t("./transport"),s="https://login.salesforce.com",e=e.exports=function(t){t.authzServiceUrl&&t.tokenServiceUrl?(this.loginUrl=t.authzServiceUrl.split("/").slice(0,3).join("/"),this.authzServiceUrl=t.authzServiceUrl,this.tokenServiceUrl=t.tokenServiceUrl,this.revokeServiceUrl=t.revokeServiceUrl):(this.loginUrl=t.loginUrl||s,this.authzServiceUrl=this.loginUrl+"/services/oauth2/authorize",this.tokenServiceUrl=this.loginUrl+"/services/oauth2/token",this.revokeServiceUrl=this.loginUrl+"/services/oauth2/revoke"),this.clientId=t.clientId,this.clientSecret=t.clientSecret,this.redirectUri=t.redirectUri,t.proxyUrl?this._transport=new o.ProxyTransport(t.proxyUrl):t.httpProxy?this._transport=new o.HttpProxyTransport(t.httpProxy):this._transport=new o};i.extend(e.prototype,{getAuthorizationUrl:function(t){return t=i.extend({response_type:"code",client_id:this.clientId,redirect_uri:this.redirectUri},t||{}),this.authzServiceUrl+(0<=this.authzServiceUrl.indexOf("?")?"&":"?")+r.stringify(t)},refreshToken:function(t,e){t={grant_type:"refresh_token",refresh_token:t,client_id:this.clientId};return this.clientSecret&&(t.client_secret=this.clientSecret),this._postParams(t,e)},requestToken:function(t,e,n){return"function"==typeof e&&(n=e,e={}),e=i.extend({grant_type:"authorization_code",code:t,client_id:this.clientId,redirect_uri:this.redirectUri},e||{}),this.clientSecret&&(e.client_secret=this.clientSecret),this._postParams(e,n)},authenticate:function(t,e,n){return this._postParams({grant_type:"password",username:t,password:e,client_id:this.clientId,client_secret:this.clientSecret,redirect_uri:this.redirectUri},n)},revokeToken:function(t,e){return this._transport.httpRequest({method:"POST",url:this.revokeServiceUrl,body:r.stringify({token:t}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){if(400<=t.statusCode){var e=r.parse(t.body);e&&e.error||(e={error:"ERROR_HTTP_"+t.statusCode,error_description:t.body});t=new Error(e.error_description);throw t.name=e.error,t}}).thenCall(e)},_postParams:function(t,e){return this._transport.httpRequest({method:"POST",url:this.tokenServiceUrl,body:r.stringify(t),headers:{"content-type":"application/x-www-form-urlencoded"}}).then(function(t){var e;try{e=JSON.parse(t.body)}catch(t){}if(400<=t.statusCode){e=e||{error:"ERROR_HTTP_"+t.statusCode,error_description:t.body};var n=new Error(e.error_description);throw n.name=e.error,n}return e}).thenCall(e)}})},{"./transport":36,"lodash/core":89,querystring:97}],26:[function(t,e,n){"use strict";var o=t("lodash/core"),r=(t("./promise"),t("./connection"),e.exports=function(t){this.rule=new r(t),this.approval=new i(t)},function(t){this._conn=t});r.prototype.list=function(t){return this._conn.request("/process/rules").then(function(t){return t.rules}).thenCall(t)},r.prototype.trigger=function(t,e){return t=o.isArray(t)?t:[t],this._conn.request({method:"POST",url:"/process/rules/",body:JSON.stringify({contextIds:t}),headers:{"content-type":"application/json"}}).thenCall(e)};var i=function(t){this._conn=t};i.prototype.list=function(t){return this._conn.request("/process/approvals").then(function(t){return t.approvals}).thenCall(t)},i.prototype.request=function(t,e){return t=t.map(function(t){return t._request||t}),this._conn.request({method:"POST",url:"/process/approvals",headers:{"content-type":"application/json"},body:JSON.stringify({requests:t})}).thenCall(e)},i.prototype._createRequest=function(t,e,n,r,i){"function"==typeof n&&(i=n,n=r=null),"function"==typeof r&&(i=r,r=null),r=r||{};n={actionType:t,contextId:e,comments:n};return o.extend(n,r),new s(this,n).thenCall(i)},i.prototype.submit=function(t,e,n,r){return this._createRequest("Submit",t,e,n,r)},i.prototype.approve=function(t,e,n,r){return this._createRequest("Approve",t,e,n,r)},i.prototype.reject=function(t,e,n,r){return this._createRequest("Reject",t,e,n,r)};var s=function(t,e){this._process=t,this._request=e};s.prototype.then=function(t,e){this._promise||(this._promise=this._process.request([this]).then(function(t){return t[0]})),this._promise.then(t,e)},s.prototype.thenCall=function(e){return e?this.then(function(t){e(null,t)},function(t){e(t)}):this}},{"./connection":19,"./promise":27,"lodash/core":89}],27:[function(i,o,t){(function(n){"use strict";var t=i("lodash/core"),e=i("promise/lib/es6-extensions");e.prototype.thenCall=function(e){return t.isFunction(e)&&this.then(function(t){n.nextTick(function(){e(null,t)})},function(t){n.nextTick(function(){e(t)})}),this},e.prototype.fail=e.prototype.catch,e.defer=function(){return new r};var r=function(){var n=this;this.promise=new e(function(t,e){n.resolve=t,n.reject=e})};o.exports=e}).call(this,i("_process"))},{_process:92,"lodash/core":89,"promise/lib/es6-extensions":94}],28:[function(s,u,t){(function(n){"use strict";var t=s("inherits"),e=(s("events"),s("readable-stream")),c=s("lodash/core"),l=s("./promise"),r=(s("./date"),s("./soql-builder")),i=s("./record-stream"),o=u.exports=function(t,e,n){o.super_.call(this,{objectMode:!0}),this._conn=t,c.isString(e)?this._soql=e:e.locator&&0<=e.locator.indexOf("/")?this._locator=e.locator.split("/").pop():(this._config=e,this.select(e.fields),e.includes&&this.include(e.includes),e.sort&&this.sort(e.sort)),this._options=c.defaults(n||{},{maxFetch:1e4,autoFetch:!1,scanAll:!1,responseTarget:h.QueryResult}),this._executed=!1,this._finished=!1,this._chaining=!1,this._deferred=l.defer()};t(o,e.Readable),o.prototype.select=function(t){if(this._soql)throw Error("Cannot set select fields for the query which has already built SOQL.");if(t=t||"*",c.isString(t))t=t.split(/\s*,\s*/);else if(c.isObject(t)&&!c.isArray(t)){var e,n=[];for(e in t)t[e]&&n.push(e);t=n}return this._config.fields=t,this},o.prototype.where=function(t){if(this._soql)throw Error("Cannot set where conditions for the query which has already built SOQL.");return this._config.conditions=t,this},o.prototype.limit=function(t){if(this._soql)throw Error("Cannot set limit for the query which has already built SOQL.");return this._config.limit=t,this},o.prototype.skip=o.prototype.offset=function(t){if(this._soql)throw Error("Cannot set skip/offset for the query which has already built SOQL.");return this._config.offset=t,this},o.prototype.sort=o.prototype.orderby=function(t,e){if(this._soql)throw Error("Cannot set sort for the query which has already built SOQL.");return c.isString(t)&&c.isString(e)&&(t=[[t,e]]),this._config.sort=t,this},o.prototype.include=function(t,e,n,r){if(this._soql)throw Error("Cannot include child relationship into the query which has already built SOQL.");if(!c.isObject(t)){r={table:t,conditions:e,fields:n,limit:r&&r.limit,offset:r&&(r.offset||r.skip),sort:r&&r.sort};c.isArray(this._config.includes)||(this._config.includes=[]),this._config.includes.push(r);r=new a(this._conn,this,r);return this._children=this._children||[],this._children.push(r),r}var i,o=t;for(i in o){var s=o[i];this.include(i,s.conditions,s.fields,s)}},o.prototype.maxFetch=function(t){return this._options.maxFetch=t,this},o.prototype.autoFetch=function(t){return this._options.autoFetch=t,this},o.prototype.scanAll=function(t){return this._options.scanAll=t,this};var h=o.ResponseTargets={};["QueryResult","Records","SingleRecord","Count"].forEach(function(t){h[t]=t}),o.prototype.setResponseTarget=function(t){return t in h&&(this._options.responseTarget=t),this},o.prototype.run=o.prototype.exec=o.prototype.execute=function(n,r){var i=this,o=this._conn._logger,s=this._deferred;if(this._executed)return s.reject(new Error("re-executing already executed query")),this;if(this._finished)return s.reject(new Error("executing already closed query")),this;"function"==typeof n&&(r=n,n={}),n={headers:(n=n||{}).headers||i._options.headers,responseTarget:n.responseTarget||i._options.responseTarget,autoFetch:n.autoFetch||i._options.autoFetch,maxFetch:n.maxFetch||i._options.maxFetch,scanAll:n.scanAll||i._options.scanAll};function e(e,t){if(c.isFunction(r))try{t=r(e,t),e=null}catch(t){e=t}e?s.reject(e):s.resolve(t)}return this.once("response",function(t){e(null,t)}),this.once("error",function(t){e(t)}),this.once("fetch",function(){var e,t;n.responseTarget===h.Records&&(i._chaining||r)&&(o.debug("--- collecting all fetched records ---"),e=[],t=function(t){e.push(t)},i.on("record",t),i.once("end",function(){i.removeListener("record",t),i.emit("response",e,i)}))}),this._executed=!0,o.debug(">>> Query start >>>"),this._execute(n).then(function(){o.debug("*** Query finished ***")}).fail(function(t){o.debug("--- Query error ---"),i.emit("error",t)}),this},o.prototype._execute=function(o){var s=this,e=this._conn._logger,a=o.responseTarget,u=o.autoFetch,c=o.maxFetch,n=o.scanAll;return l.resolve(s._locator?s._conn._baseUrl()+"/query/"+s._locator:s.toSOQL().then(function(t){return s.totalFetched=0,e.debug("SOQL = "+t),s._conn._baseUrl()+"/"+(n?"queryAll":"query")+"?q="+encodeURIComponent(t)})).then(function(t){return s._conn.request({method:"GET",url:t,headers:o.headers})}).then(function(t){var e;switch(s.emit("fetch"),s.totalSize=t.totalSize,a){case h.SingleRecord:e=t.records&&0<t.records.length?t.records[0]:null;break;case h.Records:e=t.records;break;case h.Count:e=t.totalSize;break;default:e=t}a!==h.Records&&s.emit("response",e,s);for(var n=t.records&&t.records.length||0,r=0;r<n;r++){if(s.totalFetched>=c){s._finished=!0;break}var i=t.records[r];s.push(i),s.emit("record",i,s.totalFetched++,s)}return t.nextRecordsUrl&&(s._locator=t.nextRecordsUrl.split("/").pop()),s._finished=s._finished||t.done||!u,s._finished?s.push(null):s._execute(o),e})},o.prototype._read=function(t){this._finished||this._executed||this.execute({autoFetch:!0})},o.prototype.on=function(t,e){var n;return"record"===t&&(n=this).on("readable",function(){for(;null!==n.read(););}),o.super_.prototype.on.call(this,t,e)},o.prototype.addListener=o.prototype.on,o.prototype._expandFields=function(){if(this._soql)return l.reject(new Error("Cannot expand fields for the query which has already built SOQL."));var n,t,r=this,s=r._conn._logger,e=this._conn,i=this._config.table,o=this._config.fields||[];return s.debug("_expandFields: table = "+i+", fields = "+o.join(", ")),l.all([l.resolve(r._parent?(n=i,t=r._parent._config.table,s.debug('finding table for relation "'+n+'" in "'+t+'"...'),a(t).then(function(t){var e=n.toUpperCase(),t=c.find(t.childRelationships,function(t){return(t.relationshipName||"").toUpperCase()===e});return t?t.childSObject:l.reject(new Error("No child relationship found: "+n))})):i).then(function(e){return l.all(c.map(o,function(t){return function r(i,t){s.debug('expanding field "'+t+'" in "'+i+'"...');var o=t.split(".");return"*"===o[o.length-1]?a(i).then(function(t){if(s.debug("table "+i+"has been described"),1<o.length){var e=o.shift(),n=c.find(t.fields,function(t){return t.relationshipName&&t.relationshipName.toUpperCase()===e.toUpperCase()});if(n){var n=1===n.referenceTo.length?n.referenceTo[0]:"Name";return r(n,o.join(".")).then(function(t){return c.map(t,function(t){return e+"."+t})})}return[]}return c.map(t.fields,function(t){return t.name})}):l.resolve([t])}(e,t)})).then(function(t){r._config.fields=c.flatten(t)})}),l.all(c.map(r._children||[],function(t){return t._expandFields()}))]);function a(t){s.debug("describe cache: "+t);var n=l.defer();return e.describe$(t,function(t,e){s.debug("... done."),t?n.reject(t):n.resolve(e)}),n.promise}},o.prototype.explain=function(t){var e=this,n=this._conn._logger;return e.toSOQL().then(function(t){n.debug("SOQL = "+t);t="/query/?explain="+encodeURIComponent(t);return e._conn.request(t)}).thenCall(t)},o.prototype.toSOQL=function(t){var e=this;return l.resolve(e._soql||e._expandFields().then(function(){return r.createSOQL(e._config)})).thenCall(t)},o.prototype.stream=i.Serializable.prototype.stream,o.prototype.map=i.prototype.map,o.prototype.filter=i.prototype.map;o.prototype.delete=o.prototype.del=o.prototype.destroy=function(o,t,e){if("function"==typeof o?(e=o,t={},o=null):"object"==typeof o&&null!==o&&(e=t,t=o,o=null),t=t||{},!(o=o||this._config&&this._config.table))throw new Error("SOQL based query needs SObject type information to bulk delete.");var s=!1===t.allowBulk?-1:"number"==typeof t.bulkThreshold?t.bulkThreshold:this._conn._ensureVersion(42)?200:this._conn.maxRequest/2,a=this;return new l(function(e,n){var r=[],i=null;a.on("data",function(t){t.Id?(t={Id:t.Id},i?i.write(t):(r.push(t),(s<0||r.length>s)&&(i=a._conn.sobject(o).deleteBulk().on("response",e).on("error",n),r.forEach(function(t){i.write(t)}),r=[]))):a.emit("error",new Error("Queried record does not include Salesforce record ID."))}).on("end",function(){var t;i?i.end():(t=r.map(function(t){return t.Id}),a._conn.sobject(o).destroy(t,{allowRecursive:!0}).then(e,n))}).on("error",n)}).thenCall(e)},o.prototype.update=function(t,o,e,n){if("function"==typeof o?(n=o,e={},o=null):"object"==typeof o&&null!==o&&(n=e,e=o,o=null),e=e||{},!(o=o||this._config&&this._config.table))throw new Error("SOQL based query needs SObject type information to bulk update.");var s=c.isFunction(t)?i.map(t):i.recordMapStream(t),a=!1===e.allowBulk?-1:"number"==typeof e.bulkThreshold?e.bulkThreshold:this._conn._ensureVersion(42)?200:this._conn.maxRequest/2,u=this;return new l(function(e,n){var r=[],i=null;u.on("error",n).pipe(s).on("data",function(t){i?i.write(t):(r.push(t),(a<0||r.length>a)&&(i=u._conn.sobject(o).updateBulk().on("response",e).on("error",n),r.forEach(function(t){i.write(t)}),r=[]))}).on("end",function(){i?i.end():u._conn.sobject(o).update(r,{allowRecursive:!0}).then(e,n)}).on("error",n)}).thenCall(n)},o.prototype.then=function(t,e){return this._chaining=!0,this._finished||this._executed||this.execute(),this._deferred.promise.then.apply(this._deferred.promise,arguments)},o.prototype.thenCall=function(e){return c.isFunction(e)&&this.then(function(t){n.nextTick(function(){e(null,t)})},function(t){n.nextTick(function(){e(t)})}),this};var a=function(t,e,n){a.super_.call(this,t,n),this._parent=e};t(a,o),a.prototype.include=function(){throw new Error("Not allowed to include another subquery in subquery.")},a.prototype.end=function(){return this._parent},a.prototype.run=a.prototype.exec=a.prototype.execute=function(){return this._parent.execute.apply(this._parent,arguments)}}).call(this,s("_process"))},{"./date":22,"./promise":27,"./record-stream":30,"./soql-builder":35,_process:92,events:48,inherits:85,"lodash/core":89,"readable-stream":108}],29:[function(t,e,n){"use strict";e=e.exports=function(t,e){this._conn=t,this._path=e};e.prototype.describe=function(t){var e=this._path+"/describe";return this._conn.request(e).thenCall(t)},e.prototype.defaultValues=function(t,e){"function"==typeof t&&(e=t,t=null);var n=this._path+"/defaultValues";return t&&(n+="/"+t),this._conn.request(n).thenCall(e)},e.prototype.execute=function(t,e,n){e={contextId:t,record:e};return this._conn.requestPost(this._path,e).thenCall(n)}},{}],30:[function(t,e,n){"use strict";t("events");var r=t("readable-stream"),i=(r.Duplex,r.Transform),o=r.PassThrough,r=t("inherits"),a=t("lodash/core"),s=t("./csv"),u=e.exports=function(){u.super_.call(this,{objectMode:!0})};r(u,i),u.prototype._transform=function(t,e,n){this.emit("record",t),this.push(t),n()},u.prototype.map=function(t){return this.pipe(u.map(t))},u.prototype.filter=function(t){return this.pipe(u.filter(t))};var c=u.Serializable=function(){c.super_.call(this),this._dataStream=null};r(c,u),c.prototype.stream=function(t,e){var n=h[t=t||"csv"];if(!n)throw new Error("Converting ["+t+"] data stream is not supported.");return this._dataStream||(this._dataStream=new o,this.pipe(n.serialize(e)).pipe(this._dataStream)),this._dataStream};var l=u.Parsable=function(){l.super_.call(this),this._dataStream=null};r(l,u),l.prototype.stream=function(t,e){var n=h[t=t||"csv"],r=this;if(!n)throw new Error("Converting ["+t+"] data stream is not supported.");return this._dataStream||(this._dataStream=new o,this._parserStream=n.parse(e).on("error",function(t){r.emit("error",t)}),this._parserStream.pipe(this).pipe(new o({objectMode:!0,highWaterMark:5e5}))),this._dataStream},l.prototype.on=function(t,e){return"readable"!==t&&"record"!==t||this._dataStream.pipe(this._parserStream),l.super_.prototype.on.call(this,t,e)},l.prototype.addListener=l.prototype.on,u.map=function(r){var t=new u.Serializable;return t._transform=function(t,e,n){t=r(t)||t;this.push(t),n()},t},u.recordMapStream=function(r,i){return u.map(function(t){var e,n={Id:t.Id};for(e in r)n[e]=i?r[e]:function(t,n){{if(a.isString(t)){var e=/^\$\{(\w+)\}$/.exec(t);return e?n[e[1]]:t.replace(/\$\{(\w+)\}/g,function(t,e){e=n[e];return a.isNull(e)||a.isUndefined(e)?"":String(e)})}return t}}(r[e],t);return n})},u.filter=function(r){var t=new u.Serializable;return t._transform=function(t,e,n){r(t)&&this.push(t),n()},t};var r={serialize:function(e){return e=e||{},n=u.map(function(t){return function o(t,s){return Object.keys(t).reduce(function(t,n){var r,e=t[n],i={};return"attributes"===n?delete(t=a.extend({},t))[n]:s.nullValue&&null===e?(i[n]=s.nullValue,t=a.extend({},t,i)):null!==e&&"object"==typeof e&&(r=o(e,s),t=Object.keys(r).reduce(function(t,e){return t[n+"."+e]=r[e],t},a.extend({},t))),t},t)}(t,e)}),r=s.serializeCSVStream(e),(i=new o).on("pipe",function(t){t.unpipe(i),t.pipe(n).pipe(r)}),i.pipe=function(t,e){return r.pipe(t,e)},i;var n,r,i},parse:function(t){return s.parseCSVStream(t)}},h=u.DataStreamConverters={csv:r}},{"./csv":21,events:48,inherits:85,"lodash/core":89,"readable-stream":108}],31:[function(t,e,n){"use strict";var r=t("lodash/core"),e=e.exports=function(t,e,n){this._conn=t,this.type=e,this.id=n};e.prototype.retrieve=function(t,e){return"function"==typeof t&&(e=t,t={}),this._conn.retrieve(this.type,this.id,t,e)},e.prototype.update=function(t,e,n){return"function"==typeof e&&(n=e,e={}),(t=r.clone(t)).Id=this.id,this._conn.update(this.type,t,e,n)},e.prototype.delete=e.prototype.del=e.prototype.destroy=function(t,e){return"function"==typeof t&&(e=t,t={}),this._conn.destroy(this.type,this.id,t,e)},e.prototype.blob=function(t){t=[this._conn._baseUrl(),"sobjects",this.type,this.id,t].join("/");return this._conn.request(t).stream()}},{"lodash/core":89}],32:[function(t,e,n){"use strict";var r=t("./_required");e.exports=function(t){"./jsforce"!==t&&"jsforce"!==t||(t="./core");var e=r[t];if(void 0===e)throw new Error("Cannot find module '"+t+"'");return e}},{"./_required":3}],33:[function(t,e,n){"use strict";var r=t("inherits"),s=t("lodash/core"),t=(t("xml2js"),t("./http-api")),i=e.exports=function(t,e){i.super_.apply(this,arguments),this._endpointUrl=e.endpointUrl,this._xmlns=e.xmlns||"urn:partner.soap.sforce.com"};function o(t,e){var n=e.shift();if(n){for(var r in t)if(n.test(r))return o(t[r],e);return null}return t}function a(e,t){if(s.isObject(e)&&(t=e,e=null),s.isArray(t))return s.map(t,function(t){return a(e,t)}).join("");var n=[],r=[];if(s.isObject(t)){for(var i in t){var o=t[i];"@"===i[0]?(i=i.substring(1),n.push(i+'="'+o+'"')):r.push(a(i,o))}t=r.join("")}else t=String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");return(e?"<"+e+(0<n.length?" "+n.join(" "):"")+">":"")+t+(e?"</"+e+">":"")}r(i,t),i.prototype.invoke=function(t,e,n,r){"function"==typeof n&&(r=n,n=null);var i={};return i[t]=e,this.request({method:"POST",url:this._endpointUrl,headers:{"Content-Type":"text/xml",SOAPAction:'""'},message:i}).then(function(t){return n?function e(t,n){{if(s.isArray(t))return t.map(function(t){return e(t,n&&n[0])});if(s.isObject(t)){if(t.$&&"true"===t.$["xsi:nil"])return null;if(s.isArray(n))return[e(t,n[0])];var r,i={};for(r in t)i[r]=e(t[r],n&&n[r]);return i}if(s.isArray(n))return[e(t,n[0])];if(s.isObject(n))return{};switch(n){case"string":return String(t);case"number":return Number(t);case"boolean":return"true"===t;default:return t}}}(t,n):t}).thenCall(r)},i.prototype.beforeSend=function(t){t.body=this._createEnvelope(t.message)},i.prototype.isSessionExpired=function(t){return 500===t.statusCode&&/<faultcode>[a-zA-Z]+:INVALID_SESSION_ID<\/faultcode>/.test(t.body)},i.prototype.parseError=function(t){t=o(t,[/:Envelope$/,/:Body$/,/:Fault$/]);return{errorCode:t.faultcode,message:t.faultstring}},i.prototype.getResponseBody=function(t){return o(i.super_.prototype.getResponseBody.call(this,t),[/:Envelope$/,/:Body$/,/.+/])},i.prototype._createEnvelope=function(t){var e={},n=this._conn;return n.accessToken&&(e.SessionHeader={sessionId:this._conn.accessToken}),n.callOptions&&(e.CallOptions=n.callOptions),['<?xml version="1.0" encoding="UTF-8"?>','<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"',' xmlns:xsd="http://www.w3.org/2001/XMLSchema"',' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">','<soapenv:Header xmlns="'+this._xmlns+'">',a(e),"</soapenv:Header>",'<soapenv:Body xmlns="'+this._xmlns+'">',a(t),"</soapenv:Body>","</soapenv:Envelope>"].join("")}},{"./http-api":23,inherits:85,"lodash/core":89,xml2js:124}],34:[function(t,e,n){"use strict";var i=t("lodash/core"),r=t("./record"),o=t("./query"),s=(t("./cache"),t("./quick-action")),e=e.exports=function(t,e){this._conn=t,this.type=e;e={key:"describe."+this.type};this.describe$=t.cache.makeCacheable(this.describe,this,e),this.describe=t.cache.makeResponseCacheable(this.describe,this,e),e={key:"layouts."+this.type},this.layouts$=t.cache.makeCacheable(this.layouts,this,e),this.layouts=t.cache.makeResponseCacheable(this.layouts,this,e),e={key:"compactLayouts."+this.type},this.compactLayouts$=t.cache.makeCacheable(this.compactLayouts,this,e),this.compactLayouts=t.cache.makeResponseCacheable(this.compactLayouts,this,e),e={key:"approvalLayouts."+this.type},this.approvalLayouts$=t.cache.makeCacheable(this.approvalLayouts,this,e),this.approvalLayouts=t.cache.makeResponseCacheable(this.approvalLayouts,this,e)};e.prototype.insert=e.prototype.create=function(t,e,n){return"function"==typeof e&&(n=e,e={}),this._conn.create(this.type,t,e,n)},e.prototype.retrieve=function(t,e,n){return"function"==typeof e&&(n=e,e={}),this._conn.retrieve(this.type,t,e,n)},e.prototype.update=function(t,e,n){return"function"==typeof e&&(n=e,e={}),this._conn.update(this.type,t,e,n)},e.prototype.upsert=function(t,e,n,r){return"function"==typeof n&&(r=n,n={}),this._conn.upsert(this.type,t,e,n,r)},e.prototype.delete=e.prototype.del=e.prototype.destroy=function(t,e,n){return"function"==typeof e&&(n=e,e={}),this._conn.destroy(this.type,t,e,n)},e.prototype.describe=function(t){return this._conn.describe(this.type,t)},e.prototype.record=function(t){return new r(this._conn,this.type,t)},e.prototype.find=function(t,e,n,r){"function"==typeof t?(r=t,t={},n=e=null):"function"==typeof e?(r=e,n=e=null):"function"==typeof n&&(r=n,n=null);t={fields:e,includes:(n=n||{}).includes,table:this.type,conditions:t,limit:n.limit,sort:n.sort,offset:n.offset||n.skip},n=new o(this._conn,t,n);return n.setResponseTarget(o.ResponseTargets.Records),r&&n.run(r),n},e.prototype.findOne=function(t,e,n,r){"function"==typeof t?(r=t,t={},n=e=null):"function"==typeof e?(r=e,n=e=null):"function"==typeof n&&(r=n,n=null),n=i.extend(n||{},{limit:1});n=this.find(t,e,n);return n.setResponseTarget(o.ResponseTargets.SingleRecord),r&&n.run(r),n},e.prototype.select=function(t,e){return this.find(null,t,null,e)},e.prototype.count=function(t,e){"function"==typeof t&&(e=t,t={});t=this.find(t,{"count()":!0});return t.setResponseTarget("Count"),e&&t.run(e),t},e.prototype.bulkload=function(t,e,n,r){return this._conn.bulk.load(this.type,t,e,n,r)},e.prototype.insertBulk=e.prototype.createBulk=function(t,e){return this.bulkload("insert",t,e)},e.prototype.updateBulk=function(t,e){return this.bulkload("update",t,e)},e.prototype.upsertBulk=function(t,e,n){return this.bulkload("upsert",{extIdField:e},t,n)},e.prototype.deleteBulk=e.prototype.destroyBulk=function(t,e){return this.bulkload("delete",t,e)},e.prototype.deleteHardBulk=e.prototype.destroyHardBulk=function(t,e){return this.bulkload("hardDelete",t,e)},e.prototype.recent=function(t){return this._conn.recent(this.type,t)},e.prototype.updated=function(t,e,n){return this._conn.updated(this.type,t,e,n)},e.prototype.deleted=function(t,e,n){return this._conn.deleted(this.type,t,e,n)},e.prototype.layouts=function(t,e){"function"==typeof t&&(e=t,t=null);t="/sobjects/"+this.type+"/describe/"+(t?"namedLayouts/"+t:"layouts");return this._conn.request(t,e)},e.prototype.compactLayouts=function(t){var e="/sobjects/"+this.type+"/describe/compactLayouts";return this._conn.request(e,t)},e.prototype.approvalLayouts=function(t){var e="/sobjects/"+this.type+"/describe/approvalLayouts";return this._conn.request(e,t)},e.prototype.listviews=function(t){var e=this._conn._baseUrl()+"/sobjects/"+this.type+"/listviews";return this._conn.request(e,t)},e.prototype.listview=function(t){return new a(this._conn,this.type,t)},e.prototype.quickActions=function(t){return this._conn.request("/sobjects/"+this.type+"/quickActions").thenCall(t)},e.prototype.quickAction=function(t){return new s(this._conn,"/sobjects/"+this.type+"/quickActions/"+t)};var a=function(t,e,n){this._conn=t,this.type=e,this.id=n};a.prototype.results=function(t){var e=this._conn._baseUrl()+"/sobjects/"+this.type+"/listviews/"+this.id+"/results";return this._conn.request(e,t)},a.prototype.describe=function(t,e){"function"==typeof t&&(e=t,t={}),t=t||{};var n=this._conn._baseUrl()+"/sobjects/"+this.type+"/listviews/"+this.id+"/describe";return this._conn.request({method:"GET",url:n,headers:t.headers},e)},a.prototype.explain=function(t){var e="/query/?explain="+this.id;return this._conn.request(e,t)}},{"./cache":18,"./query":28,"./quick-action":29,"./record":31,"lodash/core":89}],35:[function(t,e,n){"use strict";var a=t("lodash/core"),r=t("./date");function i(t){var e,e=["SELECT ",(e=t.fields,n=t.includes,n=a.map(a.values(n||{}),function(t){return"("+i(t)+")"}),(e||["Id"]).concat(n).join(", "))," FROM ",t.table].join(""),n=function r(i,o,s){if(a.isString(i))return i;i=i||[];o=o||"AND";s=s||0;i=l(i)?i.map(function(t){var e,n=[];for(e in t)n.push({key:e,value:t[e]});return 1<n.length?n:n[0]}):a.keys(i).map(function(t){return{key:t,value:i[t]}});i=i.map(function(t){var e,n=s+1;switch(t.key){case"$or":case"$and":case"$not":return"NOT"!==o&&1===i.length&&(n=s),e="$or"===t.key?"OR":"$and"===t.key?"AND":"NOT",r(t.value,e,n);default:return u(t.key,t.value)}}).filter(function(t){return t});var t;return"NOT"===o?((t=0<s)?"(":"")+"NOT "+i[0]+(t?")":""):((t=0<s&&1<i.length)?"(":"")+i.join(" "+o+" ")+(t?")":"")}(t.conditions);n&&(e+=" WHERE "+n);n=function(e){if(e=e||[],a.isString(e)){if(/,|\s+(asc|desc)\s*$/.test(e))return e;e=e.split(/\s+/).map(function(t){var e="ASC",n=t[0];return"-"===n?(e="DESC",t=t.substring(1)):"+"===n&&(t=t.substring(1)),[t,e]})}else l(e)||(e=a.keys(e).map(function(t){return[t,e[t]]}));return e.map(function(t){var e=t[0],n=t[1];switch(String(n)){case"DESC":case"desc":case"descending":case"-":case"-1":n="DESC";break;default:n="ASC"}return e+" "+n}).join(", ")}(t.sort);return n&&(e+=" ORDER BY "+n),t.limit&&(e+=" LIMIT "+t.limit),t.offset&&(e+=" OFFSET "+t.offset),e}var o={"=":"=",$eq:"=","!=":"!=",$ne:"!=",">":">",$gt:">","<":"<",$lt:"<",">=":">=",$gte:">=","<=":"<=",$lte:"<=",$like:"LIKE",$nlike:"NOT LIKE",$in:"IN",$nin:"NOT IN",$includes:"INCLUDES",$excludes:"EXCLUDES",$exists:"EXISTS"};function u(n,t){return a.isArray(t)?s(n,"$in",t):a.isObject(t)?a.map(t,function(t,e){if("$"===e[0])return s(n,e,t)}).join(" AND "):s(n,"$eq",t)}function s(t,e,n){var r=o[e];if(!r||a.isUndefined(n))return null;var i=c(n);if(a.isUndefined(i))return null;switch(r){case"NOT LIKE":return"("+["NOT",t,"LIKE",i].join(" ")+")";case"EXISTS":return[t,n?"!=":"=","null"].join(" ");default:return[t,r,i].join(" ")}}function c(t){return l(t)?0<t.length?"("+t.map(c).join(", ")+")":void 0:t instanceof r?t.toString():a.isString(t)?"'"+String(t||"").replace(/'/g,"\\'")+"'":a.isNumber(t)?t.toString():a.isNull(t)?"null":t}function l(t){return a.isObject(t)&&a.isFunction(t.pop)}n.createSOQL=i},{"./date":22,"lodash/core":89}],36:[function(h,f,t){(function(t){"use strict";var e,o,n=h("inherits"),s=h("./promise"),r=h("request"),i=h("./browser/canvas"),a=h("./browser/jsonp");r.defaults&&(e={followAllRedirects:!0},t.env.HTTP_PROXY&&(e.proxy=t.env.HTTP_PROXY),parseInt(t.env.HTTP_TIMEOUT)&&(e.timeout=parseInt(t.env.HTTP_TIMEOUT)),r=r.defaults(e)),o="undefined"==typeof window?t.env.LOCATION_BASE_URL||"":(u=function(t){var e=/(\w+)\.(visual\.force|salesforce)\.com$/.exec(t);e&&(t=e[1]+".salesforce.com");return t}(window.location.host))?"https://"+u:"";t=f.exports=function(){};t.prototype.httpRequest=function(t,e){var n,r=s.defer(),i=this._getHttpRequestModule();return function t(e,n){var r=e.then;return e.then=function(){return n(),t(r.apply(e,arguments),n)},e.stream=n,e}(r.promise,function(){return n=n||i(t,function(t,e){t?r.reject(t):r.resolve(e)})}).thenCall(e)},t.prototype._getHttpRequestModule=function(){return r};var u=t.JsonpTransport=function(t){this._jsonpParam=t};n(u,t),u.prototype._getHttpRequestModule=function(){return a.createRequest(this._jsonpParam)},u.supported=a.supported;u=t.CanvasTransport=function(t){this._signedRequest=t};n(u,t),u.prototype._getHttpRequestModule=function(){return i.createRequest(this._signedRequest)},u.supported=i.supported;var c=t.ProxyTransport=function(t){this._proxyUrl=t};n(c,t),c.prototype.httpRequest=function(t,e){var n=t.url;0===n.indexOf("/")&&(n=o+n);var r={method:t.method,url:this._proxyUrl+"?"+Date.now()+"."+(""+Math.random()).substring(2),headers:{"salesforceproxy-endpoint":n}};if(!t.body&&""!==t.body||(r.body=t.body),t.headers)for(var i in t.headers)r.headers[i]=t.headers[i];return c.super_.prototype.httpRequest.call(this,r,e)};var l=t.HttpProxyTransport=function(t){this._httpProxy=t};n(l,t),l.prototype.httpRequest=function(t,e){var n=t.url;0===n.indexOf("/")&&(n=o+n);var r={method:t.method,url:t.url,proxy:this._httpProxy,headers:{}};if(!t.body&&""!==t.body||(r.body=t.body),t.headers)for(var i in t.headers)r.headers[i]=t.headers[i];return l.super_.prototype.httpRequest.call(this,r,e)}}).call(this,h("_process"))},{"./browser/canvas":14,"./browser/jsonp":16,"./promise":27,_process:92,inherits:85,request:17}],37:[function(t,e,n){"use strict";var r=t("./raw"),i=[],o=[],s=r.makeRequestCallFromTimer(function(){if(o.length)throw o.shift()});function a(t){var e=i.length?i.pop():new u;e.task=t,r(e)}function u(){this.task=null}e.exports=a,u.prototype.call=function(){try{this.task.call()}catch(t){a.onerror?a.onerror(t):(o.push(t),s())}finally{this.task=null,i[i.length]=this}}},{"./raw":38}],38:[function(t,h,e){(function(t){"use strict";function e(t){r.length||(n(),0),r[r.length]=t}h.exports=e;var n,r=[],i=0;function o(){for(;i<r.length;){var t=i;if(i+=1,r[t].call(),1024<i){for(var e=0,n=r.length-i;e<n;e++)r[e]=r[e+i];r.length-=i,i=0}}r.length=0,i=0,0}var s,a,u,t=void 0!==t?t:self,c=t.MutationObserver||t.WebKitMutationObserver;function l(r){return function(){var t=setTimeout(n,0),e=setInterval(n,50);function n(){clearTimeout(t),clearInterval(e),r()}}}n="function"==typeof c?(a=1,s=new c(s=o),u=document.createTextNode(""),s.observe(u,{characterData:!0}),function(){a=-a,u.data=a}):l(o),e.requestFlush=n,e.makeRequestCallFromTimer=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(t,e,n){"use strict";n.byteLength=function(t){var e=l(t),t=e[0],e=e[1];return 3*(t+e)/4-e},n.toByteArray=function(t){for(var e,n=l(t),r=n[0],n=n[1],i=new c(function(t,e){return 3*(t+e)/4-e}(r,n)),o=0,s=0<n?r-4:r,a=0;a<s;a+=4)e=u[t.charCodeAt(a)]<<18|u[t.charCodeAt(a+1)]<<12|u[t.charCodeAt(a+2)]<<6|u[t.charCodeAt(a+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=255&e;2===n&&(e=u[t.charCodeAt(a)]<<2|u[t.charCodeAt(a+1)]>>4,i[o++]=255&e);1===n&&(e=u[t.charCodeAt(a)]<<10|u[t.charCodeAt(a+1)]<<4|u[t.charCodeAt(a+2)]>>2,i[o++]=e>>8&255,i[o++]=255&e);return i},n.fromByteArray=function(t){for(var e,n=t.length,r=n%3,i=[],o=0,s=n-r;o<s;o+=16383)i.push(function(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(function(t){return a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}(r));return i.join("")}(t,o,s<o+16383?s:o+16383));1==r?(e=t[n-1],i.push(a[e>>2]+a[e<<4&63]+"==")):2==r&&(e=(t[n-2]<<8)+t[n-1],i.push(a[e>>10]+a[e>>4&63]+a[e<<2&63]+"="));return i.join("")};for(var a=[],u=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)a[i]=r[i],u[r.charCodeAt(i)]=i;function l(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");t=t.indexOf("=");return-1===t&&(t=e),[t,t===e?0:4-t%4]}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],40:[function(t,e,n){},{}],41:[function(t,e,n){"use strict";var a=t("base64-js"),o=t("ieee754");n.Buffer=h,n.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},n.INSPECT_MAX_BYTES=50;var r=2147483647;function i(t){if(r<t)throw new RangeError("Invalid typed array length");t=new Uint8Array(t);return t.__proto__=h.prototype,t}function h(t,e,n){if("number"!=typeof t)return s(t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(t)}function s(t,e,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return D(t)||t&&D(t.buffer)?function(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');n=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n);return n.__proto__=h.prototype,n}(t,e,n):"string"==typeof t?function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!h.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|p(t,e),r=i(n),e=r.write(t,e);e!==n&&(r=r.slice(0,e));return r}(t,e):function(t){if(h.isBuffer(t)){var e=0|f(t.length),n=i(e);return 0===n.length?n:(t.copy(n,0,0,e),n)}if(t){if(ArrayBuffer.isView(t)||"length"in t)return"number"!=typeof t.length||j(t.length)?i(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t){return u(t),i(t<0?0:0|f(t))}function l(t){for(var e=t.length<0?0:0|f(t.length),n=i(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t){if(r<=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|t}function p(t,e){if(h.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||D(t))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(t).length;default:if(r)return O(t).length;e=(""+e).toLowerCase(),r=!0}}function d(t,e,n){var r,i,o,s=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return function(t,e,n){var r=t.length;(!e||e<0)&&(e=0);(!n||n<0||r<n)&&(n=r);for(var i="",o=e;o<n;++o)i+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[o]);return i}(this,e,n);case"utf8":case"utf-8":return v(this,e,n);case"ascii":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}(this,e,n);case"latin1":case"binary":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}(this,e,n);case"base64":return r=this,o=n,0===(i=e)&&o===r.length?a.fromByteArray(r):a.fromByteArray(r.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}(this,e,n);default:if(s)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),j(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=h.from(e,r)),h.isBuffer(e))return 0===e.length?-1:_(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,n):_(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,r,i){var o=1,s=t.length,a=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s/=o=2,a/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i)for(var c=-1,l=n;l<s;l++)if(u(t,l)===u(e,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===a)return c*o}else-1!==c&&(l-=l-c),c=-1;else for(s<n+a&&(n=s-a),l=n;0<=l;l--){for(var h=!0,f=0;f<a;f++)if(u(t,l+f)!==u(e,f)){h=!1;break}if(h)return l}return-1}function g(t,e,n,r){return A(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function b(t,e,n,r){return A(function(t,e){for(var n,r,i=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,r=r%256,i.push(r),i.push(n);return i}(e,t.length-n),t,n,r)}function v(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=239<c?4:223<c?3:191<c?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&127<(u=(31&c)<<6|63&o)&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&2047<(u=(15&c)<<12|(63&o)<<6|63&s)&&(u<55296||57343<u)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&65535<(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)&&u<1114112&&(l=u)}null===l?(l=65533,h=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=w)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=w));return n}(r)}n.kMaxLength=r,(h.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{get:function(){if(this instanceof h)return this.buffer}}),Object.defineProperty(h.prototype,"offset",{get:function(){if(this instanceof h)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=s,h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(t,e,n){return e=e,n=n,u(t=t),!(t<=0)&&void 0!==e?"string"==typeof n?i(t).fill(e,n):i(t).fill(e):i(t)},h.allocUnsafe=c,h.allocUnsafeSlow=c,h.isBuffer=function(t){return null!=t&&!0===t._isBuffer},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);if(void 0===e)for(i=e=0;i<t.length;++i)e+=t[i].length;for(var n=h.allocUnsafe(e),r=0,i=0;i<t.length;++i){var o=t[i];if(ArrayBuffer.isView(o)&&(o=h.from(o)),!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},h.prototype.toLocaleString=h.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?v(this,0,t):d.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,n,r,i){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=e)return 0;if(i<=r)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),u=this.slice(r,i),c=t.slice(e,n),l=0;l<a;++l)if(u[l]!==c[l]){o=u[l],s=c[l];break}return o<s?-1:s<o?1:0},h.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},h.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},h.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},h.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||i<n)&&(n=i),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,s,a,u=!1;;)switch(r){case"hex":return function(t,e,n,r){n=Number(n)||0;var i=t.length-n;(!r||i<(r=Number(r)))&&(r=i),(i=e.length)/2<r&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(j(s))return o;t[n+o]=s}return o}(this,t,e,n);case"utf8":case"utf-8":return s=e,a=n,A(O(t,(o=this).length-s),o,s,a);case"ascii":return g(this,t,e,n);case"latin1":case"binary":return g(this,t,e,n);case"base64":return o=this,s=e,a=n,A(N(t),o,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,t,e,n);default:if(u)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),u=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function E(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,n,r,i,o){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function x(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function S(t,e,n,r,i){return e=+e,n>>>=0,i||x(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function C(t,e,n,r,i){return e=+e,n>>>=0,i||x(t,0,n,8),o.write(t,e,n,r,52,8),n+8}h.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t);e=this.subarray(t,e);return e.__proto__=h.prototype,e},h.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||E(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},h.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||E(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},h.prototype.readUInt8=function(t,e){return t>>>=0,e||E(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return t>>>=0,e||E(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return t>>>=0,e||E(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return t>>>=0,e||E(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return t>>>=0,e||E(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||E(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*e)),r},h.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||E(t,e,this.length);for(var r=e,i=1,o=this[t+--r];0<r&&(i*=256);)o+=this[t+--r]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*e)),o},h.prototype.readInt8=function(t,e){return t>>>=0,e||E(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){t>>>=0,e||E(t,2,this.length);t=this[t]|this[t+1]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt16BE=function(t,e){t>>>=0,e||E(t,2,this.length);t=this[t+1]|this[t]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt32LE=function(t,e){return t>>>=0,e||E(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return t>>>=0,e||E(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return t>>>=0,e||E(t,4,this.length),o.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return t>>>=0,e||E(t,4,this.length),o.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return t>>>=0,e||E(t,8,this.length),o.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return t>>>=0,e||E(t,8,this.length),o.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||T(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},h.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||T(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+n},h.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,1,255,0),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},h.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeIntLE=function(t,e,n,r){t=+t,e>>>=0,r||T(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},h.prototype.writeIntBE=function(t,e,n,r){t=+t,e>>>=0,r||T(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,s=0;for(this[e+i]=255&t;0<=--i&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},h.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},h.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeFloatLE=function(t,e,n){return S(this,t,e,!0,n)},h.prototype.writeFloatBE=function(t,e,n){return S(this,t,e,!1,n)},h.prototype.writeDoubleLE=function(t,e,n){return C(this,t,e,!0,n)},h.prototype.writeDoubleBE=function(t,e,n){return C(this,t,e,!1,n)},h.prototype.copy=function(t,e,n,r){if(!h.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),e>=t.length&&(e=t.length),e=e||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var o=i-1;0<=o;--o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return i},h.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!h.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i;1===t.length&&(i=t.charCodeAt(0),("utf8"===r&&i<128||"latin1"===r)&&(t=i))}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(o=e;o<n;++o)this[o]=t;else{var s=h.isBuffer(t)?t:new h(t,r),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var I=/[^+/0-9A-Za-z-_]/g;function O(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if(55295<(n=t.charCodeAt(s))&&n<57344){if(!i){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(s+1===r){-1<(e-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,n<128){if(--e<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(t){return a.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(I,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function A(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function D(t){return t instanceof ArrayBuffer||null!=t&&null!=t.constructor&&"ArrayBuffer"===t.constructor.name&&"number"==typeof t.byteLength}function j(t){return t!=t}},{"base64-js":39,ieee754:84}],42:[function(t,e,n){(function(t){function e(t){return Object.prototype.toString.call(t)}n.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},n.isBoolean=function(t){return"boolean"==typeof t},n.isNull=function(t){return null===t},n.isNullOrUndefined=function(t){return null==t},n.isNumber=function(t){return"number"==typeof t},n.isString=function(t){return"string"==typeof t},n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=function(t){return void 0===t},n.isRegExp=function(t){return"[object RegExp]"===e(t)},n.isObject=function(t){return"object"==typeof t&&null!==t},n.isDate=function(t){return"[object Date]"===e(t)},n.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},n.isFunction=function(t){return"function"==typeof t},n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=t.isBuffer}).call(this,{isBuffer:t("../../is-buffer/index.js")})},{"../../is-buffer/index.js":86}],43:[function(t,e,n){(function(i){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var t=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100;!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.size=t,this.length=0,this.buf=i.alloc(t)}var t,n,r;return t=e,(n=[{key:"prepend",value:function(t){var e=this.length++;e===this.size&&this.resize();var n=this.clone();this.buf[0]=t,n.copy(this.buf,1,0,e)}},{key:"append",value:function(t){var e=this.length++;e===this.size&&this.resize(),this.buf[e]=t}},{key:"clone",value:function(){return i.from(this.buf.slice(0,this.length))}},{key:"resize",value:function(){var t=this.length;this.size=2*this.size;var e=i.alloc(this.size);this.buf.copy(e,0,0,t),this.buf=e}},{key:"toString",value:function(){return this.buf.slice(0,this.length).toString()}},{key:"toJSON",value:function(){return this.toString()}},{key:"reset",value:function(){this.length=0}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=t}).call(this,t("buffer").Buffer)},{buffer:41}],44:[function(T,x,t){(function(R,u){"use strict";function e(t){var r="function"==typeof Map?new Map:void 0;return(e=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,n)}function n(){return i(t,arguments,y(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)})(t)}function i(t,e,n){return(i=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&a(r,n.prototype),r}).apply(null,arguments)}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function n(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function h(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach(function(t){var e,n;e=r,t=i[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(i,t))})}return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function t(){var t,e,n,r;for(r in arguments){var i=arguments[r],o=c(i);if(void 0!==t||"string"!=typeof i&&!R.isBuffer(i))if(void 0===e&&v(i))e=i;else{if(void 0!==n||"function"!==o)throw new U("CSV_INVALID_ARGUMENT",["Invalid argument:","got ".concat(JSON.stringify(i)," at index ").concat(r)]);n=i}else t=i}var s,a=new g(e);return n&&(s=void 0===e||void 0===e.objname?[]:{},a.on("readable",function(){for(var t;null!==(t=this.read());)void 0===e||void 0===e.objname?s.push(t):s[t[0]]=t[1]}),a.on("error",function(t){n(t,void 0,a.info)}),a.on("end",function(){n(void 0,s,a.info)})),void 0!==t&&("function"==typeof u?u(function(){a.write(t),a.end()}):(a.write(t),a.end())),a}var m=T("stream").Transform,_=T("./ResizeableBuffer"),M=R.from([239,187,191]),g=function(){function a(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};f(this,a),t=p(this,y(a).call(this,h({},{readableObjectMode:!0},{},e)));var n,r={};for(n in e)r[b(n)]=e[n];if(void 0===r.bom||null===r.bom||!1===r.bom)r.bom=!1;else if(!0!==r.bom)throw new U("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,","got ".concat(JSON.stringify(r.bom))]);var i=null;if(void 0===r.cast||null===r.cast||!1===r.cast||""===r.cast)r.cast=void 0;else if("function"==typeof r.cast)i=r.cast,r.cast=!0;else if(!0!==r.cast)throw new U("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,","got ".concat(JSON.stringify(r.cast))]);if(void 0===r.cast_date||null===r.cast_date||!1===r.cast_date||""===r.cast_date)r.cast_date=!1;else if(!0===r.cast_date)r.cast_date=function(t){var e=Date.parse(t);return isNaN(e)?t:new Date(e)};else if("function"!=typeof r.cast_date)throw new U("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,","got ".concat(JSON.stringify(r.cast_date))]);var o=null;if(!0===r.columns)o=void 0;else if("function"==typeof r.columns)o=r.columns,r.columns=!0;else if(Array.isArray(r.columns))r.columns=E(r.columns);else{if(void 0!==r.columns&&null!==r.columns&&!1!==r.columns)throw new U("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an object, a function or true,","got ".concat(JSON.stringify(r.columns))]);r.columns=!1}if(void 0===r.columns_duplicates_to_array||null===r.columns_duplicates_to_array||!1===r.columns_duplicates_to_array)r.columns_duplicates_to_array=!1;else if(!0!==r.columns_duplicates_to_array)throw new U("CSV_INVALID_OPTION_COLUMNS_DUPLICATES_TO_ARRAY",["Invalid option columns_duplicates_to_array:","expect an boolean,","got ".concat(JSON.stringify(r.columns_duplicates_to_array))]);if(void 0===r.comment||null===r.comment||!1===r.comment||""===r.comment)r.comment=null;else if("string"==typeof r.comment&&(r.comment=R.from(r.comment)),!R.isBuffer(r.comment))throw new U("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,","got ".concat(JSON.stringify(r.comment))]);var s=JSON.stringify(r.delimiter);if(Array.isArray(r.delimiter)||(r.delimiter=[r.delimiter]),0===r.delimiter.length)throw new U("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,","got ".concat(s)]);if(r.delimiter=r.delimiter.map(function(t){if(null==t||!1===t)return R.from(",");if("string"==typeof t&&(t=R.from(t)),!R.isBuffer(t)||0===t.length)throw new U("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,","got ".concat(s)]);return t}),void 0===r.escape||null===r.escape?r.escape=R.from('"'):"string"==typeof r.escape&&(r.escape=R.from(r.escape)),!R.isBuffer(r.escape))throw new Error("Invalid Option: escape must be a buffer or a string, got ".concat(JSON.stringify(r.escape)));if(1!==r.escape.length)throw new Error("Invalid Option Length: escape must be one character, got ".concat(r.escape.length));if(r.escape=r.escape[0],void 0===r.from||null===r.from)r.from=1;else{if("string"==typeof r.from&&/\d+/.test(r.from)&&(r.from=parseInt(r.from)),!Number.isInteger(r.from))throw new Error("Invalid Option: from must be an integer, got ".concat(JSON.stringify(r.from)));if(r.from<0)throw new Error("Invalid Option: from must be a positive integer, got ".concat(JSON.stringify(e.from)))}if(void 0===r.from_line||null===r.from_line)r.from_line=1;else{if("string"==typeof r.from_line&&/\d+/.test(r.from_line)&&(r.from_line=parseInt(r.from_line)),!Number.isInteger(r.from_line))throw new Error("Invalid Option: from_line must be an integer, got ".concat(JSON.stringify(e.from_line)));if(r.from_line<=0)throw new Error("Invalid Option: from_line must be a positive integer greater than 0, got ".concat(JSON.stringify(e.from_line)))}if(void 0===r.info||null===r.info||!1===r.info)r.info=!1;else if(!0!==r.info)throw new Error("Invalid Option: info must be true, got ".concat(JSON.stringify(r.info)));if(void 0===r.max_record_size||null===r.max_record_size||!1===r.max_record_size)r.max_record_size=0;else if(!(Number.isInteger(r.max_record_size)&&0<=r.max_record_size)){if("string"!=typeof r.max_record_size||!/\d+/.test(r.max_record_size))throw new Error("Invalid Option: max_record_size must be a positive integer, got ".concat(JSON.stringify(r.max_record_size)));r.max_record_size=parseInt(r.max_record_size)}if(void 0===r.objname||null===r.objname||!1===r.objname)r.objname=void 0;else if(R.isBuffer(r.objname)){if(0===r.objname.length)throw new Error("Invalid Option: objname must be a non empty buffer");r.objname=r.objname.toString()}else{if("string"!=typeof r.objname)throw new Error("Invalid Option: objname must be a string or a buffer, got ".concat(r.objname));if(0===r.objname.length)throw new Error("Invalid Option: objname must be a non empty string")}if(void 0===r.on_record||null===r.on_record)r.on_record=void 0;else if("function"!=typeof r.on_record)throw new U("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,","got ".concat(JSON.stringify(r.on_record))]);if(null===r.quote||!1===r.quote||""===r.quote)r.quote=null;else{if(void 0===r.quote||!0===r.quote?r.quote=R.from('"'):"string"==typeof r.quote&&(r.quote=R.from(r.quote)),!R.isBuffer(r.quote))throw new Error("Invalid Option: quote must be a buffer or a string, got ".concat(JSON.stringify(r.quote)));if(1!==r.quote.length)throw new Error("Invalid Option Length: quote must be one character, got ".concat(r.quote.length));r.quote=r.quote[0]}if(void 0===r.raw||null===r.raw||!1===r.raw)r.raw=!1;else if(!0!==r.raw)throw new Error("Invalid Option: raw must be true, got ".concat(JSON.stringify(r.raw)));if(r.record_delimiter?Array.isArray(r.record_delimiter)||(r.record_delimiter=[r.record_delimiter]):r.record_delimiter=[],r.record_delimiter=r.record_delimiter.map(function(t){return"string"==typeof t&&(t=R.from(t)),t}),"boolean"!=typeof r.relax){if(void 0!==r.relax&&null!==r.relax)throw new Error("Invalid Option: relax must be a boolean, got ".concat(JSON.stringify(r.relax)));r.relax=!1}if("boolean"!=typeof r.relax_column_count){if(void 0!==r.relax_column_count&&null!==r.relax_column_count)throw new Error("Invalid Option: relax_column_count must be a boolean, got ".concat(JSON.stringify(r.relax_column_count)));r.relax_column_count=!1}if("boolean"!=typeof r.relax_column_count_less){if(void 0!==r.relax_column_count_less&&null!==r.relax_column_count_less)throw new Error("Invalid Option: relax_column_count_less must be a boolean, got ".concat(JSON.stringify(r.relax_column_count_less)));r.relax_column_count_less=!1}if("boolean"!=typeof r.relax_column_count_more){if(void 0!==r.relax_column_count_more&&null!==r.relax_column_count_more)throw new Error("Invalid Option: relax_column_count_more must be a boolean, got ".concat(JSON.stringify(r.relax_column_count_more)));r.relax_column_count_more=!1}if("boolean"!=typeof r.skip_empty_lines){if(void 0!==r.skip_empty_lines&&null!==r.skip_empty_lines)throw new Error("Invalid Option: skip_empty_lines must be a boolean, got ".concat(JSON.stringify(r.skip_empty_lines)));r.skip_empty_lines=!1}if("boolean"!=typeof r.skip_lines_with_empty_values){if(void 0!==r.skip_lines_with_empty_values&&null!==r.skip_lines_with_empty_values)throw new Error("Invalid Option: skip_lines_with_empty_values must be a boolean, got ".concat(JSON.stringify(r.skip_lines_with_empty_values)));r.skip_lines_with_empty_values=!1}if("boolean"!=typeof r.skip_lines_with_error){if(void 0!==r.skip_lines_with_error&&null!==r.skip_lines_with_error)throw new Error("Invalid Option: skip_lines_with_error must be a boolean, got ".concat(JSON.stringify(r.skip_lines_with_error)));r.skip_lines_with_error=!1}if(void 0===r.rtrim||null===r.rtrim||!1===r.rtrim)r.rtrim=!1;else if(!0!==r.rtrim)throw new Error("Invalid Option: rtrim must be a boolean, got ".concat(JSON.stringify(r.rtrim)));if(void 0===r.ltrim||null===r.ltrim||!1===r.ltrim)r.ltrim=!1;else if(!0!==r.ltrim)throw new Error("Invalid Option: ltrim must be a boolean, got ".concat(JSON.stringify(r.ltrim)));if(void 0===r.trim||null===r.trim||!1===r.trim)r.trim=!1;else if(!0!==r.trim)throw new Error("Invalid Option: trim must be a boolean, got ".concat(JSON.stringify(r.trim)));if(!0===r.trim&&!1!==e.ltrim?r.ltrim=!0:!0!==r.ltrim&&(r.ltrim=!1),!0===r.trim&&!1!==e.rtrim?r.rtrim=!0:!0!==r.rtrim&&(r.rtrim=!1),void 0===r.to||null===r.to)r.to=-1;else{if("string"==typeof r.to&&/\d+/.test(r.to)&&(r.to=parseInt(r.to)),!Number.isInteger(r.to))throw new Error("Invalid Option: to must be an integer, got ".concat(JSON.stringify(e.to)));if(r.to<=0)throw new Error("Invalid Option: to must be a positive integer greater than 0, got ".concat(JSON.stringify(e.to)))}if(void 0===r.to_line||null===r.to_line)r.to_line=-1;else{if("string"==typeof r.to_line&&/\d+/.test(r.to_line)&&(r.to_line=parseInt(r.to_line)),!Number.isInteger(r.to_line))throw new Error("Invalid Option: to_line must be an integer, got ".concat(JSON.stringify(e.to_line)));if(r.to_line<=0)throw new Error("Invalid Option: to_line must be a positive integer greater than 0, got ".concat(JSON.stringify(e.to_line)))}return t.info={comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},t.options=r,t.state={bomSkipped:!1,castField:i,commenting:!1,enabled:1===r.from_line,escaping:!1,escapeIsQuote:r.escape===r.quote,expectedRecordLength:null===r.columns?0:r.columns.length,field:new _(20),firstLineToHeaders:o,info:Object.assign({},t.info),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new _(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:0===r.record_delimiter.length?2:Math.max.apply(Math,l(r.record_delimiter.map(function(t){return t.length}))),trimChars:[R.from(" ")[0],R.from("\t")[0]],wasQuoting:!1,wasRowDelimiter:!1},t}var t,e,n;return s(a,m),t=a,(e=[{key:"_transform",value:function(t,e,n){!0!==this.state.stop&&(void 0!==(t=this.__parse(t,!1))&&(this.state.stop=!0),n(t))}},{key:"_flush",value:function(t){!0!==this.state.stop&&t(this.__parse(void 0,!0))}},{key:"__parse",value:function(t,e){var n,r=this.options,i=r.bom,o=r.comment,s=r.escape,a=r.from_line,u=r.info,c=r.ltrim,l=r.max_record_size,h=r.quote,f=r.raw,p=r.relax,d=r.rtrim,y=r.skip_empty_lines,m=r.to,_=r.to_line,g=this.options.record_delimiter,b=this.state,v=b.bomSkipped,r=b.previousBuf,w=b.rawBuffer,E=b.escapeIsQuote;if(void 0===r){if(void 0===t)return void this.push(null);n=t}else n=void 0!==r&&void 0===t?r:R.concat([r,t]);if(!1===v)if(!1===i)this.state.bomSkipped=!0;else if(n.length<3){if(!1===e)return void(this.state.previousBuf=n)}else 0===M.compare(n,0,3)&&(n=n.slice(3)),this.state.bomSkipped=!0;for(var T=n.length,x=0;x<T&&!this.__needMoreData(x,T,e);x++){if(!0===this.state.wasRowDelimiter&&(this.info.lines++,!0===u&&0===this.state.record.length&&0===this.state.field.length&&!1===this.state.wasQuoting&&(this.state.info=Object.assign({},this.info)),this.state.wasRowDelimiter=!1),-1!==_&&this.info.lines>_)return this.state.stop=!0,void this.push(null);!1===this.state.quoting&&0===g.length&&this.__autoDiscoverRowDelimiter(n,x)&&(g=this.options.record_delimiter);var S=n[x];if(!0===f&&w.append(S),13!==S&&10!==S||!1!==this.state.wasRowDelimiter||(this.state.wasRowDelimiter=!0),!0===this.state.escaping)this.state.escaping=!1;else{if(!0===this.state.quoting&&S===s&&x+1<T){if(!E){this.state.escaping=!0;continue}if(n[x+1]===h){this.state.escaping=!0;continue}}if(!1===this.state.commenting&&S===h)if(!0===this.state.quoting){var C=n[x+1],I=d&&this.__isCharTrimable(C),O=null!==o&&this.__compareBytes(o,n,x+1,C),N=this.__isDelimiter(C,n,x+1),A=0===g.length?this.__autoDiscoverRowDelimiter(n,x+1):this.__isRecordDelimiter(C,n,x+1);if(S===s&&C===h)x++;else{if(!C||N||A||O||I){this.state.quoting=!1,this.state.wasQuoting=!0;continue}if(!1===p){C=this.__error(new U("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",'got "'.concat(String.fromCharCode(C),'"'),"at line ".concat(this.info.lines),"instead of delimiter, row delimiter, trimable character","(if activated) or comment"],this.__context()));if(void 0!==C)return C}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(h)}}else{if(0===this.state.field.length){this.state.quoting=!0;continue}if(!1===p){var D=this.__error(new U("INVALID_OPENING_QUOTE",["Invalid Opening Quote:","a quote is found inside a field at line ".concat(this.info.lines)],this.__context(),{field:this.state.field}));if(void 0!==D)return D}}if(!1===this.state.quoting){D=this.__isRecordDelimiter(S,n,x);if(0!==D){if(this.state.commenting&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length)this.info.comment_lines++;else{if(!0===y&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length){this.info.empty_lines++,x+=D-1;continue}if(!1===this.state.enabled&&this.info.lines+(!0===this.state.wasRowDelimiter?1:0)>=a){this.state.enabled=!0,this.__resetField(),this.__resetRow(),x+=D-1;continue}var j=this.__onField();if(void 0!==j)return j;j=this.__onRow();if(void 0!==j)return j;if(-1!==m&&this.info.records>=m)return this.state.stop=!0,void this.push(null)}this.state.commenting=!1,x+=D-1;continue}if(this.state.commenting)continue;if(0!==(null===o?0:this.__compareBytes(o,n,x,S))){this.state.commenting=!0;continue}j=this.__isDelimiter(S,n,x);if(0!==j){D=this.__onField();if(void 0!==D)return D;x+=j-1;continue}}}if(!1===this.state.commenting&&0!==l&&this.state.record_length+this.state.field.length>l){var k=this.__error(new U("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes","of ".concat(l),"at line ".concat(this.info.lines)],this.__context()));if(void 0!==k)return k}j=!1===c||!0===this.state.quoting||0!==this.state.field.length||!this.__isCharTrimable(S),k=!1===d||!1===this.state.wasQuoting;if(!0==j&&!0==k)this.state.field.append(S);else if(!0===d&&!this.__isCharTrimable(S)){S=this.__error(new U("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote","at line ".concat(this.info.lines)],this.__context()));if(void 0!==S)return S}}if(!0===e)if(!0===this.state.quoting){var L=this.__error(new U("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:","the parsing is finished with an opening quote at line ".concat(this.info.lines)],this.__context()));if(void 0!==L)return L}else if(!0===this.state.wasQuoting||0!==this.state.record.length||0!==this.state.field.length){L=this.__onField();if(void 0!==L)return L;L=this.__onRow();if(void 0!==L)return L}else!0===this.state.wasRowDelimiter?this.info.empty_lines++:!0===this.state.commenting&&this.info.comment_lines++;else this.state.previousBuf=n.slice(x);!0===this.state.wasRowDelimiter&&(this.info.lines++,this.state.wasRowDelimiter=!1)}},{key:"__isCharTrimable",value:function(t){return 32===t||9===t||13===t||10===t||12===t}},{key:"__onRow",value:function(){var t=this.options,e=t.columns,n=t.columns_duplicates_to_array,r=t.info,i=t.from,o=t.relax_column_count,s=t.relax_column_count_less,a=t.relax_column_count_more,u=t.raw,c=t.skip_lines_with_empty_values,l=this.state,t=l.enabled,h=l.record;if(!1===t)return this.__resetRow();t=h.length;if(!0===e)return w(h)?void this.__resetRow():this.__firstLineToColumns(h);if(!1===e&&0===this.info.records&&(this.state.expectedRecordLength=t),t!==this.state.expectedRecordLength)if(!0===o||!0===s&&t<this.state.expectedRecordLength||!0===a&&t>this.state.expectedRecordLength)this.info.invalid_field_length++;else if(!1===e){a=this.__error(new U("CSV_INCONSISTENT_RECORD_LENGTH",["Invalid Record Length:","expect ".concat(this.state.expectedRecordLength,","),"got ".concat(t," on line ").concat(this.info.lines)],this.__context(),{record:h}));if(void 0!==a)return a}else{t=this.__error(new U("CSV_RECORD_DONT_MATCH_COLUMNS_LENGTH",["Invalid Record Length:","columns length is ".concat(e.length,","),"got ".concat(t," on line ").concat(this.info.lines)],this.__context(),{record:h}));if(void 0!==t)return t}if(!0===c&&w(h))this.__resetRow();else{if(!0===this.state.recordHasError)return this.__resetRow(),void(this.state.recordHasError=!1);if(this.info.records++,1===i||this.info.records>=i)if(!1!==e){for(var f={},p=0,d=h.length;p<d;p++)void 0===e[p]||e[p].disabled||(!0===n&&f[e[p].name]?Array.isArray(f[e[p].name])?f[e[p].name]=f[e[p].name].concat(h[p]):f[e[p].name]=[f[e[p].name],h[p]]:f[e[p].name]=h[p]);c=this.options.objname;if(void 0===c)if(!0===u||!0===r){i=this.__push(Object.assign({record:f},!0===u?{raw:this.state.rawBuffer.toString()}:{},!0===r?{info:this.state.info}:{}));if(i)return i}else{var y=this.__push(f);if(y)return y}else if(!0===u||!0===r){y=this.__push(Object.assign({record:[f[c],f]},!0===u?{raw:this.state.rawBuffer.toString()}:{},!0===r?{info:this.state.info}:{}));if(y)return y}else{c=this.__push([f[c],f]);if(c)return c}}else if(!0===u||!0===r){var m=this.__push(Object.assign({record:h},!0===u?{raw:this.state.rawBuffer.toString()}:{},!0===r?{info:this.state.info}:{}));if(m)return m}else{m=this.__push(h);if(m)return m}this.__resetRow()}}},{key:"__firstLineToColumns",value:function(t){var e=this.state.firstLineToHeaders;try{var n=void 0===e?t:e.call(null,t);if(!Array.isArray(n))return this.__error(new U("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,","got ".concat(JSON.stringify(n))],this.__context(),{headers:n}));n=E(n);return this.state.expectedRecordLength=n.length,this.options.columns=n,void this.__resetRow()}catch(t){return t}}},{key:"__resetRow",value:function(){!0===this.options.raw&&this.state.rawBuffer.reset(),this.state.record=[],this.state.record_length=0}},{key:"__onField",value:function(){var t=this.options,e=t.cast,n=t.rtrim,r=t.max_record_size,i=this.state,t=i.enabled,i=i.wasQuoting;if(!1===t)return this.__resetField();t=this.state.field.toString();if(!0===n&&!1===i&&(t=t.trimRight()),!0===e){i=o(this.__cast(t),2),e=i[0],i=i[1];if(void 0!==e)return e;t=i}this.state.record.push(t),0!==r&&"string"==typeof t&&(this.state.record_length+=t.length),this.__resetField()}},{key:"__resetField",value:function(){this.state.field.reset(),this.state.wasQuoting=!1}},{key:"__push",value:function(t){var e=this.options.on_record;if(void 0!==e){var n=this.__context();try{t=e.call(null,t,n)}catch(t){return t}if(null==t)return}this.push(t)}},{key:"__cast",value:function(t){var e=this.options,n=e.columns,e=e.relax_column_count;if(!0===Array.isArray(n)&&e&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];var r=this.__context();if(null!==this.state.castField)try{return[void 0,this.state.castField.call(null,t,r)]}catch(t){return[t]}return this.__isFloat(t)?[void 0,parseFloat(t)]:!1!==this.options.cast_date?[void 0,this.options.cast_date.call(null,t,r)]:[void 0,t]}},{key:"__isFloat",value:function(t){return 0<=t-parseFloat(t)+1}},{key:"__compareBytes",value:function(t,e,n,r){if(t[0]!==r)return 0;for(var i=t.length,o=1;o<i;o++)if(t[o]!==e[n+o])return 0;return i}},{key:"__needMoreData",value:function(t,e,n){if(n)return!1;var r=this.options,i=r.comment,o=r.delimiter,n=this.state,r=n.quoting,n=n.recordDelimiterMaxLength;return e-t-1<Math.max(i?i.length:0,n,r?1+n:0,o.length,1)}},{key:"__isDelimiter",value:function(t,e,n){var r=this.options.delimiter;t:for(var i=0;i<r.length;i++){var o=r[i];if(o[0]===t){for(var s=1;s<o.length;s++)if(o[s]!==e[n+s])continue t;return o.length}}return 0}},{key:"__isRecordDelimiter",value:function(t,e,n){var r=this.options.record_delimiter,i=r.length;t:for(var o=0;o<i;o++){var s=r[o],a=s.length;if(s[0]===t){for(var u=1;u<a;u++)if(s[u]!==e[n+u])continue t;return s.length}}return 0}},{key:"__autoDiscoverRowDelimiter",value:function(t,e){var n=t[e];return 13===n?10===t[e+1]?(this.options.record_delimiter.push(R.from("\r\n")),this.state.recordDelimiterMaxLength=2):(this.options.record_delimiter.push(R.from("\r")),this.state.recordDelimiterMaxLength=1):10===n?(this.options.record_delimiter.push(R.from("\n")),this.state.recordDelimiterMaxLength=1):0}},{key:"__error",value:function(t){var e=this.options.skip_lines_with_error,t="string"==typeof t?new Error(t):t;if(!e)return t;this.state.recordHasError=!0,this.emit("skip",t)}},{key:"__context",value:function(){var t=this.options.columns;return{column:!0===Array.isArray(t)?t.length>this.state.record.length?t[this.state.record.length].name:null:this.state.record.length,empty_lines:this.info.empty_lines,header:!0===t,index:this.state.record.length,invalid_field_length:this.info.invalid_field_length,quoting:this.state.wasQuoting,lines:this.info.lines,records:this.info.records}}}])&&r(t.prototype,e),n&&r(t,n),a}(),U=function(){function h(t,e){var n;f(this,h),Array.isArray(e)&&(e=e.join(" ")),n=p(this,y(h).call(this,e)),void 0!==Error.captureStackTrace&&Error.captureStackTrace(d(n),h),n.code=t;for(var r=arguments.length,i=new Array(2<r?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];for(var s=0,a=i;s<a.length;s++){var u,c=a[s];for(u in c){var l=c[u];n[u]=R.isBuffer(l)?l.toString():null==l?l:JSON.parse(JSON.stringify(l))}}return n}return s(h,e(Error)),h}();t.Parser=g,t.CsvError=U,x.exports=t;var b=function(t){return t.replace(/([A-Z])/g,function(t,e){return"_"+e.toLowerCase()})},v=function(t){return"object"===c(t)&&null!==t&&!Array.isArray(t)},w=function(t){return t.every(function(t){return null==t||t.toString&&""===t.toString().trim()})},E=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(null==i||!1===i)e[n]={disabled:!0};else if("string"==typeof i)e[n]={name:i};else{if(!v(i))throw new U("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,","got ".concat(JSON.stringify(i)," at position ").concat(n)]);if("string"!=typeof i.name)throw new U("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",'property "name" is required at position '.concat(n),"when column is an object literal"]);e[n]=i}}return e}}).call(this,T("buffer").Buffer,T("timers").setImmediate)},{"./ResizeableBuffer":43,buffer:41,stream:113,timers:115}],45:[function(t,e,n){(function(i){"use strict";var o=t(".");e.exports=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof t&&(t=i.from(t));var n=e&&e.objname?{}:[],r=new o.Parser(e);r.push=function(t){null!==t&&(void 0===e.objname?n.push(t):n[t[0]]=t[1])};t=r.__parse(t,!1);if(void 0!==t)throw t;r=r.__parse(void 0,!0);if(void 0!==r)throw r;return n}}).call(this,t("buffer").Buffer)},{".":44,buffer:41}],46:[function(e,n,t){(function(o){var s,a=e("stream"),t=e("util"),v=e("lodash.get");n.exports=function(){var e,n,r,t,i;return 3===arguments.length?(r=arguments[0],t=arguments[1],e=arguments[2]):2===arguments.length?(Array.isArray(arguments[0])?r=arguments[0]:t=arguments[0],"function"==typeof arguments[1]?e=arguments[1]:t=arguments[1]):1===arguments.length&&("function"==typeof arguments[0]?e=arguments[0]:Array.isArray(arguments[0])?r=arguments[0]:t=arguments[0]),null==t&&(t={}),i=new s(t),r&&o.nextTick(function(){for(var t,e=0,n=r.length;e<n;e++)t=r[e],i.write(t);return i.end()}),e&&(n=[],i.on("readable",function(){for(var t,e=[];t=i.read();)e.push(n.push(t));return e}),i.on("error",function(t){return e(t)}),i.on("end",function(){return e(null,n.join(""))})),i},s=function(t){var e,n,r,i;for(n in null==t&&(t={}),r={},t)i=t[n],r[n]=i;switch(a.Transform.call(this,r),this.options=r,null==(e=this.options).delimiter&&(e.delimiter=","),null==(e=this.options).quote&&(e.quote='"'),null==(e=this.options).quoted&&(e.quoted=!1),null==(e=this.options).quotedEmpty&&(e.quotedEmpty=void 0),null==(e=this.options).quotedString&&(e.quotedString=!1),null==(e=this.options).eof&&(e.eof=!0),null==(e=this.options).escape&&(e.escape='"'),null==(e=this.options).columns&&(e.columns=null),null==(e=this.options).header&&(e.header=!1),null==(e=this.options).formatters&&(e.formatters={}),null==(e=this.options.formatters).date&&(e.date=function(t){return""+t.getTime()}),null==(e=this.options.formatters).bool&&(e.bool=function(t){return t?"1":""}),null==(e=this.options.formatters).object&&(e.object=function(t){return JSON.stringify(t)}),null==(e=this.options).rowDelimiter&&(e.rowDelimiter="\n"),null==this.countWriten&&(this.countWriten=0),this.options.rowDelimiter){case"auto":this.options.rowDelimiter=null;break;case"unix":this.options.rowDelimiter="\n";break;case"mac":this.options.rowDelimiter="\r";break;case"windows":this.options.rowDelimiter="\r\n";break;case"unicode":this.options.rowDelimiter="\u2028"}return this},t.inherits(s,a.Transform),(n.exports.Stringifier=s).prototype.headers=function(){var e,n,r;if(this.options.header&&this.options.columns)return"object"==typeof(r=this.options.columns)&&(r=function(){var t=[];for(e in r)n=r[e],t.push(n);return t}()),r=this.options.eof?this.stringify(r)+this.options.rowDelimiter:this.stringify(r),a.Transform.prototype.write.call(this,r)},s.prototype.end=function(t,e,n){return 0===this.countWriten&&this.headers(),a.Transform.prototype.end.apply(this,arguments)},s.prototype.write=function(t,e,n){var r,i;if(null!=t){if(!(i="object"!=typeof t)){0!==this.countWriten||Array.isArray(t)||null==(r=this.options).columns&&(r.columns=Object.keys(t));try{this.emit("record",t,this.countWriten)}catch(t){return this.emit("error",t)}this.options.eof?t=this.stringify(t)+this.options.rowDelimiter:(t=this.stringify(t),(this.options.header||this.countWriten)&&(t=this.options.rowDelimiter+t))}return"number"==typeof t&&(t=""+t),0===this.countWriten&&this.headers(),i||this.countWriten++,a.Transform.prototype.write.call(this,t,e,n)}},s.prototype._transform=function(t,e,n){return this.push(t),n()},s.prototype.stringify=function(t){var e,n,r,i,o,s,a,u,c,l,h,f,p,d,y,m,_,g,b;if("object"!=typeof t)return t;if("object"!=typeof(r=this.options.columns)||null===r||Array.isArray(r)||(r=Object.keys(r)),a=this.options.delimiter,d=this.options.quote,u=this.options.escape,Array.isArray(t))r&&t.splice(r.length);else{if(e=[],r)for(l=h=0,y=r.length;0<=y?h<y:y<h;l=0<=y?++h:--h)n=r[l],b=v(t,n),e[l]=null==b?"":b;else for(n in t)e.push(t[n]);t=e,e=null}if(Array.isArray(t)){for(p="",l=f=0,m=t.length;0<=m?f<m:m<f;l=0<=m?++f:--f)"string"==typeof(c=t[l])||("number"==typeof c?c=""+c:"boolean"==typeof c?c=this.options.formatters.bool(c):c instanceof Date?c=this.options.formatters.date(c):"object"==typeof c&&null!==c&&(c=this.options.formatters.object(c))),c?(s=0<=c.indexOf(a),o=0<=c.indexOf(d),i=0<=c.indexOf(u)&&u!==d,g=0<=c.indexOf("\r")||0<=c.indexOf("\n"),(g=o||s||g||this.options.quoted||this.options.quotedString&&"string"==typeof t[l])&&i&&(_="\\"===u?new RegExp(u+u,"g"):new RegExp(u,"g"),c=c.replace(_,u+u)),o&&(_=new RegExp(d,"g"),c=c.replace(_,u+d)),g&&(c=d+c+d),p+=c):(this.options.quotedEmpty||null==this.options.quotedEmpty&&""===t[l]&&this.options.quotedString)&&(p+=d+d),l!==t.length-1&&(p+=a);t=p}return t}}).call(this,e("_process"))},{_process:92,"lodash.get":88,stream:113,util:118}],47:[function(t,e,n){(function(a){var u=t("string_decoder").StringDecoder,c=t("./index");e.exports=function(t,e){var n,r,i,o,s;for(null==e&&(e={}),n=[],t instanceof a&&(t=(new u).write(t)),(s=new c.Stringifier(e)).push=function(t){if(t)return n.push(t.toString())},r=0,i=t.length;r<i;r++)o=t[r],s.write(o);return s.end(),n.join("")}}).call(this,t("buffer").Buffer)},{"./index":46,buffer:41,string_decoder:114}],48:[function(t,e,n){var a=Object.create||function(t){function e(){}return e.prototype=t,new e},s=Object.keys||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return e},r=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function i(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=a(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((e.exports=i).EventEmitter=i).prototype._events=void 0,i.prototype._maxListeners=void 0;var o,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(t){o=!1}function l(t){return void 0===t._maxListeners?i.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var i,o;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return(i=t._events)?(i.newListener&&(t.emit("newListener",e,n.listener||n),i=t._events),o=i[e]):(i=t._events=a(null),t._eventsCount=0),o?("function"==typeof o?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),o.warned||(r=l(t))&&0<r&&o.length>r&&(o.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.')).name="MaxListenersExceededWarning",r.emitter=t,r.type=e,r.count=o.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",r.name,r.message))):(o=i[e]=n,++t._eventsCount),t}function f(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function p(t,e,n){t={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},e=r.call(f,t);return e.listener=n,t.wrapFn=e}function d(t,e,n){t=t._events;if(!t)return[];e=t[e];return e?"function"==typeof e?n?[e.listener||e]:[e]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):m(e,e.length):[]}function y(t){var e=this._events;if(e){t=e[t];if("function"==typeof t)return 1;if(t)return t.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}o?Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');u=t}}):i.defaultMaxListeners=u,i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(t,e,n,r){var i,o,s,a,u="error"===t,c=this._events;if(c)u=u&&null==c.error;else if(!u)return!1;if(u){if(1<arguments.length&&(i=e),i instanceof Error)throw i;u=new Error('Unhandled "error" event. ('+i+")");throw u.context=i,u}if(!(o=c[t]))return!1;var l,h="function"==typeof o;switch(l=arguments.length){case 1:!function(t,e){if(h)t.call(e);else for(var n=t.length,r=m(t,n),i=0;i<n;++i)r[i].call(e)}(o,this);break;case 2:!function(t,e,n){if(h)t.call(e,n);else for(var r=t.length,i=m(t,r),o=0;o<r;++o)i[o].call(e,n)}(o,this,e);break;case 3:!function(t,e,n,r){if(h)t.call(e,n,r);else for(var i=t.length,o=m(t,i),s=0;s<i;++s)o[s].call(e,n,r)}(o,this,e,n);break;case 4:!function(t,e,n,r,i){if(h)t.call(e,n,r,i);else for(var o=t.length,s=m(t,o),a=0;a<o;++a)s[a].call(e,n,r,i)}(o,this,e,n,r);break;default:for(s=new Array(l-1),a=1;a<l;a++)s[a-1]=arguments[a];!function(t,e,n){if(h)t.apply(e,n);else for(var r=t.length,i=m(t,r),o=0;o<r;++o)i[o].apply(e,n)}(o,this,s)}return!0},i.prototype.on=i.prototype.addListener=function(t,e){return h(this,t,e,!1)},i.prototype.prependListener=function(t,e){return h(this,t,e,!0)},i.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,p(this,t,e)),this},i.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,p(this,t,e)),this},i.prototype.removeListener=function(t,e){var n,r,i,o,s;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=a(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;0<=o;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t){for(var e=i,n=e+1,r=t.length;n<r;e+=1,n+=1)t[e]=t[n];t.pop()}(n),1===n.length&&(r[t]=n[0]),r.removeListener&&this.emit("removeListener",t,s||e)}return this},i.prototype.removeAllListeners=function(t){var e,n=this._events;if(!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=a(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=a(null):delete n[t]),this;if(0===arguments.length){for(var r,i=s(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=a(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(o=e.length-1;0<=o;o--)this.removeListener(t,e[o]);return this},i.prototype.listeners=function(t){return d(this,t,!0)},i.prototype.rawListeners=function(t){return d(this,t,!1)},i.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},i.prototype.listenerCount=y,i.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],49:[function(t,e,n){"use strict";var r=t("./util/constants"),i=t("./mixins/logging"),t={VERSION:r.VERSION,Client:t("./protocol/client"),Scheduler:t("./protocol/scheduler")};i.wrapper=t,e.exports=t},{"./mixins/logging":51,"./protocol/client":55,"./protocol/scheduler":61,"./util/constants":73}],50:[function(t,e,n){(function(r){"use strict";var i=t("../util/promise");e.exports={then:function(t,e){var n=this;return this._promise||(this._promise=new i(function(t,e){n._resolve=t,n._reject=e})),0===arguments.length?this._promise:this._promise.then(t,e)},callback:function(e,n){return this.then(function(t){e.call(n,t)})},errback:function(e,n){return this.then(null,function(t){e.call(n,t)})},timeout:function(t,e){this.then();var n=this;this._timer=r.setTimeout(function(){n._reject(e)},1e3*t)},setDeferredStatus:function(t,e){this._timer&&r.clearTimeout(this._timer),this.then(),"succeeded"===t?this._resolve(e):"failed"===t?this._reject(e):delete this._promise}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/promise":78}],51:[function(t,e,n){"use strict";var r,s=t("../util/to_json"),a={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(t,e){var n,r,i,o=a.logger||(a.wrapper||a).logger;o&&(n=Array.prototype.slice.apply(t),r="[Faye",i=this.className,t=n.shift().replace(/\?/g,function(){try{return s(n.shift())}catch(t){return"[Object]"}}),i&&(r+="."+i),r+="] ","function"==typeof o[e]?o[e](r+t):"function"==typeof o&&o(r+t))}};for(r in a.LOG_LEVELS)!function(t){a[t]=function(){this.writeLog(arguments,t)}}(r);e.exports=a},{"../util/to_json":80}],52:[function(t,e,n){"use strict";var r={countListeners:function(t){return this.listeners(t).length},bind:function(t,e,n){function r(){e.apply(n,i.call(arguments))}var i=Array.prototype.slice;return this._listeners=this._listeners||[],this._listeners.push([t,e,n,r]),this.on(t,r)},unbind:function(t,e,n){this._listeners=this._listeners||[];for(var r,i=this._listeners.length;i--;)(r=this._listeners[i])[0]===t&&(e&&(r[1]!==e||r[2]!==n)||(this._listeners.splice(i,1),this.removeListener(t,r[3])))}};t("../util/extend")(r,t("../util/event_emitter").prototype),r.trigger=r.emit,e.exports=r},{"../util/event_emitter":76,"../util/extend":77}],53:[function(t,e,n){(function(o){"use strict";e.exports={addTimeout:function(t,e,n,r){var i;this._timeouts=this._timeouts||{},this._timeouts.hasOwnProperty(t)||((i=this)._timeouts[t]=o.setTimeout(function(){delete i._timeouts[t],n.call(r)},1e3*e))},removeTimeout:function(t){this._timeouts=this._timeouts||{};var e=this._timeouts[t];e&&(o.clearTimeout(e),delete this._timeouts[t])},removeAllTimeouts:function(){for(var t in this._timeouts=this._timeouts||{},this._timeouts)this.removeTimeout(t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],54:[function(t,e,n){"use strict";var r=t("../util/class"),i=t("../util/extend"),o=t("../mixins/publisher"),s=t("./grammar"),a=r({initialize:function(t){this.id=this.name=t},push:function(t){this.trigger("message",t)},isUnused:function(){return 0===this.countListeners("message")}});i(a.prototype,o),i(a,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(t){var e=this.parse(t),n=["/**",t],r=e.slice();r[r.length-1]="*",n.push(this.unparse(r));for(var i=1,o=e.length;i<o;i++)(r=e.slice(0,i)).push("**"),n.push(this.unparse(r));return n},isValid:function(t){return s.CHANNEL_NAME.test(t)||s.CHANNEL_PATTERN.test(t)},parse:function(t){return this.isValid(t)?t.split("/").slice(1):null},unparse:function(t){return"/"+t.join("/")},isMeta:function(t){t=this.parse(t);return t?t[0]===this.META:null},isService:function(t){t=this.parse(t);return t?t[0]===this.SERVICE:null},isSubscribable:function(t){return this.isValid(t)?!this.isMeta(t)&&!this.isService(t):null},Set:r({initialize:function(){this._channels={}},getKeys:function(){var t,e=[];for(t in this._channels)e.push(t);return e},remove:function(t){delete this._channels[t]},hasSubscription:function(t){return this._channels.hasOwnProperty(t)},subscribe:function(t,e){for(var n=0,r=t.length;n<r;n++){var i=t[n];(this._channels[i]=this._channels[i]||new a(i)).bind("message",e)}},unsubscribe:function(t,e){var n=this._channels[t];return!!n&&(n.unbind("message",e),!!n.isUnused()&&(this.remove(t),!0))},distributeMessage:function(t){for(var e=a.expand(t.channel),n=0,r=e.length;n<r;n++){var i=this._channels[e[n]];i&&i.trigger("message",t)}}})}),e.exports=a},{"../mixins/publisher":52,"../util/class":72,"../util/extend":77,"./grammar":59}],55:[function(g,b,t){(function(i){"use strict";var o=g("asap"),t=g("../util/class"),s=(g("../util/promise"),g("../util/uri")),a=g("../util/array"),n=g("../util/browser"),u=g("../util/constants"),e=g("../util/extend"),c=g("../util/validate_options"),r=g("../mixins/deferrable"),l=g("../mixins/logging"),h=g("../mixins/publisher"),f=g("./channel"),p=g("./dispatcher"),d=g("./error"),y=g("./extensible"),m=g("./publication"),_=g("./subscription"),t=t({className:"Client",UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(t,e){this.info("New client created for ?",t),c(e=e||{},["interval","timeout","endpoints","proxy","retry","scheduler","websocketExtensions","tls","ca"]),this._channels=new f.Set,this._dispatcher=p.create(this,t||this.DEFAULT_ENDPOINT,e),this._messageId=0,this._state=this.UNCONNECTED,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(e.interval||this.INTERVAL),timeout:1e3*(e.timeout||this.CONNECTION_TIMEOUT)},this._dispatcher.timeout=this._advice.timeout/1e3,this._dispatcher.bind("message",this._receiveMessage,this),n.Event&&void 0!==i.onbeforeunload&&n.Event.on(i,"beforeunload",function(){a.indexOf(this._dispatcher._disabled,"autodisconnect")<0&&this.disconnect()},this)},addWebsocketExtension:function(t){return this._dispatcher.addWebsocketExtension(t)},disable:function(t){return this._dispatcher.disable(t)},setHeader:function(t,e){return this._dispatcher.setHeader(t,e)},handshake:function(e,n){var r;this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED&&(this._state=this.CONNECTING,(r=this).info("Initiating handshake with ?",s.stringify(this._dispatcher.endpoint)),this._dispatcher.selectTransport(u.MANDATORY_CONNECTION_TYPES),this._sendMessage({channel:f.HANDSHAKE,version:u.BAYEUX_VERSION,supportedConnectionTypes:this._dispatcher.getConnectionTypes()},{},function(t){t.successful?(this._state=this.CONNECTED,this._dispatcher.clientId=t.clientId,this._dispatcher.selectTransport(t.supportedConnectionTypes),this.info("Handshake successful: ?",this._dispatcher.clientId),this.subscribe(this._channels.getKeys(),!0),e&&o(function(){e.call(n)})):(this.info("Handshake unsuccessful"),i.setTimeout(function(){r.handshake(e,n)},1e3*this._dispatcher.retry),this._state=this.UNCONNECTED)},this))},connect:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake(function(){this.connect(t,e)},this);this.callback(t,e),this._state===this.CONNECTED&&(this.info("Calling deferred actions for ?",this._dispatcher.clientId),this.setDeferredStatus("succeeded"),this.setDeferredStatus("unknown"),this._connectRequest||(this._connectRequest=!0,this.info("Initiating connection for ?",this._dispatcher.clientId),this._sendMessage({channel:f.CONNECT,clientId:this._dispatcher.clientId,connectionType:this._dispatcher.connectionType},{},this._cycleConnection,this)))}},disconnect:function(){if(this._state===this.CONNECTED){this._state=this.DISCONNECTED,this.info("Disconnecting ?",this._dispatcher.clientId);var e=new m;return this._sendMessage({channel:f.DISCONNECT,clientId:this._dispatcher.clientId},{},function(t){t.successful?(this._dispatcher.close(),e.setDeferredStatus("succeeded")):e.setDeferredStatus("failed",d.parse(t.error))},this),this.info("Clearing channel listeners for ?",this._dispatcher.clientId),this._channels=new f.Set,e}},subscribe:function(e,n,r){if(e instanceof Array)return a.map(e,function(t){return this.subscribe(t,n,r)},this);var i=new _(this,e,n,r),t=!0===n;return this._channels.hasSubscription(e)&&!t?(this._channels.subscribe([e],i),i.setDeferredStatus("succeeded")):this.connect(function(){this.info("Client ? attempting to subscribe to ?",this._dispatcher.clientId,e),t||this._channels.subscribe([e],i),this._sendMessage({channel:f.SUBSCRIBE,clientId:this._dispatcher.clientId,subscription:e},{},function(t){if(!t.successful)return i.setDeferredStatus("failed",d.parse(t.error)),this._channels.unsubscribe(e,i);t=[].concat(t.subscription);this.info("Subscription acknowledged for ? to ?",this._dispatcher.clientId,t),i.setDeferredStatus("succeeded")},this)},this),i},unsubscribe:function(t,e){if(t instanceof Array)return a.map(t,function(t){return this.unsubscribe(t,e)},this);this._channels.unsubscribe(t,e)&&this.connect(function(){this.info("Client ? attempting to unsubscribe from ?",this._dispatcher.clientId,t),this._sendMessage({channel:f.UNSUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},function(t){t.successful&&(t=[].concat(t.subscription),this.info("Unsubscription acknowledged for ? from ?",this._dispatcher.clientId,t))},this)},this)},publish:function(t,e,n){c(n||{},["attempts","deadline"]);var r=new m;return this.connect(function(){this.info("Client ? queueing published message to ?: ?",this._dispatcher.clientId,t,e),this._sendMessage({channel:t,data:e,clientId:this._dispatcher.clientId},n,function(t){t.successful?r.setDeferredStatus("succeeded"):r.setDeferredStatus("failed",d.parse(t.error))},this)},this),r},_sendMessage:function(t,e,n,r){t.id=this._generateMessageId();var i=this._advice.timeout?1.2*this._advice.timeout/1e3:1.2*this._dispatcher.retry;this.pipeThroughExtensions("outgoing",t,null,function(t){t&&(n&&(this._responseCallbacks[t.id]=[n,r]),this._dispatcher.sendMessage(t,i,e||{}))},this)},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_receiveMessage:function(t){var e,n=t.id;void 0!==t.successful&&(e=this._responseCallbacks[n],delete this._responseCallbacks[n]),this.pipeThroughExtensions("incoming",t,null,function(t){t&&(t.advice&&this._handleAdvice(t.advice),this._deliverMessage(t),e&&e[0].call(e[1],t))},this)},_handleAdvice:function(t){e(this._advice,t),this._dispatcher.timeout=this._advice.timeout/1e3,this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._dispatcher.clientId=null,this._cycleConnection())},_deliverMessage:function(t){t.channel&&void 0!==t.data&&(this.info("Client ? calling listeners for ? with ?",this._dispatcher.clientId,t.channel,t.data),this._channels.distributeMessage(t))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info("Closed connection for ?",this._dispatcher.clientId));var t=this;i.setTimeout(function(){t.connect()},this._advice.interval)}});e(t.prototype,r),e(t.prototype,h),e(t.prototype,l),e(t.prototype,y),b.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/deferrable":50,"../mixins/logging":51,"../mixins/publisher":52,"../util/array":70,"../util/browser":71,"../util/class":72,"../util/constants":73,"../util/extend":77,"../util/promise":78,"../util/uri":81,"../util/validate_options":82,"./channel":54,"./dispatcher":56,"./error":57,"./extensible":58,"./publication":60,"./subscription":62,asap:37}],56:[function(l,h,t){(function(i){"use strict";var t=l("../util/class"),a=l("../util/uri"),u=l("../util/cookies"),e=l("../util/extend"),n=l("../mixins/logging"),r=l("../mixins/publisher"),o=l("../transport"),c=l("./scheduler"),s=t({className:"Dispatcher",MAX_REQUEST_SIZE:2048,DEFAULT_RETRY:5,UP:1,DOWN:2,initialize:function(t,e,n){this._client=t,this.endpoint=a.parse(e),this._alternates=n.endpoints||{},this.cookies=u.CookieJar&&new u.CookieJar,this._disabled=[],this._envelopes={},this.headers={},this.retry=n.retry||this.DEFAULT_RETRY,this._scheduler=n.scheduler||c,this._state=0,this.transports={},this.wsExtensions=[],this.proxy=n.proxy||{},"string"==typeof this._proxy&&(this._proxy={origin:this._proxy});var r,i=n.websocketExtensions;if(i)for(var o=0,s=(i=[].concat(i)).length;o<s;o++)this.addWebsocketExtension(i[o]);for(r in this.tls=n.tls||{},this.tls.ca=this.tls.ca||n.ca,this._alternates)this._alternates[r]=a.parse(this._alternates[r]);this.maxRequestSize=this.MAX_REQUEST_SIZE},endpointFor:function(t){return this._alternates[t]||this.endpoint},addWebsocketExtension:function(t){this.wsExtensions.push(t)},disable:function(t){this._disabled.push(t)},setHeader:function(t,e){this.headers[t]=e},close:function(){var t=this._transport;delete this._transport,t&&t.close()},getConnectionTypes:function(){return o.getConnectionTypes()},selectTransport:function(t){o.get(this,t,this._disabled,function(t){this.debug("Selected ? transport for ?",t.connectionType,a.stringify(t.endpoint)),t!==this._transport&&(this._transport&&this._transport.close(),this._transport=t,this.connectionType=t.connectionType)},this)},sendMessage:function(t,e,n){n=n||{};var r=t.id,i=n.attempts,o=n.deadline&&(new Date).getTime()+1e3*n.deadline,n=this._envelopes[r];n||(o=new this._scheduler(t,{timeout:e,interval:this.retry,attempts:i,deadline:o}),n=this._envelopes[r]={message:t,scheduler:o}),this._sendEnvelope(n)},_sendEnvelope:function(t){if(this._transport&&!t.request&&!t.timer){var e=t.message,n=t.scheduler,r=this;if(!n.isDeliverable())return n.abort(),void delete this._envelopes[e.id];t.timer=i.setTimeout(function(){r.handleError(e)},1e3*n.getTimeout()),n.send(),t.request=this._transport.sendMessage(e)}},handleResponse:function(t){var e=this._envelopes[t.id];void 0!==t.successful&&e&&(e.scheduler.succeed(),delete this._envelopes[t.id],i.clearTimeout(e.timer)),this.trigger("message",t),this._state!==this.UP&&(this._state=this.UP,this._client.trigger("transport:up"))},handleError:function(t,e){var n=this._envelopes[t.id],t=n&&n.request,r=this;t&&(t.then(function(t){t&&t.abort&&t.abort()}),(t=n.scheduler).fail(),i.clearTimeout(n.timer),n.request=n.timer=null,e?this._sendEnvelope(n):n.timer=i.setTimeout(function(){n.timer=null,r._sendEnvelope(n)},1e3*t.getInterval()),this._state!==this.DOWN&&(this._state=this.DOWN,this._client.trigger("transport:down")))}});s.create=function(t,e,n){return new s(t,e,n)},e(s.prototype,r),e(s.prototype,n),h.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/logging":51,"../mixins/publisher":52,"../transport":63,"../util/class":72,"../util/cookies":74,"../util/extend":77,"../util/uri":81,"./scheduler":61}],57:[function(t,e,n){"use strict";var r=t("../util/class"),i=t("./grammar"),o=r({initialize:function(t,e,n){this.code=t,this.params=Array.prototype.slice.call(e),this.message=n},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message}});o.parse=function(t){if(t=t||"",!i.ERROR.test(t))return new o(null,[],t);var e=t.split(":"),n=parseInt(e[0]),r=e[1].split(","),t=e[2];return new o(n,r,t)};var s,a={versionMismatch:[300,"Version mismatch"],conntypeMismatch:[301,"Connection types not supported"],extMismatch:[302,"Extension mismatch"],badRequest:[400,"Bad request"],clientUnknown:[401,"Unknown client"],parameterMissing:[402,"Missing required parameter"],channelForbidden:[403,"Forbidden channel"],channelUnknown:[404,"Unknown channel"],channelInvalid:[405,"Invalid channel"],extUnknown:[406,"Unknown extension"],publishFailed:[407,"Failed to publish"],serverError:[500,"Internal server error"]};for(s in a)!function(t){o[t]=function(){return new o(a[t][0],arguments,a[t][1]).toString()}}(s);e.exports=o},{"../util/class":72,"./grammar":59}],58:[function(t,e,n){"use strict";var r={addExtension:function(t){this._extensions=this._extensions||[],this._extensions.push(t),t.added&&t.added(this)},removeExtension:function(t){if(this._extensions)for(var e=this._extensions.length;e--;)this._extensions[e]===t&&(this._extensions.splice(e,1),t.removed&&t.removed(this))},pipeThroughExtensions:function(r,t,i,o,s){if(this.debug("Passing through ? extensions: ?",r,t),!this._extensions)return o.call(s,t);var a=this._extensions.slice(),u=function(t){if(!t)return o.call(s,t);var e=a.shift();if(!e)return o.call(s,t);var n=e[r];if(!n)return u(t);3<=n.length?e[r](t,i,u):e[r](t,u)};u(t)}};t("../util/extend")(r,t("../mixins/logging")),e.exports=r},{"../mixins/logging":51,"../util/extend":77}],59:[function(t,e,n){"use strict";e.exports={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/}},{}],60:[function(t,e,n){"use strict";var r=t("../util/class"),t=t("../mixins/deferrable");e.exports=r(t)},{"../mixins/deferrable":50,"../util/class":72}],61:[function(t,e,n){"use strict";function r(t,e){this.message=t,this.options=e,this.attempts=0}t("../util/extend")(r.prototype,{getTimeout:function(){return this.options.timeout},getInterval:function(){return this.options.interval},isDeliverable:function(){var t=this.options.attempts,e=this.attempts,n=this.options.deadline,r=(new Date).getTime();return!(void 0!==t&&t<=e)&&!(void 0!==n&&n<r)},send:function(){this.attempts+=1},succeed:function(){},fail:function(){},abort:function(){}}),e.exports=r},{"../util/extend":77}],62:[function(t,e,n){"use strict";var r=t("../util/class"),i=t("../util/extend"),t=t("../mixins/deferrable"),r=r({initialize:function(t,e,n,r){this._client=t,this._channels=e,this._callback=n,this._context=r,this._cancelled=!1},withChannel:function(t,e){return this._withChannel=[t,e],this},apply:function(t,e){e=e[0];this._callback&&this._callback.call(this._context,e.data),this._withChannel&&this._withChannel[0].call(this._withChannel[1],e.channel,e.data)},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this),this._cancelled=!0)},unsubscribe:function(){this.cancel()}});i(r.prototype,t),e.exports=r},{"../mixins/deferrable":50,"../util/class":72,"../util/extend":77}],63:[function(t,e,n){"use strict";var r=t("./transport");r.register("websocket",t("./web_socket")),r.register("eventsource",t("./event_source")),r.register("long-polling",t("./xhr")),r.register("cross-origin-long-polling",t("./cors")),r.register("callback-polling",t("./jsonp")),e.exports=r},{"./cors":64,"./event_source":65,"./jsonp":66,"./transport":67,"./web_socket":68,"./xhr":69}],64:[function(i,o,t){(function(u){"use strict";var t=i("../util/class"),e=i("../util/set"),c=i("../util/uri"),n=i("../util/extend"),r=i("../util/to_json"),l=n(t(i("./transport"),{encode:function(t){return"message="+encodeURIComponent(r(t))},request:function(e){var t,n=u.XDomainRequest?XDomainRequest:XMLHttpRequest,r=new n,i=++l._id,o=this._dispatcher.headers,s=this;if(r.open("POST",c.stringify(this.endpoint),!0),r.setRequestHeader)for(t in r.setRequestHeader("Pragma","no-cache"),o)o.hasOwnProperty(t)&&r.setRequestHeader(t,o[t]);function a(){r&&(l._pending.remove(i),r.onload=r.onerror=r.ontimeout=r.onprogress=null,r=null)}return r.onload=function(){var t;try{t=JSON.parse(r.responseText)}catch(t){}a(),t?s._receive(t):s._handleError(e)},r.onerror=r.ontimeout=function(){a(),s._handleError(e)},r.onprogress=function(){},n===u.XDomainRequest&&l._pending.add({id:i,xhr:r}),r.send(this.encode(e)),r}}),{_id:0,_pending:new e,isUsable:function(t,e,n,r){if(c.isSameOrigin(e))return n.call(r,!1);if(u.XDomainRequest)return n.call(r,e.protocol===location.protocol);if(u.XMLHttpRequest){e=new XMLHttpRequest;return n.call(r,void 0!==e.withCredentials)}return n.call(r,!1)}});o.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/class":72,"../util/extend":77,"../util/set":79,"../util/to_json":80,"../util/uri":81,"./transport":67}],65:[function(r,c,t){(function(i){"use strict";var t=r("../util/class"),o=r("../util/uri"),s=r("../util/copy_object"),e=r("../util/extend"),n=r("../mixins/deferrable"),a=r("./transport"),u=r("./xhr"),t=e(t(a,{initialize:function(t,e){if(a.prototype.initialize.call(this,t,e),!i.EventSource)return this.setDeferredStatus("failed");this._xhr=new u(t,e),(e=s(e)).pathname+="/"+t.clientId;var n=new i.EventSource(o.stringify(e)),r=this;n.onopen=function(){r._everConnected=!0,r.setDeferredStatus("succeeded")},n.onerror=function(){r._everConnected?r._handleError([]):(r.setDeferredStatus("failed"),n.close())},n.onmessage=function(t){var e;try{e=JSON.parse(t.data)}catch(t){}e?r._receive(e):r._handleError([])},this._socket=n},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)})},encode:function(t){return this._xhr.encode(t)},request:function(t){return this._xhr.request(t)}}),{isUsable:function(e,n,r,i){if(!e.clientId)return r.call(i,!1);u.isUsable(e,n,function(t){return t?void this.create(e,n).isUsable(r,i):r.call(i,!1)},this)},create:function(t,e){var n=t.transports.eventsource=t.transports.eventsource||{},r=t.clientId,i=s(e);return i.pathname+="/"+(r||""),n[i=o.stringify(i)]=n[i]||new this(t,e),n[i]}});e(t.prototype,n),c.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/deferrable":50,"../util/class":72,"../util/copy_object":75,"../util/extend":77,"../util/uri":81,"./transport":67,"./xhr":69}],66:[function(n,r,t){(function(a){"use strict";var t=n("../util/class"),u=n("../util/uri"),c=n("../util/copy_object"),e=n("../util/extend"),l=n("../util/to_json"),h=e(t(n("./transport"),{encode:function(t){var e=c(this.endpoint);return e.query.message=l(t),e.query.jsonp="__jsonp"+h._cbCount+"__",u.stringify(e)},request:function(t){var e=document.getElementsByTagName("head")[0],n=document.createElement("script"),r=h.getCallbackName(),i=c(this.endpoint),o=this;i.query.message=l(t),i.query.jsonp=r;function s(){if(!a[r])return!1;a[r]=void 0;try{delete a[r]}catch(t){}n.parentNode.removeChild(n)}return a[r]=function(t){s(),o._receive(t)},n.type="text/javascript",n.src=u.stringify(i),e.appendChild(n),n.onerror=function(){s(),o._handleError(t)},{abort:s}}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,"__jsonp"+this._cbCount+"__"},isUsable:function(t,e,n,r){n.call(r,!0)}});r.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/class":72,"../util/copy_object":75,"../util/extend":77,"../util/to_json":80,"../util/uri":81,"./transport":67}],67:[function(u,c,t){(function(o){"use strict";var t=u("../util/class"),s=u("../util/cookies").Cookie,n=u("../util/promise"),l=u("../util/uri"),h=u("../util/array"),r=u("../util/extend"),e=u("../mixins/logging"),i=u("../mixins/timeouts"),a=u("../protocol/channel"),t=r(t({className:"Transport",DEFAULT_PORTS:{"http:":80,"https:":443,"ws:":80,"wss:":443},MAX_DELAY:0,batching:!0,initialize:function(t,e){this._dispatcher=t,this.endpoint=e,this._outbox=[],this._proxy=r({},this._dispatcher.proxy),this._proxy.origin||(this._proxy.origin=this._findProxy())},close:function(){},encode:function(t){return""},sendMessage:function(t){return this.debug("Client ? sending message to ?: ?",this._dispatcher.clientId,l.stringify(this.endpoint),t),this.batching?(this._outbox.push(t),this._flushLargeBatch(),t.channel===a.HANDSHAKE?this._publish(.01):(t.channel===a.CONNECT&&(this._connectMessage=t),this._publish(this.MAX_DELAY))):n.resolve(this.request([t]))},_makePromise:function(){var e=this;this._requestPromise=this._requestPromise||new n(function(t){e._resolvePromise=t})},_publish:function(t){return this._makePromise(),this.addTimeout("publish",t,function(){this._flush(),delete this._requestPromise},this),this._requestPromise},_flush:function(){this.removeTimeout("publish"),1<this._outbox.length&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this._resolvePromise(this.request(this._outbox)),this._connectMessage=null,this._outbox=[]},_flushLargeBatch:function(){var t;this.encode(this._outbox).length<this._dispatcher.maxRequestSize||(t=this._outbox.pop(),this._makePromise(),this._flush(),t&&this._outbox.push(t))},_receive:function(t){if(t){t=[].concat(t),this.debug("Client ? received from ? via ?: ?",this._dispatcher.clientId,l.stringify(this.endpoint),this.connectionType,t);for(var e=0,n=t.length;e<n;e++)this._dispatcher.handleResponse(t[e])}},_handleError:function(t,e){t=[].concat(t),this.debug("Client ? failed to send to ? via ?: ?",this._dispatcher.clientId,l.stringify(this.endpoint),this.connectionType,t);for(var n=0,r=t.length;n<r;n++)this._dispatcher.handleError(t[n])},_getCookies:function(){var t=this._dispatcher.cookies,e=l.stringify(this.endpoint);return t?h.map(t.getCookiesSync(e),function(t){return t.cookieString()}).join("; "):""},_storeCookies:function(t){var e,n=this._dispatcher.cookies,r=l.stringify(this.endpoint);if(t&&n)for(var i=0,o=(t=[].concat(t)).length;i<o;i++)e=s.parse(t[i]),n.setCookieSync(e,r)},_findProxy:function(){if(void 0!==o){var t=this.endpoint.protocol;if(t){var e,n=t.replace(/:$/,"").toLowerCase()+"_proxy",r=n.toUpperCase(),i=o.env;return"http_proxy"===n&&i.REQUEST_METHOD?(1===(t=Object.keys(i).filter(function(t){return/^http_proxy$/i.test(t)})).length?t[0]===n&&void 0===i[r]&&(e=i[n]):1<t.length&&(e=i[n]),e=e||i["CGI_"+r]):(e=i[n]||i[r])&&!i[n]&&console.warn("The environment variable "+r+" is discouraged. Use "+n+"."),e}}}}),{get:function(o,s,a,u,c){var t=o.endpoint;h.asyncEach(this._transports,function(t,e){var n=t[0],r=t[1],i=o.endpointFor(n);return 0<=h.indexOf(a,n)?e():h.indexOf(s,n)<0?(r.isUsable(o,i,function(){}),e()):void r.isUsable(o,i,function(t){if(!t)return e();t=r.hasOwnProperty("create")?r.create(o,i):new r(o,i);u.call(c,t)})},function(){throw new Error("Could not find a usable connection type for "+l.stringify(t))})},register:function(t,e){this._transports.push([t,e]),e.prototype.connectionType=t},getConnectionTypes:function(){return h.map(this._transports,function(t){return t[0]})},_transports:[]});r(t.prototype,e),r(t.prototype,i),c.exports=t}).call(this,u("_process"))},{"../mixins/logging":51,"../mixins/timeouts":53,"../protocol/channel":54,"../util/array":70,"../util/class":72,"../util/cookies":74,"../util/extend":77,"../util/promise":78,"../util/uri":81,_process:92}],68:[function(f,p,t){(function(t){"use strict";var e=f("../util/class"),o=f("../util/promise"),s=f("../util/set"),n=f("../util/uri"),r=f("../util/browser"),i=f("../util/copy_object"),a=f("../util/extend"),u=f("../util/to_json"),c=f("../util/websocket"),l=f("../mixins/deferrable"),h=a(e(f("./transport"),{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)}),this.connect()},request:function(n){this._pending=this._pending||new s;for(var t=0,e=n.length;t<e;t++)this._pending.add(n[t]);var r=this,i=new o(function(e,t){r.callback(function(t){t&&1===t.readyState&&(t.send(u(n)),e(t))}),r.connect()});return{abort:function(){i.then(function(t){t.close()})}}},connect:function(){if(!h._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var n=this._createSocket();if(!n)return this.setDeferredStatus("failed");var i=this,r=!(n.onopen=function(){n.headers&&i._storeCookies(n.headers["set-cookie"]),i._socket=n,i._state=i.CONNECTED,i._everConnected=!0,i._ping(),i.setDeferredStatus("succeeded",n)});n.onclose=n.onerror=function(){var t,e;r||(r=!0,t=i._state===i.CONNECTED,n.onopen=n.onclose=n.onerror=n.onmessage=null,delete i._socket,i._state=i.UNCONNECTED,i.removeTimeout("ping"),e=i._pending?i._pending.toArray():[],delete i._pending,t||i._everConnected?(i.setDeferredStatus("unknown"),i._handleError(e,t)):i.setDeferredStatus("failed"))},n.onmessage=function(t){var e;try{e=JSON.parse(t.data)}catch(t){}if(e){for(var n=0,r=(e=[].concat(e)).length;n<r;n++)void 0!==e[n].successful&&i._pending.remove(e[n]);i._receive(e)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var t=h.getSocketUrl(this.endpoint),e=this._dispatcher.headers,n=this._dispatcher.wsExtensions,r=this._getCookies(),i=this._dispatcher.tls,i={extensions:n,headers:e,proxy:this._proxy,tls:i};return""!==r&&(i.headers.Cookie=r),c.create(t,[],i)},_ping:function(){this._socket&&1===this._socket.readyState&&(this._socket.send("[]"),this.addTimeout("ping",this._dispatcher.timeout/2,this._ping,this))}}),{PROTOCOLS:{"http:":"ws:","https:":"wss:"},create:function(t,e){var n=t.transports.websocket=t.transports.websocket||{};return n[e.href]=n[e.href]||new this(t,e),n[e.href]},getSocketUrl:function(t){return(t=i(t)).protocol=this.PROTOCOLS[t.protocol],n.stringify(t)},isUsable:function(t,e,n,r){this.create(t,e).isUsable(n,r)}});a(h.prototype,l),r.Event&&void 0!==t.onbeforeunload&&r.Event.on(t,"beforeunload",function(){h._unloaded=!0}),p.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/deferrable":50,"../util/browser":71,"../util/class":72,"../util/copy_object":75,"../util/extend":77,"../util/promise":78,"../util/set":79,"../util/to_json":80,"../util/uri":81,"../util/websocket":83,"./transport":67}],69:[function(r,o,t){(function(a){"use strict";var t=r("../util/class"),i=r("../util/uri"),u=r("../util/browser"),e=r("../util/extend"),n=r("../util/to_json"),t=e(t(r("./transport"),{encode:function(t){return n(t)},request:function(r){var i,t=this.endpoint.href,o=this;if(a.XMLHttpRequest)i=new XMLHttpRequest;else{if(!a.ActiveXObject)return this._handleError(r);i=new ActiveXObject("Microsoft.XMLHTTP")}i.open("POST",t,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Pragma","no-cache"),i.setRequestHeader("X-Requested-With","XMLHttpRequest");var e,n=this._dispatcher.headers;for(e in n)n.hasOwnProperty(e)&&i.setRequestHeader(e,n[e]);function s(){i.abort()}return void 0!==a.onbeforeunload&&u.Event.on(a,"beforeunload",s),i.onreadystatechange=function(){if(i&&4===i.readyState){var t=null,e=i.status,n=i.responseText,e=200<=e&&e<300||304===e||1223===e;if(void 0!==a.onbeforeunload&&u.Event.detach(a,"beforeunload",s),i.onreadystatechange=function(){},i=null,!e)return o._handleError(r);try{t=JSON.parse(n)}catch(t){}t?o._receive(t):o._handleError(r)}},i.send(this.encode(r)),i}}),{isUsable:function(t,e,n,r){e="ReactNative"===navigator.product||i.isSameOrigin(e);n.call(r,e)}});o.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/browser":71,"../util/class":72,"../util/extend":77,"../util/to_json":80,"../util/uri":81,"./transport":67}],70:[function(t,e,n){"use strict";e.exports={commonElement:function(t,e){for(var n=0,r=t.length;n<r;n++)if(-1!==this.indexOf(e,t[n]))return t[n];return null},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},map:function(t,e,n){if(t.map)return t.map(e,n);var r=[];if(t instanceof Array)for(var i=0,o=t.length;i<o;i++)r.push(e.call(n||null,t[i],i));else for(var s in t)t.hasOwnProperty(s)&&r.push(e.call(n||null,s,t[s]));return r},filter:function(t,e,n){if(t.filter)return t.filter(e,n);for(var r=[],i=0,o=t.length;i<o;i++)e.call(n||null,t[i],i)&&r.push(t[i]);return r},asyncEach:function(t,e,n,r){function i(){if(!u){for(u=!0;0<a;)--a,!((s+=1)===o?n&&n.call(r):void e(t[s],c));u=!1}}var o=t.length,s=-1,a=0,u=!1,c=function(){a+=1,i()};c()}}},{}],71:[function(t,n,e){(function(t){"use strict";var e={_registry:[],on:function(t,e,n,r){function i(){n.call(r)}t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i),this._registry.push({_element:t,_type:e,_callback:n,_context:r,_handler:i})},detach:function(t,e,n,r){for(var i,o=this._registry.length;o--;)i=this._registry[o],t&&t!==i._element||e&&e!==i._type||n&&n!==i._callback||r&&r!==i._context||(i._element.removeEventListener?i._element.removeEventListener(i._type,i._handler,!1):i._element.detachEvent("on"+i._type,i._handler),this._registry.splice(o,1),i=null)}};void 0!==t.onunload&&e.on(t,"unload",e.detach,e),n.exports={Event:e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],72:[function(t,e,n){"use strict";var i=t("./extend");e.exports=function(t,e){"function"!=typeof t&&(e=t,t=Object);function n(){return this.initialize&&this.initialize.apply(this,arguments)||this}function r(){}return r.prototype=t.prototype,n.prototype=new r,i(n.prototype,e),n}},{"./extend":77}],73:[function(t,e,n){e.exports={VERSION:"1.2.4",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"]}},{}],74:[function(t,e,n){"use strict";e.exports={}},{}],75:[function(t,e,n){"use strict";var i=function(t){var e,n,r;if(t instanceof Array){for(e=[],n=t.length;n--;)e[n]=i(t[n]);return e}if("object"!=typeof t)return t;for(r in e=null===t?null:{},t)e[r]=i(t[r]);return e};e.exports=i},{}],76:[function(t,e,n){var s="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};function r(){}(e.exports=r).prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||s(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(s(e)){for(var n=Array.prototype.slice.call(arguments,1),r=e.slice(),i=0,o=r.length;i<o;i++)r[i].apply(this,n);return!0}return!1},r.prototype.on=r.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",t,e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,this},r.prototype.once=function(e,n){var r=this;return r.on(e,function t(){r.removeListener(e,t),n.apply(this,arguments)}),this},r.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(s(n)){var r=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}(n,e);if(r<0)return this;n.splice(r,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},r.prototype.removeAllListeners=function(t){return 0===arguments.length?this._events={}:t&&this._events&&this._events[t]&&(this._events[t]=null),this},r.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),s(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}},{}],77:[function(t,e,n){"use strict";e.exports=function(t,e,n){if(!e)return t;for(var r in e)e.hasOwnProperty(r)&&(t.hasOwnProperty(r)&&!1===n||t[r]!==e[r]&&(t[r]=e[r]));return t}},{}],78:[function(t,e,n){"use strict";function i(t){return t}function o(t){throw t}function s(t){var e;this._state=0,this._onFulfilled=[],this._onRejected=[],"function"==typeof t&&(e=this,t(function(t){h(e,t)},function(t){p(e,t)}))}var r=t("asap");s.prototype.then=function(t,e){var n=new s;return a(this,t,n),u(this,e,n),n},s.prototype.catch=function(t){return this.then(null,t)};var a=function(t,e,n){"function"!=typeof e&&(e=i);function r(t){c(e,t,n)}0===t._state?t._onFulfilled.push(r):1===t._state&&r(t._value)},u=function(t,e,n){"function"!=typeof e&&(e=o);function r(t){c(e,t,n)}0===t._state?t._onRejected.push(r):2===t._state&&r(t._reason)},c=function(t,e,n){r(function(){l(t,e,n)})},l=function(t,e,n){var r;try{r=t(e)}catch(t){return p(n,t)}r===n?p(n,new TypeError("Recursive promise chain detected")):h(n,r)},h=function(e,t){var n,r=!1;try{if(n=typeof t,"function"!=typeof(n=null!==t&&("function"==n||"object"==n)&&t.then))return f(e,t);n.call(t,function(t){r^(r=!0)&&h(e,t)},function(t){r^(r=!0)&&p(e,t)})}catch(t){if(!(r^(r=!0)))return;p(e,t)}},f=function(t,e){if(0===t._state){t._state=1,t._value=e,t._onRejected=[];for(var n,r=t._onFulfilled;n=r.shift();)n(e)}},p=function(t,e){if(0===t._state){t._state=2,t._reason=e,t._onFulfilled=[];for(var n,r=t._onRejected;n=r.shift();)n(e)}};s.resolve=function(n){return new s(function(t,e){t(n)})},s.reject=function(n){return new s(function(t,e){e(n)})},s.all=function(e){return new s(function(n,r){var t,i=[],o=e.length;if(0===o)return n(i);for(t=0;t<o;t++)!function(t,e){s.resolve(t).then(function(t){i[e]=t,0==--o&&n(i)},r)}(e[t],t)})},s.race=function(i){return new s(function(t,e){for(var n=0,r=i.length;n<r;n++)s.resolve(i[n]).then(t,e)})},s.deferred=s.pending=function(){var n={};return n.promise=new s(function(t,e){n.resolve=t,n.reject=e}),n},e.exports=s},{asap:37}],79:[function(t,e,n){"use strict";t=t("./class");e.exports=t({initialize:function(){this._index={}},add:function(t){var e=void 0!==t.id?t.id:t;return!this._index.hasOwnProperty(e)&&(this._index[e]=t,!0)},forEach:function(t,e){for(var n in this._index)this._index.hasOwnProperty(n)&&t.call(e,this._index[n])},isEmpty:function(){for(var t in this._index)if(this._index.hasOwnProperty(t))return!1;return!0},member:function(t){for(var e in this._index)if(this._index[e]===t)return!0;return!1},remove:function(t){var e=void 0!==t.id?t.id:t,t=this._index[e];return delete this._index[e],t},toArray:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}})},{"./class":72}],80:[function(t,e,n){"use strict";e.exports=function(t){return JSON.stringify(t,function(t,e){return this[t]instanceof Array?this[t]:e})}},{}],81:[function(t,e,n){"use strict";e.exports={isURI:function(t){return t&&t.protocol&&t.host&&t.path},isSameOrigin:function(t){return t.protocol===location.protocol&&t.hostname===location.hostname&&t.port===location.port},parse:function(n){if("string"!=typeof n)return n;var t,e,r,i,o,s={},a=function(e,t){n=n.replace(t,function(t){return s[e]=t,""}),s[e]=s[e]||""};for(a("protocol",/^[a-z]+\:/i),a("host",/^\/\/[^\/\?#]+/),/^\//.test(n)||s.host||(n=location.pathname.replace(/[^\/]*$/,"")+n),a("pathname",/^[^\?#]*/),a("search",/^\?[^#]*/),a("hash",/^#.*/),s.protocol=s.protocol||location.protocol,s.host?(s.host=s.host.substr(2),t=s.host.split(":"),s.hostname=t[0],s.port=t[1]||""):(s.host=location.host,s.hostname=location.hostname,s.port=location.port),s.pathname=s.pathname||"/",s.path=s.pathname+s.search,o={},r=0,i=(e=(a=s.search.replace(/^\?/,""))?a.split("&"):[]).length;r<i;r++)t=e[r].split("="),o[decodeURIComponent(t[0]||"")]=decodeURIComponent(t[1]||"");return s.query=o,s.href=this.stringify(s),s},stringify:function(t){var e=t.protocol+"//"+t.hostname;return t.port&&(e+=":"+t.port),e+=t.pathname+this.queryString(t.query)+(t.hash||"")},queryString:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return 0===n.length?"":"?"+n.join("&")}}},{}],82:[function(t,e,n){"use strict";var r=t("./array");e.exports=function(t,e){for(var n in t)if(r.indexOf(e,n)<0)throw new Error("Unrecognized option: "+n)}},{"./array":70}],83:[function(t,e,n){(function(t){"use strict";var r=t.MozWebSocket||t.WebSocket;e.exports={create:function(t,e,n){return"function"!=typeof r?null:new r(t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],84:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,n=t[e+h];for(h+=f,o=n&(1<<-l)-1,n>>=-l,l+=a;0<l;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;0<l;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(n?-1:1);s+=Math.pow(2,r),o-=c}return(n?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u=8*o-i-1,c=(1<<u)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,o=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(e+=1<=s+l?h/r:h*Math.pow(2,1-l))*r&&(s++,r/=2),c<=s+l?(a=0,s=c):1<=s+l?(a=(e*r-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));8<=i;t[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;0<u;t[n+f]=255&s,f+=p,s/=256,u-=8);t[n+f-p]|=128*o}},{}],85:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],86:[function(t,e,n){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}e.exports=function(t){return null!=t&&(r(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))||!!t._isBuffer);var e}},{}],87:[function(t,e,n){var r={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},{}],88:[function(t,P,e){(function(t){var e="Expected a function",r="__lodash_hash_undefined__",o=1/0,n="[object Function]",i="[object GeneratorFunction]",s="[object Symbol]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/,c=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,f=/^\[object .+?Constructor\]$/,p="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,y=p||d||Function("return this")();var m=Array.prototype,t=Function.prototype,p=Object.prototype,d=y["__core-js_shared__"],_=(d=/[^.]+$/.exec(d&&d.keys&&d.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",g=t.toString,b=p.hasOwnProperty,v=p.toString,w=RegExp("^"+g.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),p=y.Symbol,E=m.splice,T=k(y,"Map"),x=k(Object,"create"),p=p?p.prototype:void 0,S=p?p.toString:void 0;function C(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function I(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function O(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function N(t,e){for(var n,r,i=t.length;i--;)if((n=t[i][0])===(r=e)||n!=n&&r!=r)return i;return-1}function A(t,e){for(var n,r=0,i=(e=function(t,e){if(M(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||q(t))return!0;return u.test(t)||!a.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:M(n=e)?n:L(n)).length;null!=t&&r<i;)t=t[function(t){if("string"==typeof t||q(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}(e[r++])];return r&&r==i?t:void 0}function D(t){var e;return U(t)&&(e=t,!(_&&_ in e))&&(function(t){t=U(t)?v.call(t):"";return t==n||t==i}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?w:f).test(function(t){if(null!=t){try{return g.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function j(t,e){var n,r=t.__data__;return("string"==(t=typeof(n=e))||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function k(t,e){e=e,e=null==(t=t)?void 0:t[e];return D(e)?e:void 0}C.prototype.clear=function(){this.__data__=x?x(null):{}},C.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},C.prototype.get=function(t){var e=this.__data__;if(x){var n=e[t];return n===r?void 0:n}return b.call(e,t)?e[t]:void 0},C.prototype.has=function(t){var e=this.__data__;return x?void 0!==e[t]:b.call(e,t)},C.prototype.set=function(t,e){return this.__data__[t]=x&&void 0===e?r:e,this},I.prototype.clear=function(){this.__data__=[]},I.prototype.delete=function(t){var e=this.__data__;return!((t=N(e,t))<0)&&(t==e.length-1?e.pop():E.call(e,t,1),!0)},I.prototype.get=function(t){var e=this.__data__;return(t=N(e,t))<0?void 0:e[t][1]},I.prototype.has=function(t){return-1<N(this.__data__,t)},I.prototype.set=function(t,e){var n=this.__data__,r=N(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},O.prototype.clear=function(){this.__data__={hash:new C,map:new(T||I),string:new C}},O.prototype.delete=function(t){return j(this,t).delete(t)},O.prototype.get=function(t){return j(this,t).get(t)},O.prototype.has=function(t){return j(this,t).has(t)},O.prototype.set=function(t,e){return j(this,t).set(t,e),this};var L=R(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(q(t))return S?S.call(t):"";var e=t+"";return"0"==e&&1/t==-o?"-0":e}(e);var i=[];return c.test(t)&&i.push(""),t.replace(l,function(t,e,n,r){i.push(n?r.replace(h,"$1"):e||t)}),i});function R(r,i){if("function"!=typeof r||i&&"function"!=typeof i)throw new TypeError(e);var o=function(){var t=arguments,e=i?i.apply(this,t):t[0],n=o.cache;if(n.has(e))return n.get(e);t=r.apply(this,t);return o.cache=n.set(e,t),t};return o.cache=new(R.Cache||O),o}R.Cache=O;var M=Array.isArray;function U(t){var e=typeof t;return t&&("object"==e||"function"==e)}function q(t){return"symbol"==typeof t||!!(e=t)&&"object"==typeof e&&v.call(t)==s;var e}P.exports=function(t,e,n){return void 0===(e=null==t?void 0:A(t,e))?n:e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],89:[function(t,ue,ce){(function(ae){(function(){var _,r="Expected a function",g=1,d=2,a=9007199254740991,y="[object Arguments]",m="[object Array]",e="[object AsyncFunction]",b="[object Boolean]",v="[object Date]",w="[object Error]",n="[object Function]",i="[object GeneratorFunction]",E="[object Number]",T="[object Object]",o="[object Proxy]",x="[object RegExp]",S="[object String]",s=/[&<>"']/g,u=RegExp(s.source),c=/^(?:0|[1-9]\d*)$/,t="object"==typeof ae&&ae&&ae.Object===Object&&ae,l="object"==typeof self&&self&&self.Object===Object&&self,f=t||l||Function("return this")(),h="object"==typeof ce&&ce&&!ce.nodeType&&ce,p=h&&"object"==typeof ue&&ue&&!ue.nodeType&&ue;function C(t,e){return t.push.apply(t,e),t}function I(e){return function(t){return null==t?_:t[e]}}var O,N=(O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},function(t){return null==O?_:O[t]});var A,D,j=Array.prototype,k=Object.prototype,L=k.hasOwnProperty,R=0,M=k.toString,U=f._,q=Object.create,P=k.propertyIsEnumerable,F=f.isFinite,B=(A=Object.keys,D=Object,function(t){return A(D(t))}),X=Math.max;function z(t){return t instanceof G?t:new G(t)}var V=function(t){if(!zt(t))return{};if(q)return q(t);H.prototype=t;t=new H;return H.prototype=_,t};function H(){}function G(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e}function W(t,e,n){t[e]=n}function $(t,e,n){if("function"!=typeof t)throw new TypeError(r);return setTimeout(function(){t.apply(_,n)},e)}(G.prototype=V(z.prototype)).constructor=G;var Y,J,Q=(Y=rt,function(t,e){if(null==t)return t;if(!Ft(t))return Y(t,e);for(var n=t.length,r=J?n:-1,i=Object(t);(J?r--:++r<n)&&!1!==e(i[r],r,i););return t});function K(t,e,n){for(var r=-1,i=t.length;++r<i;){var o,s,a=t[r],u=e(a);null!=u&&(o===_?u==u:n(u,o))&&(o=u,s=a)}return s}function Z(t,r){var i=[];return Q(t,function(t,e,n){r(t,e,n)&&i.push(t)}),i}function tt(t,e,n,r,i){var o=-1,s=t.length;for(n=n||vt,i=i||[];++o<s;){var a=t[o];0<e&&n(a)?1<e?tt(a,e-1,n,r,i):C(i,a):r||(i[i.length]=a)}return i}var et,nt=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),s=o.length;s--;){var a=o[et?s:++r];if(!1===e(i[a],a,i))break}return t};function rt(t,e){return t&&nt(t,e,te)}function it(e,t){return Z(t,function(t){return Xt(e[t])})}function ot(t){return t=t,M.call(t)}function st(t,e){return e<t}var at=se;function ut(t,e,n,r,i){return t===e||(null==t||null==e||!Vt(t)&&!Vt(e)?t!=t&&e!=e:function(e,n,t,r,i,o){var s=Pt(e),a=Pt(n),u=s?m:ot(e),c=a?m:ot(n),l=(u=u==y?T:u)==T,h=(c=c==y?T:c)==T,f=u==c;o=o||[];a=At(o,function(t){return t[0]==e}),c=At(o,function(t){return t[0]==n});if(a&&c)return a[1]==n;if(o.push([e,n]),o.push([n,e]),f&&!l){var p=s?function(t,e,n,r,i,o){var s=n&g,a=t.length,u=e.length;if(a!=u&&!(s&&a<u))return!1;var c=-1,l=!0,h=n&d?[]:_;for(;++c<a;){var f=t[c],p=e[c];if(void 0!==_){void 0,l=!1;break}if(h){if(!mt(e,function(t,e){if(!It(h,e)&&(f===t||i(f,t,n,r,o)))return h.push(e)})){l=!1;break}}else if(f!==p&&!i(f,p,n,r,o)){l=!1;break}}return l}(e,n,t,r,i,o):function(t,e,n){switch(n){case b:case v:case E:return Ut(+t,+e);case w:return t.name==e.name&&t.message==e.message;case x:case S:return t==e+""}return!1}(e,n,u);return o.pop(),p}if(!(t&g)){l=l&&L.call(e,"__wrapped__"),h=h&&L.call(n,"__wrapped__");if(l||h){l=l?e.value():e,h=h?n.value():n,p=i(l,h,t,r,o);return o.pop(),p}}if(!f)return!1;p=function(t,e,n,r,i,o){var s=n&g,a=te(t),u=a.length,c=te(e).length;if(u!=c&&!s)return!1;var l=u;for(;l--;){var h=a[l];if(!(s?h in e:L.call(e,h)))return!1}var f=!0,p=s;for(;++l<u;){h=a[l];var d=t[h],y=e[h];if(void 0!==_||d!==y&&!i(d,y,n,r,o)){f=!1;break}p=p||"constructor"==h}{var m;f&&!p&&(m=t.constructor,c=e.constructor,m!=c&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof c&&c instanceof c)&&(f=!1))}return f}(e,n,t,r,i,o);return o.pop(),p}(t,e,n,r,ut,i))}function ct(t){return"function"==typeof t?t:null==t?re:("object"==typeof t?ft:I)(t)}function lt(t,e){return t<e}function ht(t,r){var i=-1,o=Ft(t)?Array(t.length):[];return Q(t,function(t,e,n){o[++i]=r(t,e,n)}),o}function ft(r){var i=B(r);return function(t){var e=i.length;if(null==t)return!e;for(t=Object(t);e--;){var n=i[e];if(!(n in t&&ut(r[n],t[n],g|d)))return!1}return!0}}function pt(t,e){return xt(Tt(t,e,re),t+"")}function dt(t,e,n){var r=-1,i=t.length;e<0&&(e=i<-e?0:i+e),(n=i<n?i:n)<0&&(n+=i),i=n<e?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}function yt(t){return dt(t,0,t.length)}function mt(t,r){var i;return Q(t,function(t,e,n){return!(i=r(t,e,n))}),!!i}function _t(t,e,n,r){var i=!n;n=n||{};for(var o,s,a=-1,u=e.length;++a<u;){var c=e[a],l=r?r(n[c],t[c],c,n,t):_;l===_&&(l=t[c]),i?W(n,c,l):(o=l,s=void 0,s=(l=n)[c=c],L.call(l,c)&&Ut(s,o)&&(o!==_||c in l)||W(l,c,o))}return n}function gt(s){return pt(function(t,e){var n=-1,r=e.length,i=1<r?e[r-1]:_,i=3<s.length&&"function"==typeof i?(r--,i):_;for(t=Object(t);++n<r;){var o=e[n];o&&s(t,o,n,i)}return t})}function bt(a,t,u,c){if("function"!=typeof a)throw new TypeError(r);var n,l=1&t,h=(n=a,function(){var t=arguments,e=V(n.prototype),t=n.apply(e,t);return zt(t)?t:e});return function t(){for(var e=-1,n=arguments.length,r=-1,i=c.length,o=Array(i+n),s=this&&this!==f&&this instanceof t?h:a;++r<i;)o[r]=c[r];for(;n--;)o[r++]=arguments[++e];return s.apply(l?u:this,o)}}function vt(t){return Pt(t)||qt(t)}function wt(t,e,n){if(zt(n)){var r,i,o,s=typeof e;return("number"==s?Ft(n)&&(r=e,i=n.length,o=typeof r,(i=null==i?a:i)&&("number"==o||"symbol"!=o&&c.test(r))&&-1<r&&r%1==0&&r<i):"string"==s&&e in n)&&Ut(n[e],t)}}function Et(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}function Tt(o,s,a){return s=X(s===_?o.length-1:s,0),function(){for(var t=arguments,e=-1,n=X(t.length-s,0),r=Array(n);++e<n;)r[e]=t[s+e];e=-1;for(var i=Array(s+1);++e<s;)i[e]=t[e];return i[s]=a(r),o.apply(this,i)}}var xt=re;function St(t){return(null==t?0:t.length)?tt(t,1):[]}function Ct(t){return t&&t.length?t[0]:_}function It(t,e,n){for(var r=null==t?0:t.length,i=((n="number"==typeof n?n<0?X(r+n,0):n:0)||0)-1,o=e==e;++i<r;){var s=t[i];if(o?s===e:s!=s)return i}return-1}function Ot(t){t=z(t);return t.__chain__=!0,t}var Nt,At=(Nt=function(t,e,n){var r=null==t?0:t.length;return r?((n=null==n?0:$t(n))<0&&(n=X(r+n,0)),function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}(t,ct(e),n)):-1},function(t,e,n){var r,i=Object(t);Ft(t)||(r=ct(e),t=te(t),e=function(t){return r(i[t],t,i)});n=Nt(t,e,n);return-1<n?i[r?t[n]:n]:_});function Dt(t,e){return Q(t,ct(e))}function jt(t,e,n){return r=t,i=ct(e),o=n,s=arguments.length<3,Q(r,function(t,e,n){o=s?(s=!1,t):i(o,t,e,n)}),o;var r,i,o,s}function kt(t,e){var n;if("function"!=typeof e)throw new TypeError(r);return t=$t(t),function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=_),n}}var Lt=pt(function(t,e,n){return bt(t,33,e,n)}),Rt=pt(function(t,e){return $(t,1,e)}),Mt=pt(function(t,e,n){return $(t,Yt(e)||0,n)});function Ut(t,e){return t===e||t!=t&&e!=e}var qt=at(function(){return arguments}())?at:function(t){return Vt(t)&&L.call(t,"callee")&&!P.call(t,"callee")},Pt=Array.isArray;function Ft(t){return null!=t&&("number"==typeof(e=t.length)&&-1<e&&e%1==0&&e<=a)&&!Xt(t);var e}function Bt(t){return Vt(t)&&ot(t)==v}function Xt(t){if(!zt(t))return!1;t=ot(t);return t==n||t==i||t==e||t==o}function zt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Vt(t){return null!=t&&"object"==typeof t}function Ht(t){return"number"==typeof t||Vt(t)&&ot(t)==E}function Gt(t){return Vt(t)&&ot(t)==x}function Wt(t){return"string"==typeof t||!Pt(t)&&Vt(t)&&ot(t)==S}var $t=Number,Yt=Number;function Jt(t){return"string"==typeof t?t:null==t?"":t+""}var Qt=gt(function(t,e){_t(e,B(e),t)}),Kt=gt(function(t,e){_t(e,Et(e),t)});t=pt(function(t,e){t=Object(t);var n=-1,r=e.length,i=2<r?e[2]:_;for(i&&wt(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],s=ee(o),a=-1,u=s.length;++a<u;){var c=s[a],l=t[c];(l===_||Ut(l,k[c])&&!L.call(t,c))&&(t[c]=o[c])}return t});var Zt,te=B,ee=Et,l=xt(Tt(Zt=function(t,e){return null==t?{}:(n=t,e=e,n=Object(n),jt(e,function(t,e){return e in n&&(t[e]=n[e]),t},{}));var n},_,St),Zt+"");function ne(t){return null==t?[]:ht(te(e=t),function(t){return e[t]});var e}function re(t){return t}var ie,at=ct;function oe(r,e,t){var n=te(e),i=it(e,n);null!=t||zt(e)&&(i.length||!n.length)||(t=e,e=r,r=this,i=it(e,te(e)));var o=!(zt(t)&&"chain"in t&&!t.chain),s=Xt(r);return Q(i,function(t){var n=e[t];r[t]=n,s&&(r.prototype[t]=function(){var t=this.__chain__;if(o||t){var e=r(this.__wrapped__);return(e.__actions__=yt(this.__actions__)).push({func:n,args:arguments,thisArg:r}),e.__chain__=t,e}return n.apply(r,C([this.value()],arguments))})}),r}function se(){}z.assignIn=Kt,z.before=kt,z.bind=Lt,z.chain=Ot,z.compact=function(t){return Z(t,Boolean)},z.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return C(Pt(n)?yt(n):[n],tt(e,1))},z.create=function(t,e){return t=V(t),null==e?t:Qt(t,e)},z.defaults=t,z.defer=Rt,z.delay=Mt,z.filter=function(t,e){return Z(t,ct(e))},z.flatten=St,z.flattenDeep=function(t){return(null==t?0:t.length)?tt(t,1/0):[]},z.iteratee=at,z.keys=te,z.map=function(t,e){return ht(t,ct(e))},z.matches=function(t){return ft(Qt({},t))},z.mixin=oe,z.negate=function(e){if("function"!=typeof e)throw new TypeError(r);return function(){var t=arguments;return!e.apply(this,t)}},z.once=function(t){return kt(2,t)},z.pick=l,z.slice=function(t,e,n){var r=null==t?0:t.length;return e=null==e?0:+e,n=n===_?r:+n,r?dt(t,e,n):[]},z.sortBy=function(t,r){var i=0;return r=ct(r),ht(ht(t,function(t,e,n){return{value:t,index:i++,criteria:r(t,e,n)}}).sort(function(t,e){return function(t,e){if(t!==e){var n=t!==_,r=null===t,i=t==t,o=e!==_,s=null===e,a=e==e;if(!s&&e<t||r&&o&&a||!n&&a||!i)return 1;if(!r&&t<e||s&&n&&i||!o&&i||!a)return-1}return 0}(t.criteria,e.criteria)||t.index-e.index}),I("value"))},z.tap=function(t,e){return e(t),t},z.thru=function(t,e){return e(t)},z.toArray=function(t){return Ft(t)?t.length?yt(t):[]:ne(t)},z.values=ne,z.extend=Kt,oe(z,z),z.clone=function(t){return zt(t)?Pt(t)?yt(t):_t(t,B(t)):t},z.escape=function(t){return(t=Jt(t))&&u.test(t)?t.replace(s,N):t},z.every=function(t,e,n){return t=t,r=ct(e=n?_:e),i=!0,Q(t,function(t,e,n){return i=!!r(t,e,n)}),i;var r,i},z.find=At,z.forEach=Dt,z.has=function(t,e){return null!=t&&L.call(t,e)},z.head=Ct,z.identity=re,z.indexOf=It,z.isArguments=qt,z.isArray=Pt,z.isBoolean=function(t){return!0===t||!1===t||Vt(t)&&ot(t)==b},z.isDate=Bt,z.isEmpty=function(t){return Ft(t)&&(Pt(t)||Wt(t)||Xt(t.splice)||qt(t))?!t.length:!B(t).length},z.isEqual=function(t,e){return ut(t,e)},z.isFinite=function(t){return"number"==typeof t&&F(t)},z.isFunction=Xt,z.isNaN=function(t){return Ht(t)&&t!=+t},z.isNull=function(t){return null===t},z.isNumber=Ht,z.isObject=zt,z.isRegExp=Gt,z.isString=Wt,z.isUndefined=function(t){return t===_},z.last=function(t){var e=null==t?0:t.length;return e?t[e-1]:_},z.max=function(t){return t&&t.length?K(t,re,st):_},z.min=function(t){return t&&t.length?K(t,re,lt):_},z.noConflict=function(){return f._===this&&(f._=U),this},z.noop=se,z.reduce=jt,z.result=function(t,e,n){return(e=null==t?_:t[e])===_&&(e=n),Xt(e)?e.call(t):e},z.size=function(t){return null==t?0:(t=Ft(t)?t:B(t)).length},z.some=function(t,e,n){return mt(t,ct(e=n?_:e))},z.uniqueId=function(t){var e=++R;return Jt(t)+e},z.each=Dt,z.first=Ct,oe(z,(ie={},rt(z,function(t,e){L.call(z.prototype,e)||(ie[e]=t)}),ie),{chain:!1}),z.VERSION="4.17.15",Q(["pop","join","replace","reverse","split","push","shift","sort","splice","unshift"],function(t){var n=(/^(?:replace|split)$/.test(t)?String.prototype:j)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|join|replace|shift)$/.test(t);z.prototype[t]=function(){var e=arguments;if(!i||this.__chain__)return this[r](function(t){return n.apply(Pt(t)?t:[],e)});var t=this.value();return n.apply(Pt(t)?t:[],e)}}),z.prototype.toJSON=z.prototype.valueOf=z.prototype.value=function(){return t=this.__wrapped__,jt(this.__actions__,function(t,e){return e.func.apply(e.thisArg,C([t],e.args))},t);var t},p&&((p.exports=z)._=z,h._=z)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],90:[function(t,e,n){e.exports=i;var e=t("inherits"),r=t("readable-stream");function i(t,e){var n=this;if(!(n instanceof i))return new i(t,e);r.Readable.call(n,e),n.destroyed=!1,n._drained=!1,n._forwarding=!1,n._current=null,n._toStreams2=e&&e.objectMode?o:s,"function"==typeof t?n._queue=t:(n._queue=t.map(n._toStreams2),n._queue.forEach(function(t){"function"!=typeof t&&n._attachErrorListener(t)})),n._next()}function o(t){return a(t,{objectMode:!0,highWaterMark:16})}function s(t){return a(t)}function a(t,e){if(!t||"function"==typeof t||t._readableState)return t;e=new r.Readable(e).wrap(t);return t.destroy&&(e.destroy=t.destroy.bind(t)),e}e(i,r.Readable),i.obj=function(t){return new i(t,{objectMode:!0,highWaterMark:16})},i.prototype._read=function(){this._drained=!0,this._forward()},i.prototype._forward=function(){if(!this._forwarding&&this._drained&&this._current){var t;for(this._forwarding=!0;null!==(t=this._current.read());)this._drained=this.push(t);this._forwarding=!1}},i.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._current&&this._current.destroy&&this._current.destroy(),"function"!=typeof this._queue&&this._queue.forEach(function(t){t.destroy&&t.destroy()}),t&&this.emit("error",t),this.emit("close"))},i.prototype._next=function(){var t,n=this;n._current=null,"function"==typeof n._queue?n._queue(function(t,e){return t?n.destroy(t):(e=n._toStreams2(e),n._attachErrorListener(e),void n._gotNextStream(e))}):("function"==typeof(t=n._queue.shift())&&(t=n._toStreams2(t()),n._attachErrorListener(t)),n._gotNextStream(t))},i.prototype._gotNextStream=function(e){var n=this;if(!e)return n.push(null),void n.destroy();function r(){n._forward()}function i(){e._readableState.ended||n.destroy()}n._current=e,n._forward(),e.on("readable",r),e.once("end",function t(){n._current=null;e.removeListener("readable",r);e.removeListener("end",t);e.removeListener("close",i);n._next()}),e.once("close",i)},i.prototype._attachErrorListener=function(n){var r=this;n&&n.once("error",function t(e){n.removeListener("error",t);r.destroy(e)})}},{inherits:85,"readable-stream":108}],91:[function(t,e,n){(function(a){"use strict";!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?e.exports={nextTick:function(t,e,n,r){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return a.nextTick(t);case 2:return a.nextTick(function(){t.call(null,e)});case 3:return a.nextTick(function(){t.call(null,e,n)});case 4:return a.nextTick(function(){t.call(null,e,n,r)});default:for(i=new Array(s-1),o=0;o<i.length;)i[o++]=arguments[o];return a.nextTick(function(){t.apply(null,i)})}}}:e.exports=a}).call(this,t("_process"))},{_process:92}],92:[function(t,e,n){var r,i,e=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&p())}function p(){if(!l){var t=a(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function y(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=y,e.addListener=y,e.once=y,e.off=y,e.removeListener=y,e.removeAllListeners=y,e.emit=y,e.prependListener=y,e.prependOnceListener=y,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],93:[function(t,e,n){"use strict";var i=t("asap/raw");function s(){}var o=null,a={};function u(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("Promise constructor's argument is not a function");this._40=0,this._65=0,this._55=null,this._72=null,t!==s&&p(t,this)}function c(t,e){for(;3===t._65;)t=t._55;if(u._37&&u._37(t),0===t._65)return 0===t._40?(t._40=1,void(t._72=e)):1===t._40?(t._40=2,void(t._72=[t._72,e])):void t._72.push(e);var n,r;n=t,r=e,i(function(){var t=1===n._65?r.onFulfilled:r.onRejected;null!==t?(t=function(t,e){try{return t(e)}catch(t){return o=t,a}}(t,n._55))===a?h(r.promise,o):l(r.promise,t):(1===n._65?l:h)(r.promise,n._55)})}function l(t,e){if(e===t)return h(t,new TypeError("A promise cannot be resolved with itself.")),0;if(e&&("object"==typeof e||"function"==typeof e)){var n=function(t){try{return t.then}catch(t){return o=t,a}}(e);if(n===a)return h(t,o),0;if(n===t.then&&e instanceof u)return t._65=3,t._55=e,void r(t);if("function"==typeof n)return void p(n.bind(e),t)}t._65=1,t._55=e,r(t)}function h(t,e){t._65=2,t._55=e,u._87&&u._87(t,e),r(t)}function r(t){if(1===t._40&&(c(t,t._72),t._72=null),2===t._40){for(var e=0;e<t._72.length;e++)c(t,t._72[e]);t._72=null}}function f(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function p(t,e){var n=!1,t=function(t,e,n){try{t(e,n)}catch(t){return o=t,a}}(t,function(t){n||(n=!0,l(e,t))},function(t){n||(n=!0,h(e,t))});n||t!==a||(n=!0,h(e,o))}(e.exports=u)._37=null,u._87=null,u._61=s,u.prototype.then=function(t,e){if(this.constructor!==u)return i=t,o=e,new(r=this).constructor(function(t,e){var n=new u(s);n.then(t,e),c(r,new f(i,o,n))});var r,i,o,n=new u(s);return c(this,new f(t,e,n)),n}},{"asap/raw":38}],94:[function(t,e,n){"use strict";var u=t("./core.js");e.exports=u;var r=l(!0),i=l(!1),o=l(null),s=l(void 0),a=l(0),c=l("");function l(t){var e=new u(u._61);return e._65=1,e._55=t,e}u.resolve=function(t){if(t instanceof u)return t;if(null===t)return o;if(void 0===t)return s;if(!0===t)return r;if(!1===t)return i;if(0===t)return a;if(""===t)return c;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new u(e.bind(t))}catch(n){return new u(function(t,e){e(n)})}return l(t)},u.all=function(t){var a=Array.prototype.slice.call(t);return new u(function(i,o){if(0===a.length)return i([]);var s=a.length;for(var t=0;t<a.length;t++)!function e(n,t){if(t&&("object"==typeof t||"function"==typeof t)){if(t instanceof u&&t.then===u.prototype.then){for(;3===t._65;)t=t._55;return 1===t._65?e(n,t._55):(2===t._65&&o(t._55),void t.then(function(t){e(n,t)},o))}var r=t.then;if("function"==typeof r)return void new u(r.bind(t)).then(function(t){e(n,t)},o)}a[n]=t,0==--s&&i(a)}(t,a[t])})},u.reject=function(n){return new u(function(t,e){e(n)})},u.race=function(t){return new u(function(e,n){t.forEach(function(t){u.resolve(t).then(e,n)})})},u.prototype.catch=function(t){return this.then(null,t)}},{"./core.js":93}],95:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e);e=1e3;r&&"number"==typeof r.maxKeys&&(e=r.maxKeys);var s=t.length;0<e&&e<s&&(s=e);for(var a=0;a<s;++a){var u,c=t[a].replace(o,"%20"),l=c.indexOf(n),h=0<=l?(u=c.substr(0,l),c.substr(l+1)):(u=c,""),f=decodeURIComponent(u),l=decodeURIComponent(h);c=i,h=f,Object.prototype.hasOwnProperty.call(c,h)?p(i[f])?i[f].push(l):i[f]=[i[f],l]:i[f]=l}return i};var p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],96:[function(t,e,n){"use strict";function o(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}e.exports=function(n,r,i,t){return r=r||"&",i=i||"=",null===n&&(n=void 0),"object"==typeof n?a(u(n),function(t){var e=encodeURIComponent(o(t))+i;return s(n[t])?a(n[t],function(t){return e+encodeURIComponent(o(t))}).join(r):e+encodeURIComponent(o(n[t]))}).join(r):t?encodeURIComponent(o(t))+i+encodeURIComponent(o(n)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var u=Object.keys||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}},{}],97:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":95,"./encode":96}],98:[function(t,e,n){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":99}],99:[function(t,e,n){"use strict";var r=t("process-nextick-args"),i=Object.keys||function(t){var e,n=[];for(e in t)n.push(e);return n};e.exports=l;e=t("core-util-is");e.inherits=t("inherits");var o=t("./_stream_readable"),s=t("./_stream_writable");e.inherits(l,o);for(var a=i(s.prototype),u=0;u<a.length;u++){var c=a[u];l.prototype[c]||(l.prototype[c]=s.prototype[c])}function l(t){if(!(this instanceof l))return new l(t);o.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),l.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},{"./_stream_readable":101,"./_stream_writable":103,"core-util-is":42,inherits:85,"process-nextick-args":91}],100:[function(t,e,n){"use strict";e.exports=i;var r=t("./_stream_transform"),e=t("core-util-is");function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}e.inherits=t("inherits"),e.inherits(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":102,"core-util-is":42,inherits:85}],101:[function(D,j,t){(function(_,t){"use strict";var g=D("process-nextick-args");j.exports=i;var o,b=D("isarray");i.ReadableState=r;function v(t,e){return t.listeners(e).length}D("events").EventEmitter;var n=D("./internal/streams/stream"),l=D("safe-buffer").Buffer,h=t.Uint8Array||function(){};var e=D("core-util-is");e.inherits=D("inherits");var s,t=D("util"),w=void 0,w=t&&t.debuglog?t.debuglog("stream"):function(){},a=D("./internal/streams/BufferList"),t=D("./internal/streams/destroy");e.inherits(i,n);var u=["error","close","destroy","pause","resume"];function r(t,e){t=t||{};var n=e instanceof(o=o||D("./_stream_duplex"));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,i=t.readableHighWaterMark,e=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(i||0===i)?i:e,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new a,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(s=s||D("string_decoder/").StringDecoder,this.decoder=new s(t.encoding),this.encoding=t.encoding)}function i(t){if(o=o||D("./_stream_duplex"),!(this instanceof i))return new i(t);this._readableState=new r(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),n.call(this)}function c(t,e,n,r,i){var o,s,a,u,c=t._readableState;return null===e?(c.reading=!1,s=t,(a=c).ended||(!a.decoder||(u=a.decoder.end())&&u.length&&(a.buffer.push(u),a.length+=a.objectMode?1:u.length),a.ended=!0,y(s))):(i||(o=function(t,e){var n;(function(t){return l.isBuffer(t)||t instanceof h})(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(c,e)),o?t.emit("error",o):c.objectMode||e&&0<e.length?("string"==typeof e||c.objectMode||Object.getPrototypeOf(e)===l.prototype||(o=e,e=l.from(o)),r?c.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):f(t,c,e,!0):c.ended?t.emit("error",new Error("stream.push() after EOF")):(c.reading=!1,c.decoder&&!n?(e=c.decoder.write(e),c.objectMode||0!==e.length?f(t,c,e,!1):E(t,c)):f(t,c,e,!1))):r||(c.reading=!1)),!(c=c).ended&&(c.needReadable||c.length<c.highWaterMark||0===c.length)}function f(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&y(t)),E(t,e)}Object.defineProperty(i.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),i.prototype.destroy=t.destroy,i.prototype._undestroy=t.undestroy,i.prototype._destroy=function(t,e){this.push(null),e(t)},i.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=l.from(t,e),e=""),n=!0),c(this,t,e,!1,n)},i.prototype.unshift=function(t){return c(this,t,null,!0,!1)},i.prototype.isPaused=function(){return!1===this._readableState.flowing},i.prototype.setEncoding=function(t){return s=s||D("string_decoder/").StringDecoder,this._readableState.decoder=new s(t),this._readableState.encoding=t,this};var p=8388608;function d(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?(e.flowing&&e.length?e.buffer.head.data:e).length:(t>e.highWaterMark&&(e.highWaterMark=(p<=(n=t)?n=p:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0));var n}function y(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(w("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?g.nextTick(m,t):m(t))}function m(t){w("emit readable"),t.emit("readable"),C(t)}function E(t,e){e.readingMore||(e.readingMore=!0,g.nextTick(T,t,e))}function T(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(w("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function x(t){w("readable nexttick read 0"),t.read(0)}function S(t,e){e.reading||(w("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),C(t),e.flowing&&!e.reading&&t.read(0)}function C(t){var e=t._readableState;for(w("flow",e.flowing);e.flowing&&null!==t.read(););}function I(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():(n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n).data=o.slice(s);break}++r}return e.length-=r,i}:function(t,e){var n=l.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0===(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r).data=o.slice(s);break}++i}return e.length-=i,n})(t,e);return r}(t,e.buffer,e.decoder),n);var n}function O(t){var e=t._readableState;if(0<e.length)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,g.nextTick(N,e,t))}function N(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function A(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}i.prototype.read=function(t){w("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return w("read: emitReadable",e.length,e.ended),(0===e.length&&e.ended?O:y)(this),null;if(0===(t=d(t,e))&&e.ended)return 0===e.length&&O(this),null;var r=e.needReadable;return w("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&w("length less than watermark",r=!0),e.ended||e.reading?w("reading or ended",r=!1):r&&(w("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=d(n,e))),null===(r=0<t?I(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&O(this)),null!==r&&this.emit("data",r),r},i.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},i.prototype.pipe=function(n,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=n;break;case 1:i.pipes=[i.pipes,n];break;default:i.pipes.push(n)}i.pipesCount+=1,w("pipe count=%d opts=%j",i.pipesCount,t);var e=(!t||!1!==t.end)&&n!==_.stdout&&n!==_.stderr?s:m;function o(t,e){w("onunpipe"),t===r&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,w("cleanup"),n.removeListener("close",d),n.removeListener("finish",y),n.removeListener("drain",u),n.removeListener("error",p),n.removeListener("unpipe",o),r.removeListener("end",s),r.removeListener("end",m),r.removeListener("data",f),c=!0,!i.awaitDrain||n._writableState&&!n._writableState.needDrain||u())}function s(){w("onend"),n.end()}i.endEmitted?g.nextTick(e):r.once("end",e),n.on("unpipe",o);var a,u=(a=r,function(){var t=a._readableState;w("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&v(a,"data")&&(t.flowing=!0,C(a))});n.on("drain",u);var c=!1;var l,h=!1;function f(t){w("ondata"),(h=!1)!==n.write(t)||h||((1===i.pipesCount&&i.pipes===n||1<i.pipesCount&&-1!==A(i.pipes,n))&&!c&&(w("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,h=!0),r.pause())}function p(t){w("onerror",t),m(),n.removeListener("error",p),0===v(n,"error")&&n.emit("error",t)}function d(){n.removeListener("finish",y),m()}function y(){w("onfinish"),n.removeListener("close",d),m()}function m(){w("unpipe"),r.unpipe(n)}return r.on("data",f),l="error",t=p,"function"==typeof(e=n).prependListener?e.prependListener(l,t):e._events&&e._events[l]?b(e._events[l])?e._events[l].unshift(t):e._events[l]=[t,e._events[l]]:e.on(l,t),n.once("close",d),n.once("finish",y),n.emit("pipe",r),i.flowing||(w("pipe resume"),r.resume()),n},i.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t=t||e.pipes,e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=A(e.pipes,t);return-1===s||(e.pipes.splice(s,1),--e.pipesCount,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},i.prototype.addListener=i.prototype.on=function(t,e){e=n.prototype.on.call(this,t,e);return"data"===t?!1!==this._readableState.flowing&&this.resume():"readable"===t&&((t=this._readableState).endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.emittedReadable=!1,t.reading?t.length&&y(this):g.nextTick(x,this))),e},i.prototype.resume=function(){var t,e=this._readableState;return e.flowing||(w("resume"),e.flowing=!0,t=this,(e=e).resumeScheduled||(e.resumeScheduled=!0,g.nextTick(S,t,e))),this},i.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(e){var t,n=this,r=this._readableState,i=!1;for(t in e.on("end",function(){var t;w("wrapped end"),!r.decoder||r.ended||(t=r.decoder.end())&&t.length&&n.push(t),n.push(null)}),e.on("data",function(t){w("wrapped data"),r.decoder&&(t=r.decoder.write(t)),r.objectMode&&null==t||(r.objectMode||t&&t.length)&&(n.push(t)||(i=!0,e.pause()))}),e)void 0===this[t]&&"function"==typeof e[t]&&(this[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t));for(var o=0;o<u.length;o++)e.on(u[o],this.emit.bind(this,u[o]));return this._read=function(t){w("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(i.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),i._fromList=I}).call(this,D("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":99,"./internal/streams/BufferList":104,"./internal/streams/destroy":105,"./internal/streams/stream":106,_process:92,"core-util-is":42,events:48,inherits:85,isarray:87,"process-nextick-args":91,"safe-buffer":111,"string_decoder/":114,util:40}],102:[function(t,e,n){"use strict";e.exports=i;var r=t("./_stream_duplex"),e=t("core-util-is");function i(t){if(!(this instanceof i))return new i(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=e&&this.push(e),r(t),(t=this._readableState).reading=!1,(t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",o)}function o(){var n=this;"function"==typeof this._flush?this._flush(function(t,e){s(n,t,e)}):s(this,null,null)}function s(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}e.inherits=t("inherits"),e.inherits(i,r),i.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},i.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},i.prototype._write=function(t,e,n){var r=this._transformState;r.writecb=n,r.writechunk=t,r.writeencoding=e,r.transforming||(e=this._readableState,(r.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark))},i.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},i.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},{"./_stream_duplex":99,"core-util-is":42,inherits:85}],103:[function(w,E,t){(function(t,e,n){"use strict";var f=w("process-nextick-args");function l(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}E.exports=c;var s,a=!t.browser&&-1<["v0.10","v0.9."].indexOf(t.version.slice(0,5))?n:f.nextTick;c.WritableState=u;n=w("core-util-is");n.inherits=w("inherits");var r={deprecate:w("util-deprecate")},i=w("./internal/streams/stream"),p=w("safe-buffer").Buffer,d=e.Uint8Array||function(){};var o,e=w("./internal/streams/destroy");function y(){}function u(t,o){s=s||w("./_stream_duplex"),t=t||{};var e=o instanceof s;this.objectMode=!!t.objectMode,e&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,r=t.writableHighWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:e&&(r||0===r)?r:i,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;i=(this.destroyed=!1)===t.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){var e,n,r,i;n=t,r=(e=o)._writableState,i=r.sync,t=r.writecb,function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),n?function(t,e,n,r,i){--e.pendingcb,n?(f.nextTick(i,r),f.nextTick(v,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),v(t,e))}(e,r,i,n,t):((n=g(r))||r.corked||r.bufferProcessing||!r.bufferedRequest||_(e,r),i?a(h,e,r,n,t):h(e,r,n,t))},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function c(t){if(s=s||w("./_stream_duplex"),!(o.call(c,this)||this instanceof s))return new c(t);this._writableState=new u(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),i.call(this)}function m(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function h(t,e,n,r){var i;n||(i=t,0===(n=e).length&&n.needDrain&&(n.needDrain=!1,i.emit("drain"))),e.pendingcb--,r(),v(t,e)}function _(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),r=e.corkedRequestsFree;r.entry=n;for(var o=0,s=!0;n;)(i[o]=n).isBuf||(s=!1),n=n.next,o+=1;i.allBuffers=s,m(t,e,!0,e.length,i,"",r.finish),e.pendingcb++,e.lastBufferedRequest=null,r.next?(e.corkedRequestsFree=r.next,r.next=null):e.corkedRequestsFree=new l(e),e.bufferedRequestCount=0}else{for(;n;){var a=n.chunk,u=n.encoding,c=n.callback;if(m(t,e,!1,e.objectMode?1:a.length,a,u,c),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function g(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function b(e,n){e._final(function(t){n.pendingcb--,t&&e.emit("error",t),n.prefinished=!0,e.emit("prefinish"),v(e,n)})}function v(t,e){var n,r,i=g(e);return i&&(n=t,(r=e).prefinished||r.finalCalled||("function"==typeof n._final?(r.pendingcb++,r.finalCalled=!0,f.nextTick(b,n,r)):(r.prefinished=!0,n.emit("prefinish"))),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}n.inherits(c,i),u.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(u.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(c,Symbol.hasInstance,{value:function(t){return!!o.call(this,t)||this===c&&(t&&t._writableState instanceof u)}})):o=function(t){return t instanceof this},c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},c.prototype.write=function(t,e,n){var r,i,o,s,a,u,c=this._writableState,l=!1,h=!c.objectMode&&(i=t,p.isBuffer(i)||i instanceof d);return h&&!p.isBuffer(t)&&(o=t,t=p.from(o)),"function"==typeof e&&(n=e,e=null),e=h?"buffer":e||c.defaultEncoding,"function"!=typeof n&&(n=y),c.ended?(s=this,a=n,u=new Error("write after end"),s.emit("error",u),f.nextTick(a,u)):(h||(r=this,i=c,o=n,a=!(s=!0),null===(u=t)?a=new TypeError("May not write null values to stream"):"string"==typeof u||void 0===u||i.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(r.emit("error",a),f.nextTick(o,a),s=!1),s))&&(c.pendingcb++,l=function(t,e,n,r,i,o){n||(u=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=p.from(e,n));return e}(e,r,i),r!==u&&(n=!0,i="buffer",r=u));var s=e.objectMode?1:r.length;e.length+=s;var a=e.length<e.highWaterMark;a||(e.needDrain=!0);{var u;e.writing||e.corked?(u=e.lastBufferedRequest,e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1):m(t,e,!1,s,r,i,o)}return a}(this,c,h,t,e,n)),l},c.prototype.cork=function(){this._writableState.corked++},c.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||_(this,t))},c.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),c.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},c.prototype._writev=null,c.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,e=t=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||(e=this,n=n,(r=r).ending=!0,v(e,r),n&&(r.finished?f.nextTick(n):e.once("finish",n)),r.ended=!0,e.writable=!1)},Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),c.prototype.destroy=e.destroy,c.prototype._undestroy=e.undestroy,c.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,w("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},w("timers").setImmediate)},{"./_stream_duplex":99,"./internal/streams/destroy":105,"./internal/streams/stream":106,_process:92,"core-util-is":42,inherits:85,"process-nextick-args":91,"safe-buffer":111,timers:115,"util-deprecate":116}],104:[function(t,e,n){"use strict";var a=t("safe-buffer").Buffer,r=t("util");function i(){!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.head=null,this.tail=null,this.length=0}e.exports=(i.prototype.push=function(t){t={data:t,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},i.prototype.unshift=function(t){t={data:t,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},i.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},i.prototype.clear=function(){this.head=this.tail=null,this.length=0},i.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},i.prototype.concat=function(t){if(0===this.length)return a.alloc(0);if(1===this.length)return this.head.data;for(var e,n,r,i=a.allocUnsafe(t>>>0),o=this.head,s=0;o;)e=o.data,n=i,r=s,e.copy(n,r),s+=o.data.length,o=o.next;return i},i),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var t=r.inspect({length:this.length});return this.constructor.name+" "+t})},{"safe-buffer":111,util:40}],105:[function(t,e,n){"use strict";var o=t("process-nextick-args");function s(t,e){t.emit("error",e)}e.exports={destroy:function(t,e){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?e?e(t):!t||this._writableState&&this._writableState.errorEmitted||o.nextTick(s,this,t):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(o.nextTick(s,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":91}],106:[function(t,e,n){e.exports=t("events").EventEmitter},{events:48}],107:[function(t,e,n){e.exports=t("./readable").PassThrough},{"./readable":108}],108:[function(t,e,n){(((n=e.exports=t("./lib/_stream_readable.js")).Stream=n).Readable=n).Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":99,"./lib/_stream_passthrough.js":100,"./lib/_stream_readable.js":101,"./lib/_stream_transform.js":102,"./lib/_stream_writable.js":103}],109:[function(t,e,n){e.exports=t("./readable").Transform},{"./readable":108}],110:[function(t,e,n){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":103}],111:[function(t,e,n){var r=t("buffer"),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,n),n.Buffer=s),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");t=i(t);return void 0!==e?"string"==typeof n?t.fill(e,n):t.fill(e):t.fill(0),t},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},{buffer:41}],112:[function(U,t,e){(function(n){!function(a){a.parser=function(t,e){return new i(t,e)},a.SAXParser=i,a.SAXStream=s,a.createStream=function(t,e){return new s(t,e)},a.MAX_BUFFER_LENGTH=65536;var r,u=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,e){if(!(this instanceof i))return new i(t,e);var n=this;!function(t){for(var e=0,n=u.length;e<n;e++)t[u[e]]=""}(n),n.q=n.c="",n.bufferCheckPosition=a.MAX_BUFFER_LENGTH,n.opt=e||{},n.opt.lowercase=n.opt.lowercase||n.opt.lowercasetags,n.looseCase=n.opt.lowercase?"toLowerCase":"toUpperCase",n.tags=[],n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.strict=!!t,n.noscript=!(!t&&!n.opt.noscript),n.state=T.BEGIN,n.strictEntities=n.opt.strictEntities,n.ENTITIES=n.strictEntities?Object.create(a.XML_ENTITIES):Object.create(a.ENTITIES),n.attribList=[],n.opt.xmlns&&(n.ns=Object.create(p)),n.trackPosition=!1!==n.opt.position,n.trackPosition&&(n.position=n.line=n.column=0),x(n,"onready")}a.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e);return n}),i.prototype={end:function(){N(this)},write:function(t){var e=this;if(this.error)throw this.error;if(e.closed)return O(e,"Cannot write after close. Assign an onready handler.");if(null===t)return N(e);"object"==typeof t&&(t=t.toString());var n,r,i=0,o="";for(;o=M(t,i++),e.c=o;)switch(e.trackPosition&&(e.position++,"\n"===o?(e.line++,e.column=0):e.column++),e.state){case T.BEGIN:if(e.state=T.BEGIN_WHITESPACE,"\ufeff"===o)continue;R(e,o);continue;case T.BEGIN_WHITESPACE:R(e,o);continue;case T.TEXT:if(e.sawRoot&&!e.closedRoot){for(var s=i-1;o&&"<"!==o&&"&"!==o;)(o=M(t,i++))&&e.trackPosition&&(e.position++,"\n"===o?(e.line++,e.column=0):e.column++);e.textNode+=t.substring(s,i-1)}"<"!==o||e.sawRoot&&e.closedRoot&&!e.strict?(g(o)||e.sawRoot&&!e.closedRoot||A(e,"Text data outside of root node."),"&"===o?e.state=T.TEXT_ENTITY:e.textNode+=o):(e.state=T.OPEN_WAKA,e.startTagPosition=e.position);continue;case T.SCRIPT:"<"===o?e.state=T.SCRIPT_ENDING:e.script+=o;continue;case T.SCRIPT_ENDING:"/"===o?e.state=T.CLOSE_TAG:(e.script+="<"+o,e.state=T.SCRIPT);continue;case T.OPEN_WAKA:"!"===o?(e.state=T.SGML_DECL,e.sgmlDecl=""):g(o)||(v(d,o)?(e.state=T.OPEN_TAG,e.tagName=o):"/"===o?(e.state=T.CLOSE_TAG,e.tagName=""):"?"===o?(e.state=T.PROC_INST,e.procInstName=e.procInstBody=""):(A(e,"Unencoded <"),e.startTagPosition+1<e.position&&(s=e.position-e.startTagPosition,o=new Array(s).join(" ")+o),e.textNode+="<"+o,e.state=T.TEXT));continue;case T.SGML_DECL:(e.sgmlDecl+o).toUpperCase()===c?(S(e,"onopencdata"),e.state=T.CDATA,e.sgmlDecl="",e.cdata=""):e.sgmlDecl+o==="--"?(e.state=T.COMMENT,e.comment="",e.sgmlDecl=""):(e.sgmlDecl+o).toUpperCase()===l?(e.state=T.DOCTYPE,(e.doctype||e.sawRoot)&&A(e,"Inappropriately located doctype declaration"),e.doctype="",e.sgmlDecl=""):">"===o?(S(e,"onsgmldeclaration",e.sgmlDecl),e.sgmlDecl="",e.state=T.TEXT):(b(o)&&(e.state=T.SGML_DECL_QUOTED),e.sgmlDecl+=o);continue;case T.SGML_DECL_QUOTED:o===e.q&&(e.state=T.SGML_DECL,e.q=""),e.sgmlDecl+=o;continue;case T.DOCTYPE:">"===o?(e.state=T.TEXT,S(e,"ondoctype",e.doctype),e.doctype=!0):(e.doctype+=o,"["===o?e.state=T.DOCTYPE_DTD:b(o)&&(e.state=T.DOCTYPE_QUOTED,e.q=o));continue;case T.DOCTYPE_QUOTED:e.doctype+=o,o===e.q&&(e.q="",e.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:e.doctype+=o,"]"===o?e.state=T.DOCTYPE:b(o)&&(e.state=T.DOCTYPE_DTD_QUOTED,e.q=o);continue;case T.DOCTYPE_DTD_QUOTED:e.doctype+=o,o===e.q&&(e.state=T.DOCTYPE_DTD,e.q="");continue;case T.COMMENT:"-"===o?e.state=T.COMMENT_ENDING:e.comment+=o;continue;case T.COMMENT_ENDING:"-"===o?(e.state=T.COMMENT_ENDED,e.comment=I(e.opt,e.comment),e.comment&&S(e,"oncomment",e.comment),e.comment=""):(e.comment+="-"+o,e.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==o?(A(e,"Malformed comment"),e.comment+="--"+o,e.state=T.COMMENT):e.state=T.TEXT;continue;case T.CDATA:"]"===o?e.state=T.CDATA_ENDING:e.cdata+=o;continue;case T.CDATA_ENDING:"]"===o?e.state=T.CDATA_ENDING_2:(e.cdata+="]"+o,e.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===o?(e.cdata&&S(e,"oncdata",e.cdata),S(e,"onclosecdata"),e.cdata="",e.state=T.TEXT):"]"===o?e.cdata+="]":(e.cdata+="]]"+o,e.state=T.CDATA);continue;case T.PROC_INST:"?"===o?e.state=T.PROC_INST_ENDING:g(o)?e.state=T.PROC_INST_BODY:e.procInstName+=o;continue;case T.PROC_INST_BODY:if(!e.procInstBody&&g(o))continue;"?"===o?e.state=T.PROC_INST_ENDING:e.procInstBody+=o;continue;case T.PROC_INST_ENDING:">"===o?(S(e,"onprocessinginstruction",{name:e.procInstName,body:e.procInstBody}),e.procInstName=e.procInstBody="",e.state=T.TEXT):(e.procInstBody+="?"+o,e.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:v(y,o)?e.tagName+=o:(function(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,n=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(n.ns=e.ns),t.attribList.length=0,S(t,"onopentagstart",n)}(e),">"===o?k(e):"/"===o?e.state=T.OPEN_TAG_SLASH:(g(o)||A(e,"Invalid character in tag name"),e.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===o?(k(e,!0),L(e)):(A(e,"Forward-slash in opening tag not followed by >"),e.state=T.ATTRIB);continue;case T.ATTRIB:if(g(o))continue;">"===o?k(e):"/"===o?e.state=T.OPEN_TAG_SLASH:v(d,o)?(e.attribName=o,e.attribValue="",e.state=T.ATTRIB_NAME):A(e,"Invalid attribute name");continue;case T.ATTRIB_NAME:"="===o?e.state=T.ATTRIB_VALUE:">"===o?(A(e,"Attribute without value"),e.attribValue=e.attribName,j(e),k(e)):g(o)?e.state=T.ATTRIB_NAME_SAW_WHITE:v(y,o)?e.attribName+=o:A(e,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:if("="===o)e.state=T.ATTRIB_VALUE;else{if(g(o))continue;A(e,"Attribute without value"),e.tag.attributes[e.attribName]="",e.attribValue="",S(e,"onattribute",{name:e.attribName,value:""}),e.attribName="",">"===o?k(e):v(d,o)?(e.attribName=o,e.state=T.ATTRIB_NAME):(A(e,"Invalid attribute name"),e.state=T.ATTRIB)}continue;case T.ATTRIB_VALUE:if(g(o))continue;b(o)?(e.q=o,e.state=T.ATTRIB_VALUE_QUOTED):(A(e,"Unquoted attribute value"),e.state=T.ATTRIB_VALUE_UNQUOTED,e.attribValue=o);continue;case T.ATTRIB_VALUE_QUOTED:if(o!==e.q){"&"===o?e.state=T.ATTRIB_VALUE_ENTITY_Q:e.attribValue+=o;continue}j(e),e.q="",e.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:g(o)?e.state=T.ATTRIB:">"===o?k(e):"/"===o?e.state=T.OPEN_TAG_SLASH:v(d,o)?(A(e,"No whitespace between attributes"),e.attribName=o,e.attribValue="",e.state=T.ATTRIB_NAME):A(e,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!function(t){return">"===t||g(t)}(o)){"&"===o?e.state=T.ATTRIB_VALUE_ENTITY_U:e.attribValue+=o;continue}j(e),">"===o?k(e):e.state=T.ATTRIB;continue;case T.CLOSE_TAG:if(e.tagName)">"===o?L(e):v(y,o)?e.tagName+=o:e.script?(e.script+="</"+e.tagName,e.tagName="",e.state=T.SCRIPT):(g(o)||A(e,"Invalid tagname in closing tag"),e.state=T.CLOSE_TAG_SAW_WHITE);else{if(g(o))continue;!function(t,e){return!v(t,e)}(d,o)?e.tagName=o:e.script?(e.script+="</"+o,e.state=T.SCRIPT):A(e,"Invalid tagname in closing tag.")}continue;case T.CLOSE_TAG_SAW_WHITE:if(g(o))continue;">"===o?L(e):A(e,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:switch(e.state){case T.TEXT_ENTITY:n=T.TEXT,r="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:n=T.ATTRIB_VALUE_QUOTED,r="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:n=T.ATTRIB_VALUE_UNQUOTED,r="attribValue"}";"===o?(e[r]+=function(t){var e,n=t.entity,r=n.toLowerCase(),i="";if(t.ENTITIES[n])return t.ENTITIES[n];if(t.ENTITIES[r])return t.ENTITIES[r];"#"===(n=r).charAt(0)&&(i="x"===n.charAt(1)?(n=n.slice(2),(e=parseInt(n,16)).toString(16)):(n=n.slice(1),(e=parseInt(n,10)).toString(10)));if(n=n.replace(/^0+/,""),isNaN(e)||i.toLowerCase()!==n)return A(t,"Invalid character entity"),"&"+t.entity+";";return String.fromCodePoint(e)}(e),e.entity="",e.state=n):v(e.entity.length?_:m,o)?e.entity+=o:(A(e,"Invalid character in entity name"),e[r]+="&"+e.entity+o,e.entity="",e.state=n);continue;default:throw new Error(e,"Unknown state: "+e.state)}e.position>=e.bufferCheckPosition&&function(t){for(var e=Math.max(a.MAX_BUFFER_LENGTH,10),n=0,r=0,i=u.length;r<i;r++){var o=t[u[r]].length;if(e<o)switch(u[r]){case"textNode":C(t);break;case"cdata":S(t,"oncdata",t.cdata),t.cdata="";break;case"script":S(t,"onscript",t.script),t.script="";break;default:O(t,"Max buffer length exceeded: "+u[r])}n=Math.max(n,o)}var s=a.MAX_BUFFER_LENGTH-n;t.bufferCheckPosition=s+t.position}(e);return e},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;C(t=this),""!==t.cdata&&(S(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(S(t,"onscript",t.script),t.script="")}};try{r=U("stream").Stream}catch(t){r=function(){}}var o=a.EVENTS.filter(function(t){return"error"!==t&&"end"!==t});function s(t,e){if(!(this instanceof s))return new s(t,e);r.apply(this),this._parser=new i(t,e),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(t){n.emit("error",t),n._parser.error=null},this._decoder=null,o.forEach(function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t;n.on(e,t)},enumerable:!0,configurable:!1})})}(s.prototype=Object.create(r.prototype,{constructor:{value:s}})).write=function(t){var e;return"function"==typeof n&&"function"==typeof n.isBuffer&&n.isBuffer(t)&&(this._decoder||(e=U("string_decoder").StringDecoder,this._decoder=new e("utf8")),t=this._decoder.write(t)),this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===o.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),r.prototype.on.call(n,e,t)};var c="[CDATA[",l="DOCTYPE",h="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/2000/xmlns/",p={xml:h,xmlns:f},d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function b(t){return'"'===t||"'"===t}function v(t,e){return t.test(e)}var t,w,E,T=0;for(t in a.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},a.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},a.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(a.ENTITIES).forEach(function(t){var e=a.ENTITIES[t],e="number"==typeof e?String.fromCharCode(e):e;a.ENTITIES[t]=e}),a.STATE)a.STATE[a.STATE[t]]=t;function x(t,e,n){t[e]&&t[e](n)}function S(t,e,n){t.textNode&&C(t),x(t,e,n)}function C(t){t.textNode=I(t.opt,t.textNode),t.textNode&&x(t,"ontext",t.textNode),t.textNode=""}function I(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function O(t,e){return C(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,x(t,"onerror",e),t}function N(t){return t.sawRoot&&!t.closedRoot&&A(t,"Unclosed root tag"),t.state!==T.BEGIN&&t.state!==T.BEGIN_WHITESPACE&&t.state!==T.TEXT&&O(t,"Unexpected end"),C(t),t.c="",t.closed=!0,x(t,"onend"),i.call(t,t.strict,t.opt),t}function A(t,e){if("object"!=typeof t||!(t instanceof i))throw new Error("bad call to strictFail");t.strict&&O(t,e)}function D(t,e){var n=t.indexOf(":")<0?["",t]:t.split(":"),r=n[0],n=n[1];return e&&"xmlns"===t&&(r="xmlns",n=""),{prefix:r,local:n}}function j(t){var e,n,r;t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName)||(t.opt.xmlns?(r=(n=D(t.attribName,!0)).prefix,e=n.local,"xmlns"===r&&("xml"===e&&t.attribValue!==h?A(t,"xml: prefix must be bound to "+h+"\nActual: "+t.attribValue):"xmlns"===e&&t.attribValue!==f?A(t,"xmlns: prefix must be bound to "+f+"\nActual: "+t.attribValue):(n=t.tag,r=t.tags[t.tags.length-1]||t,n.ns===r.ns&&(n.ns=Object.create(r.ns)),n.ns[e]=t.attribValue)),t.attribList.push([t.attribName,t.attribValue])):(t.tag.attributes[t.attribName]=t.attribValue,S(t,"onattribute",{name:t.attribName,value:t.attribValue}))),t.attribName=t.attribValue=""}function k(e,t){if(e.opt.xmlns){var n=e.tag,r=D(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(A(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);r=e.tags[e.tags.length-1]||e;n.ns&&r.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){S(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var i=0,o=e.attribList.length;i<o;i++){var s=e.attribList[i],a=s[0],u=s[1],c=D(a,!0),l=c.prefix,s=c.local,c=""!==l&&n.ns[l]||"",s={name:a,value:u,prefix:l,local:s,uri:c};l&&"xmlns"!==l&&!c&&(A(e,"Unbound namespace prefix: "+JSON.stringify(l)),s.uri=l),e.tag.attributes[a]=s,S(e,"onattribute",s)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),S(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=T.TEXT:e.state=T.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function L(n){if(!n.tagName)return A(n,"Weird empty close tag."),n.textNode+="</>",void(n.state=T.TEXT);if(n.script){if("script"!==n.tagName)return n.script+="</"+n.tagName+">",n.tagName="",void(n.state=T.SCRIPT);S(n,"onscript",n.script),n.script=""}var t=n.tags.length,e=n.tagName;n.strict||(e=e[n.looseCase]());for(var r=e;t--;){if(n.tags[t].name===r)break;A(n,"Unexpected close tag")}if(t<0)return A(n,"Unmatched closing tag: "+n.tagName),n.textNode+="</"+n.tagName+">",void(n.state=T.TEXT);n.tagName=e;for(var i=n.tags.length;i-- >t;){var o=n.tag=n.tags.pop();n.tagName=n.tag.name,S(n,"onclosetag",n.tagName);var s,a={};for(s in o.ns)a[s]=o.ns[s];var u=n.tags[n.tags.length-1]||n;n.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach(function(t){var e=o.ns[t];S(n,"onclosenamespace",{prefix:t,uri:e})})}0===t&&(n.closedRoot=!0),n.tagName=n.attribValue=n.attribName="",n.attribList.length=0,n.state=T.TEXT}function R(t,e){"<"===e?(t.state=T.OPEN_WAKA,t.startTagPosition=t.position):g(e)||(A(t,"Non-whitespace before first tag."),t.textNode=e,t.state=T.TEXT)}function M(t,e){var n="";return e<t.length&&(n=t.charAt(e)),n}function e(){var t,e=[],n=-1,r=arguments.length;if(!r)return"";for(var i="";++n<r;){var o=Number(arguments[n]);if(!isFinite(o)||o<0||1114111<o||E(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?e.push(o):(t=55296+((o-=65536)>>10),o=o%1024+56320,e.push(t,o)),(n+1===r||16384<e.length)&&(i+=w.apply(null,e),e.length=0)}return i}T=a.STATE,String.fromCodePoint||(w=String.fromCharCode,E=Math.floor,Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:e,configurable:!0,writable:!0}):String.fromCodePoint=e)}(void 0===e?this.sax={}:e)}).call(this,U("buffer").Buffer)},{buffer:41,stream:113,string_decoder:114}],113:[function(t,e,n){e.exports=r;var l=t("events").EventEmitter;function r(){l.call(this)}t("inherits")(r,l),r.Readable=t("readable-stream/readable.js"),r.Writable=t("readable-stream/writable.js"),r.Duplex=t("readable-stream/duplex.js"),r.Transform=t("readable-stream/transform.js"),r.PassThrough=t("readable-stream/passthrough.js"),(r.Stream=r).prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",a));var o=!1;function s(){o||(o=!0,e.end())}function a(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(t){if(c(),0===l.listenerCount(this,"error"))throw t}function c(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",s),n.removeListener("close",a),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},{events:48,inherits:85,"readable-stream/duplex.js":98,"readable-stream/passthrough.js":107,"readable-stream/readable.js":108,"readable-stream/transform.js":109,"readable-stream/writable.js":110}],114:[function(t,e,n){"use strict";var r=t("safe-buffer").Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}function s(t){var e;switch(this.encoding=o(t),this.encoding){case"utf16le":this.text=c,this.end=l,e=4;break;case"utf8":this.fillLast=u,e=4;break;case"base64":this.text=h,this.end=f,e=3;break;default:return this.write=p,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function u(t){var e,n,r=this.lastTotal-this.lastNeed,e=(e=this,128!=(192&(n=t)[0])?(e.lastNeed=0,""):1<e.lastNeed&&1<n.length?128!=(192&n[1])?(e.lastNeed=1,""):2<e.lastNeed&&2<n.length&&128!=(192&n[2])?(e.lastNeed=2,""):void 0:void 0);return void 0!==e?e:this.lastNeed<=t.length?(t.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,r,0,t.length),void(this.lastNeed-=t.length))}function c(t,e){if((t.length-e)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1);var n=t.toString("utf16le",e);if(n){e=n.charCodeAt(n.length-1);if(55296<=e&&e<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}function l(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function h(t,e){var n=(t.length-e)%3;return 0==n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){t=t&&t.length?this.write(t):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}(n.StringDecoder=s).prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},s.prototype.end=function(t){t=t&&t.length?this.write(t):"";return this.lastNeed?t+"":t},s.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=a(e[r]);if(0<=i)return 0<i&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(0<=(i=a(e[r])))return 0<i&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(0<=(i=a(e[r])))return 0<i&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;n=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},s.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},{"safe-buffer":111}],115:[function(u,t,c){(function(t,e){var r=u("process/browser.js").nextTick,n=Function.prototype.apply,i=Array.prototype.slice,o={},s=0;function a(t,e){this._id=t,this._clearFn=e}c.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},c.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},c._unrefActive=c.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},c.setImmediate="function"==typeof t?t:function(t){var e=s++,n=!(arguments.length<2)&&i.call(arguments,1);return o[e]=!0,r(function(){o[e]&&(n?t.apply(null,n):t.call(null),c.clearImmediate(e))}),e},c.clearImmediate="function"==typeof e?e:function(t){delete o[t]}}).call(this,u("timers").setImmediate,u("timers").clearImmediate)},{"process/browser.js":92,timers:115}],116:[function(t,n,e){(function(e){function r(t){try{if(!e.localStorage)return}catch(t){return}t=e.localStorage[t];return null!=t&&"true"===String(t).toLowerCase()}n.exports=function(t,e){if(r("noDeprecation"))return t;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],117:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],118:[function(C,t,I){(function(r,i){var a=/%[sdj%]/g;I.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,i=r.length,o=String(t).replace(a,function(t){if("%%"===t)return"%";if(i<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<i;s=r[++n])y(s)||!v(s)?o+=" "+s:o+=" "+u(s);return o},I.deprecate=function(t,e){if(g(i.process))return function(){return I.deprecate(t,e).apply(this,arguments)};if(!0===r.noDeprecation)return t;var n=!1;return function(){if(!n){if(r.throwDeprecation)throw new Error(e);r.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}};var t,o={};function u(t,e){var n={seen:[],stylize:c};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),d(e)?n.showHidden=e:e&&I._extend(n,e),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),l(n,t,n.depth)}function s(t,e){e=u.styles[e];return e?"["+u.colors[e][0]+"m"+t+"["+u.colors[e][1]+"m":t}function c(t,e){return t}function l(e,n,r){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==I.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(r,e);return _(t)||(t=l(e,t,r)),t}var i=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(y(e))return t.stylize("null","null")}(e,n);if(i)return i;var o,t=Object.keys(n),s=(o={},t.forEach(function(t,e){o[t]=!0}),o);if(e.showHidden&&(t=Object.getOwnPropertyNames(n)),E(n)&&(0<=t.indexOf("message")||0<=t.indexOf("description")))return h(n);if(0===t.length){if(T(n)){var a=n.name?": "+n.name:"";return e.stylize("[Function"+a+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(E(n))return h(n)}var i="",u=!1,a=["{","}"];return p(n)&&(u=!0,a=["[","]"]),T(n)&&(i=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(i=" "+RegExp.prototype.toString.call(n)),w(n)&&(i=" "+Date.prototype.toUTCString.call(n)),E(n)&&(i=" "+h(n)),0!==t.length||u&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),t=u?function(e,n,r,i,t){for(var o=[],s=0,a=n.length;s<a;++s)S(n,String(s))?o.push(f(e,n,r,i,String(s),!0)):o.push("");return t.forEach(function(t){t.match(/^\d+$/)||o.push(f(e,n,r,i,t,!0))}),o}(e,n,r,s,t):t.map(function(t){return f(e,n,r,s,t,u)}),e.seen.pop(),function(t,e,n){if(60<t.reduce(function(t,e){return 0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(t,i,a)):a[0]+i+a[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i,o){var s,a,e=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]};if(e.get?a=e.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):e.set&&(a=t.stylize("[Setter]","special")),S(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(e.value)<0?-1<(a=y(n)?l(t,e.value,null):l(t,e.value,n-1)).indexOf("\n")&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),g(s)){if(o&&i.match(/^\d+$/))return a;s=(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(s,"string"))}return s+": "+a}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return"number"==typeof t}function _(t){return"string"==typeof t}function g(t){return void 0===t}function b(t){return v(t)&&"[object RegExp]"===e(t)}function v(t){return"object"==typeof t&&null!==t}function w(t){return v(t)&&"[object Date]"===e(t)}function E(t){return v(t)&&("[object Error]"===e(t)||t instanceof Error)}function T(t){return"function"==typeof t}function e(t){return Object.prototype.toString.call(t)}function n(t){return t<10?"0"+t.toString(10):t.toString(10)}I.debuglog=function(e){var n;return g(t)&&(t=r.env.NODE_DEBUG||""),e=e.toUpperCase(),o[e]||(new RegExp("\\b"+e+"\\b","i").test(t)?(n=r.pid,o[e]=function(){var t=I.format.apply(I,arguments);console.error("%s %d: %s",e,n,t)}):o[e]=function(){}),o[e]},(I.inspect=u).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},I.isArray=p,I.isBoolean=d,I.isNull=y,I.isNullOrUndefined=function(t){return null==t},I.isNumber=m,I.isString=_,I.isSymbol=function(t){return"symbol"==typeof t},I.isUndefined=g,I.isRegExp=b,I.isObject=v,I.isDate=w,I.isError=E,I.isFunction=T,I.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},I.isBuffer=C("./support/isBuffer");var x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}I.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[n(t.getHours()),n(t.getMinutes()),n(t.getSeconds())].join(":"),[t.getDate(),x[t.getMonth()],e].join(" ")),I.format.apply(I,arguments))},I.inherits=C("inherits"),I._extend=function(t,e){if(!e||!v(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,C("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":117,_process:92,inherits:85}],119:[function(t,e,n){(function(){"use strict";n.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},{}],120:[function(r,t,o){(function(){"use strict";var n,i,e,f,p,d={}.hasOwnProperty;function t(t){var e,n,r;for(e in this.options={},n=i[.2])d.call(n,e)&&(r=n[e],this.options[e]=r);for(e in t)d.call(t,e)&&(r=t[e],this.options[e]=r)}n=r("xmlbuilder"),i=r("./defaults").defaults,f=function(t){return"string"==typeof t&&(0<=t.indexOf("&")||0<=t.indexOf(">")||0<=t.indexOf("<"))},p=function(t){return"<![CDATA["+e(t)+"]]>"},e=function(t){return t.replace("]]>","]]]]><![CDATA[>")},o.Builder=(t.prototype.buildObject=function(t){var u,e,c,l=this.options.attrkey,h=this.options.charkey;return 1===Object.keys(t).length&&this.options.rootName===i[.2].rootName?t=t[e=Object.keys(t)[0]]:e=this.options.rootName,c=this,u=function(t,e){var n,r,i,o,s,a;if("object"!=typeof e)c.options.cdata&&f(e)?t.raw(p(e)):t.txt(e);else if(Array.isArray(e)){for(o in e)if(d.call(e,o))for(s in r=e[o])i=r[s],t=u(t.ele(s),i).up()}else for(s in e)if(d.call(e,s))if(r=e[s],s===l){if("object"==typeof r)for(n in r)a=r[n],t=t.att(n,a)}else if(s===h)t=c.options.cdata&&f(r)?t.raw(p(r)):t.txt(r);else if(Array.isArray(r))for(o in r)d.call(r,o)&&(t=("string"==typeof(i=r[o])?c.options.cdata&&f(i)?t.ele(s).raw(p(i)):t.ele(s,i):u(t.ele(s),i)).up());else t="object"==typeof r?u(t.ele(s),r).up():"string"==typeof r&&c.options.cdata&&f(r)?t.ele(s).raw(p(r)).up():(null==r&&(r=""),t.ele(s,r.toString()).up());return t},e=n.create(e,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),u(e,t).end(this.options.renderOpts)},t)}).call(this)},{"./defaults":121,xmlbuilder:146}],121:[function(t,e,n){(function(){n.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},{}],122:[function(n,t,c){(function(){"use strict";function i(t,e){return function(){return t.apply(e,arguments)}}var r,o,t,f,p,s,u,a,d={}.hasOwnProperty;function e(t){var e,n,r;if(this.parseString=i(this.parseString,this),this.reset=i(this.reset,this),this.assignOrPush=i(this.assignOrPush,this),this.processAsync=i(this.processAsync,this),!(this instanceof c.Parser))return new c.Parser(t);for(e in this.options={},n=o[.2])d.call(n,e)&&(r=n[e],this.options[e]=r);for(e in t)d.call(t,e)&&(r=t[e],this.options[e]=r);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(s.normalize)),this.reset()}u=n("sax"),t=n("events"),r=n("./bom"),s=n("./processors"),a=n("timers").setImmediate,o=n("./defaults").defaults,f=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},p=function(t,e,n){for(var r=0,i=t.length;r<i;r++)e=(0,t[r])(e,n);return e},c.Parser=(function(t,e){for(var n in e)d.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t.EventEmitter),e.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),a(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},e.prototype.assignOrPush=function(t,e,n){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(n)):this.options.explicitArray?t[e]=[n]:t[e]=n},e.prototype.reset=function(){var s,c,e,l,n,t,a,h,r;return this.removeAllListeners(),this.saxParser=u.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(n=this,function(t){if(n.saxParser.resume(),!n.saxParser.errThrown)return n.saxParser.errThrown=!0,n.emit("error",t)}),this.saxParser.onend=(t=this,function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,l=[],s=this.options.attrkey,c=this.options.charkey,this.saxParser.onopentag=(a=this,function(t){var e,n,r,i,o={};if(o[c]="",!a.options.ignoreAttrs)for(e in i=t.attributes)d.call(i,e)&&(s in o||a.options.mergeAttrs||(o[s]={}),n=a.options.attrValueProcessors?p(a.options.attrValueProcessors,t.attributes[e],e):t.attributes[e],r=a.options.attrNameProcessors?p(a.options.attrNameProcessors,e):e,a.options.mergeAttrs?a.assignOrPush(o,r,n):o[s][r]=n);return o["#name"]=a.options.tagNameProcessors?p(a.options.tagNameProcessors,t.name):t.name,a.options.xmlns&&(o[a.options.xmlnskey]={uri:t.uri,local:t.local}),l.push(o)}),this.saxParser.onclosetag=(h=this,function(){var t,e,r,n,i,o,s,a=l.pop(),u=a["#name"];if(h.options.explicitChildren&&h.options.preserveChildrenOrder||delete a["#name"],!0===a.cdata&&(t=a.cdata,delete a.cdata),o=l[l.length-1],a[c].match(/^\s*$/)&&!t?(i=a[c],delete a[c]):(h.options.trim&&(a[c]=a[c].trim()),h.options.normalize&&(a[c]=a[c].replace(/\s{2,}/g," ").trim()),a[c]=h.options.valueProcessors?p(h.options.valueProcessors,a[c],u):a[c],1===Object.keys(a).length&&c in a&&!h.EXPLICIT_CHARKEY&&(a=a[c])),f(a)&&(a=""!==h.options.emptyTag?h.options.emptyTag:i),null!=h.options.validator&&(s="/"+function(){for(var t=[],e=0,n=l.length;e<n;e++)r=l[e],t.push(r["#name"]);return t}().concat(u).join("/"),function(){try{a=h.options.validator(s,o&&o[u],a)}catch(t){return h.emit("error",t)}}()),h.options.explicitChildren&&!h.options.mergeAttrs&&"object"==typeof a)if(h.options.preserveChildrenOrder){if(o){for(e in o[h.options.childkey]=o[h.options.childkey]||[],n={},a)d.call(a,e)&&(n[e]=a[e]);o[h.options.childkey].push(n),delete a["#name"],1===Object.keys(a).length&&c in a&&!h.EXPLICIT_CHARKEY&&(a=a[c])}}else r={},h.options.attrkey in a&&(r[h.options.attrkey]=a[h.options.attrkey],delete a[h.options.attrkey]),!h.options.charsAsChildren&&h.options.charkey in a&&(r[h.options.charkey]=a[h.options.charkey],delete a[h.options.charkey]),0<Object.getOwnPropertyNames(a).length&&(r[h.options.childkey]=a),a=r;return 0<l.length?h.assignOrPush(o,u,a):(h.options.explicitRoot&&(i=a,(a={})[u]=i),h.resultObject=a,h.saxParser.ended=!0,h.emit("end",h.resultObject))}),e=function(t){var e,n=l[l.length-1];if(n)return n[c]+=t,r.options.explicitChildren&&r.options.preserveChildrenOrder&&r.options.charsAsChildren&&(r.options.includeWhiteChars||""!==t.replace(/\\n/g,"").trim())&&(n[r.options.childkey]=n[r.options.childkey]||[],(e={"#name":"__text__"})[c]=t,r.options.normalize&&(e[c]=e[c].replace(/\s{2,}/g," ").trim()),n[r.options.childkey].push(e)),n},(r=this).saxParser.ontext=e,this.saxParser.oncdata=function(t){t=e(t);if(t)return t.cdata=!0}},e.prototype.parseString=function(t,e){var n;null!=e&&"function"==typeof e&&(this.on("end",function(t){return this.reset(),e(null,t)}),this.on("error",function(t){return this.reset(),e(t)}));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=r.stripBOM(t),this.options.async?(this.remaining=t,a(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(t){if(n=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",n),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw n}},e),c.parseString=function(t,e,n){var r,i;return null!=n?("function"==typeof n&&(r=n),"object"==typeof e&&(i=e)):("function"==typeof e&&(r=e),i={}),new c.Parser(i).parseString(t,r)}}).call(this)},{"./bom":119,"./defaults":121,"./processors":123,events:48,sax:112,timers:115}],123:[function(t,e,n){(function(){"use strict";var e=new RegExp(/(?!xmlns)^.*:/);n.normalize=function(t){return t.toLowerCase()},n.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},n.stripPrefix=function(t){return t.replace(e,"")},n.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},n.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},{}],124:[function(s,t,a){(function(){"use strict";var t,e,n,r,i={}.hasOwnProperty;function o(t){this.message=t}e=s("./defaults"),t=s("./builder"),n=s("./parser"),r=s("./processors"),a.defaults=e.defaults,a.processors=r,a.ValidationError=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(o,Error),o),a.Builder=t.Builder,a.Parser=n.Parser,a.parseString=n.parseString}).call(this)},{"./builder":120,"./defaults":121,"./parser":122,"./processors":123}],125:[function(t,o,e){(function(){var s=[].slice,a={}.hasOwnProperty,t=function(){var t,e,n,r,i=arguments[0],o=2<=arguments.length?s.call(arguments,1):[];if(u(Object.assign))Object.assign.apply(null,arguments);else for(t=0,n=o.length;t<n;t++)if(null!=(r=o[t]))for(e in r)a.call(r,e)&&(i[e]=r[e]);return i},u=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},r=function(t){return!!t&&("function"==(t=typeof t)||"object"==t)},n=function(t){return u(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},e=function(t){if(n(t))return!t.length;for(var e in t)if(a.call(t,e))return!1;return!0},i=function(t){var e,n;return r(t)&&(n=Object.getPrototypeOf(t))&&(e=n.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)};o.exports.assign=t,o.exports.isFunction=u,o.exports.isObject=r,o.exports.isArray=n,o.exports.isEmpty=e,o.exports.isPlainObject=i}).call(this)},{}],126:[function(t,e,n){(function(){function t(t,e,n){if(this.options=t.options,this.stringify=t.stringify,null==e)throw new Error("Missing attribute name of element "+t.name);if(null==n)throw new Error("Missing attribute value for attribute "+e+" of element "+t.name);this.name=this.stringify.attName(e),this.value=this.stringify.attValue(n)}e.exports=(t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.set(t).attribute(this)},t)}).call(this)},{}],127:[function(e,r,t){(function(){var t,i={}.hasOwnProperty;function n(t,e){if(n.__super__.constructor.call(this,t),null==e)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(e)}t=e("./XMLNode"),r.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.set(t).cdata(this)},n)}).call(this)},{"./XMLNode":138}],128:[function(e,r,t){(function(){var t,i={}.hasOwnProperty;function n(t,e){if(n.__super__.constructor.call(this,t),null==e)throw new Error("Missing comment text");this.text=this.stringify.comment(e)}t=e("./XMLNode"),r.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.set(t).comment(this)},n)}).call(this)},{"./XMLNode":138}],129:[function(e,n,t){(function(){var t,i={}.hasOwnProperty;function s(t,e,n,r,i,o){if(s.__super__.constructor.call(this,t),null==e)throw new Error("Missing DTD element name");if(null==n)throw new Error("Missing DTD attribute name");if(!r)throw new Error("Missing DTD attribute type");if(!i)throw new Error("Missing DTD attribute default");if(0!==i.indexOf("#")&&(i="#"+i),!i.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(o&&!i.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(e),this.attributeName=this.stringify.attName(n),this.attributeType=this.stringify.dtdAttType(r),this.defaultValue=this.stringify.dtdAttDefault(o),this.defaultValueType=i}t=e("./XMLNode"),n.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(s,t),s.prototype.toString=function(t){return this.options.writer.set(t).dtdAttList(this)},s)}).call(this)},{"./XMLNode":138}],130:[function(e,n,t){(function(){var t,i={}.hasOwnProperty;function r(t,e,n){if(r.__super__.constructor.call(this,t),null==e)throw new Error("Missing DTD element name");n=n||"(#PCDATA)",Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.eleName(e),this.value=this.stringify.dtdElementValue(n)}t=e("./XMLNode"),n.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.set(t).dtdElement(this)},r)}).call(this)},{"./XMLNode":138}],131:[function(e,n,t){(function(){var t,i,o={}.hasOwnProperty;function s(t,e,n,r){if(s.__super__.constructor.call(this,t),null==n)throw new Error("Missing entity name");if(null==r)throw new Error("Missing entity value");if(this.pe=!!e,this.name=this.stringify.eleName(n),i(r)){if(!r.pubID&&!r.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(r.pubID&&!r.sysID)throw new Error("System identifier is required for a public external entity");if(null!=r.pubID&&(this.pubID=this.stringify.dtdPubID(r.pubID)),null!=r.sysID&&(this.sysID=this.stringify.dtdSysID(r.sysID)),null!=r.nData&&(this.nData=this.stringify.dtdNData(r.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}else this.value=this.stringify.dtdEntityValue(r)}i=e("./Utility").isObject,t=e("./XMLNode"),n.exports=(function(t,e){for(var n in e)o.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(s,t),s.prototype.toString=function(t){return this.options.writer.set(t).dtdEntity(this)},s)}).call(this)},{"./Utility":125,"./XMLNode":138}],132:[function(e,n,t){(function(){var t,i={}.hasOwnProperty;function r(t,e,n){if(r.__super__.constructor.call(this,t),null==e)throw new Error("Missing notation name");if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(e),null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}t=e("./XMLNode"),n.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.set(t).dtdNotation(this)},r)}).call(this)},{"./XMLNode":138}],133:[function(e,n,t){(function(){var t,i,o={}.hasOwnProperty;function s(t,e,n,r){s.__super__.constructor.call(this,t),i(e)&&(e=(t=e).version,n=t.encoding,r=t.standalone),e=e||"1.0",this.version=this.stringify.xmlVersion(e),null!=n&&(this.encoding=this.stringify.xmlEncoding(n)),null!=r&&(this.standalone=this.stringify.xmlStandalone(r))}i=e("./Utility").isObject,t=e("./XMLNode"),n.exports=(function(t,e){for(var n in e)o.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(s,t),s.prototype.toString=function(t){return this.options.writer.set(t).declaration(this)},s)}).call(this)},{"./Utility":125,"./XMLNode":138}],134:[function(e,c,t){(function(){var o,n,r,i,t,s,a={}.hasOwnProperty;function u(t,e,n){var r;u.__super__.constructor.call(this,t),this.documentObject=t,s(e)&&(e=(r=e).pubID,n=r.sysID),null==n&&(n=(r=[e,n])[0],e=r[1]),null!=e&&(this.pubID=this.stringify.dtdPubID(e)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}s=e("./Utility").isObject,t=e("./XMLNode"),o=e("./XMLDTDAttList"),r=e("./XMLDTDEntity"),n=e("./XMLDTDElement"),i=e("./XMLDTDNotation"),c.exports=(function(t,e){for(var n in e)a.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(u,t),u.prototype.element=function(t,e){e=new n(this,t,e);return this.children.push(e),this},u.prototype.attList=function(t,e,n,r,i){i=new o(this,t,e,n,r,i);return this.children.push(i),this},u.prototype.entity=function(t,e){e=new r(this,!1,t,e);return this.children.push(e),this},u.prototype.pEntity=function(t,e){e=new r(this,!0,t,e);return this.children.push(e),this},u.prototype.notation=function(t,e){e=new i(this,t,e);return this.children.push(e),this},u.prototype.toString=function(t){return this.options.writer.set(t).docType(this)},u.prototype.ele=function(t,e){return this.element(t,e)},u.prototype.att=function(t,e,n,r,i){return this.attList(t,e,n,r,i)},u.prototype.ent=function(t,e){return this.entity(t,e)},u.prototype.pent=function(t,e){return this.pEntity(t,e)},u.prototype.not=function(t,e){return this.notation(t,e)},u.prototype.up=function(){return this.root()||this.documentObject},u)}).call(this)},{"./Utility":125,"./XMLDTDAttList":129,"./XMLDTDElement":130,"./XMLDTDEntity":131,"./XMLDTDNotation":132,"./XMLNode":138}],135:[function(s,a,t){(function(){var t,e,n,r,i={}.hasOwnProperty;function o(t){o.__super__.constructor.call(this,null),(t=t||{}).writer||(t.writer=new e),this.options=t,this.stringify=new n(t),this.isDocument=!0}r=s("./Utility").isPlainObject,t=s("./XMLNode"),n=s("./XMLStringifier"),e=s("./XMLStringWriter"),a.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(o,t),o.prototype.end=function(t){return t?r(t)&&(t=this.options.writer.set(t)):t=this.options.writer,t.document(this)},o.prototype.toString=function(t){return this.options.writer.set(t).document(this)},o)}).call(this)},{"./Utility":125,"./XMLNode":138,"./XMLStringWriter":142,"./XMLStringifier":143}],136:[function(w,E,t){(function(){var i,e,n,o,r,s,a,u,c,l,h,f,p,d,y,m,_,g,t,b={}.hasOwnProperty;function v(t,e,n){var r;(t=t||{}).writer?g(t.writer)&&(r=t.writer,t.writer=new p(r)):t.writer=new p(t),this.options=t,this.writer=t.writer,this.stringify=new d(t),this.onDataCallback=e||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}t=w("./Utility"),_=t.isObject,m=t.isFunction,g=t.isPlainObject,l=w("./XMLElement"),e=w("./XMLCData"),n=w("./XMLComment"),f=w("./XMLRaw"),y=w("./XMLText"),h=w("./XMLProcessingInstruction"),u=w("./XMLDeclaration"),c=w("./XMLDocType"),o=w("./XMLDTDAttList"),s=w("./XMLDTDEntity"),r=w("./XMLDTDElement"),a=w("./XMLDTDNotation"),i=w("./XMLAttribute"),d=w("./XMLStringifier"),p=w("./XMLStringWriter"),E.exports=(v.prototype.node=function(t,e,n){var r;if(null==t)throw new Error("Missing node name");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node");return this.openCurrent(),t=t.valueOf(),null==e&&(e={}),e=e.valueOf(),_(e)||(n=(r=[e,n])[0],e=r[1]),this.currentNode=new l(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this},v.prototype.element=function(t,e,n){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(t,e,n)},v.prototype.attribute=function(t,e){var n,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode");if(null!=t&&(t=t.valueOf()),_(t))for(n in t)b.call(t,n)&&(r=t[n],this.attribute(n,r));else m(e)&&(e=e.apply()),this.options.skipNullAttributes&&null==e||(this.currentNode.attributes[t]=new i(this,t,e));return this},v.prototype.text=function(t){return this.openCurrent(),t=new y(this,t),this.onData(this.writer.text(t,this.currentLevel+1)),this},v.prototype.cdata=function(t){return this.openCurrent(),t=new e(this,t),this.onData(this.writer.cdata(t,this.currentLevel+1)),this},v.prototype.comment=function(t){return this.openCurrent(),t=new n(this,t),this.onData(this.writer.comment(t,this.currentLevel+1)),this},v.prototype.raw=function(t){return this.openCurrent(),t=new f(this,t),this.onData(this.writer.raw(t,this.currentLevel+1)),this},v.prototype.instruction=function(t,e){var n,r,i,o;if(this.openCurrent(),null!=t&&(t=t.valueOf()),null!=e&&(e=e.valueOf()),Array.isArray(t))for(n=0,o=t.length;n<o;n++)r=t[n],this.instruction(r);else if(_(t))for(r in t)b.call(t,r)&&(i=t[r],this.instruction(r,i));else m(e)&&(e=e.apply()),e=new h(this,t,e),this.onData(this.writer.processingInstruction(e,this.currentLevel+1));return this},v.prototype.declaration=function(t,e,n){if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node");return n=new u(this,t,e,n),this.onData(this.writer.declaration(n,this.currentLevel+1)),this},v.prototype.doctype=function(t,e,n){if(this.openCurrent(),null==t)throw new Error("Missing root node name");if(this.root)throw new Error("dtd() must come before the root node");return this.currentNode=new c(this,e,n),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},v.prototype.dtdElement=function(t,e){return this.openCurrent(),e=new r(this,t,e),this.onData(this.writer.dtdElement(e,this.currentLevel+1)),this},v.prototype.attList=function(t,e,n,r,i){return this.openCurrent(),i=new o(this,t,e,n,r,i),this.onData(this.writer.dtdAttList(i,this.currentLevel+1)),this},v.prototype.entity=function(t,e){return this.openCurrent(),e=new s(this,!1,t,e),this.onData(this.writer.dtdEntity(e,this.currentLevel+1)),this},v.prototype.pEntity=function(t,e){return this.openCurrent(),e=new s(this,!0,t,e),this.onData(this.writer.dtdEntity(e,this.currentLevel+1)),this},v.prototype.notation=function(t,e){return this.openCurrent(),e=new a(this,t,e),this.onData(this.writer.dtdNotation(e,this.currentLevel+1)),this},v.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},v.prototype.end=function(){for(;0<=this.currentLevel;)this.up();return this.onEnd()},v.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},v.prototype.openNode=function(t){if(!t.isOpen)return!this.root&&0===this.currentLevel&&t instanceof l&&(this.root=t),this.onData(this.writer.openNode(t,this.currentLevel)),t.isOpen=!0},v.prototype.closeNode=function(t){if(!t.isClosed)return this.onData(this.writer.closeNode(t,this.currentLevel)),t.isClosed=!0},v.prototype.onData=function(t){return this.documentStarted=!0,this.onDataCallback(t)},v.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},v.prototype.ele=function(){return this.element.apply(this,arguments)},v.prototype.nod=function(t,e,n){return this.node(t,e,n)},v.prototype.txt=function(t){return this.text(t)},v.prototype.dat=function(t){return this.cdata(t)},v.prototype.com=function(t){return this.comment(t)},v.prototype.ins=function(t,e){return this.instruction(t,e)},v.prototype.dec=function(t,e,n){return this.declaration(t,e,n)},v.prototype.dtd=function(t,e,n){return this.doctype(t,e,n)},v.prototype.e=function(t,e,n){return this.element(t,e,n)},v.prototype.n=function(t,e,n){return this.node(t,e,n)},v.prototype.t=function(t){return this.text(t)},v.prototype.d=function(t){return this.cdata(t)},v.prototype.c=function(t){return this.comment(t)},v.prototype.r=function(t){return this.raw(t)},v.prototype.i=function(t,e){return this.instruction(t,e)},v.prototype.att=function(){return(this.currentNode&&this.currentNode instanceof c?this.attList:this.attribute).apply(this,arguments)},v.prototype.a=function(){return(this.currentNode&&this.currentNode instanceof c?this.attList:this.attribute).apply(this,arguments)},v.prototype.ent=function(t,e){return this.entity(t,e)},v.prototype.pent=function(t,e){return this.pEntity(t,e)},v.prototype.not=function(t,e){return this.notation(t,e)},v)}).call(this)},{"./Utility":125,"./XMLAttribute":126,"./XMLCData":127,"./XMLComment":128,"./XMLDTDAttList":129,"./XMLDTDElement":130,"./XMLDTDEntity":131,"./XMLDTDNotation":132,"./XMLDeclaration":133,"./XMLDocType":134,"./XMLElement":137,"./XMLProcessingInstruction":139,"./XMLRaw":140,"./XMLStringWriter":142,"./XMLStringifier":143,"./XMLText":144}],137:[function(e,n,t){(function(){var i,o,s,t,a={}.hasOwnProperty;function r(t,e,n){if(r.__super__.constructor.call(this,t),null==e)throw new Error("Missing element name");this.name=this.stringify.eleName(e),this.attributes={},null!=n&&this.attribute(n),t.isDocument&&(this.isRoot=!0,(this.documentObject=t).rootObject=this)}t=e("./Utility"),s=t.isObject,o=t.isFunction,t=e("./XMLNode"),i=e("./XMLAttribute"),n.exports=(function(t,e){for(var n in e)a.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){var t,e,n,r=Object.create(this);for(e in r.isRoot&&(r.documentObject=null),r.attributes={},n=this.attributes)a.call(n,e)&&(t=n[e],r.attributes[e]=t.clone());return r.children=[],this.children.forEach(function(t){t=t.clone();return(t.parent=r).children.push(t)}),r},r.prototype.attribute=function(t,e){var n,r;if(null!=t&&(t=t.valueOf()),s(t))for(n in t)a.call(t,n)&&(r=t[n],this.attribute(n,r));else o(e)&&(e=e.apply()),this.options.skipNullAttributes&&null==e||(this.attributes[t]=new i(this,t,e));return this},r.prototype.removeAttribute=function(t){var e,n,r;if(null==t)throw new Error("Missing attribute name");if(t=t.valueOf(),Array.isArray(t))for(n=0,r=t.length;n<r;n++)e=t[n],delete this.attributes[e];else delete this.attributes[t];return this},r.prototype.toString=function(t){return this.options.writer.set(t).element(this)},r.prototype.att=function(t,e){return this.attribute(t,e)},r.prototype.a=function(t,e){return this.attribute(t,e)},r)}).call(this)},{"./Utility":125,"./XMLAttribute":126,"./XMLNode":138}],138:[function(c,l,t){(function(){var e,n,i,h,o,s,r,a,p,d,y,t,m={}.hasOwnProperty;function u(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],o||(o=c("./XMLElement"),e=c("./XMLCData"),n=c("./XMLComment"),i=c("./XMLDeclaration"),h=c("./XMLDocType"),r=c("./XMLRaw"),a=c("./XMLText"),s=c("./XMLProcessingInstruction"))}t=c("./Utility"),y=t.isObject,d=t.isFunction,p=t.isEmpty,s=a=r=h=i=n=e=o=null,l.exports=(u.prototype.element=function(t,e,n){var r,i,o,s,a,u,c,l,h,f=null;if(null==e&&(e={}),e=e.valueOf(),y(e)||(n=(l=[e,n])[0],e=l[1]),null!=t&&(t=t.valueOf()),Array.isArray(t))for(o=0,u=t.length;o<u;o++)i=t[o],f=this.element(i);else if(d(t))f=this.element(t.apply());else if(y(t)){for(a in t)if(m.call(t,a))if(h=t[a],d(h)&&(h=h.apply()),y(h)&&p(h)&&(h=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))f=this.attribute(a.substr(this.stringify.convertAttKey.length),h);else if(!this.options.separateArrayItems&&Array.isArray(h))for(s=0,c=h.length;s<c;s++)i=h[s],(r={})[a]=i,f=this.element(r);else y(h)?(f=this.element(a)).element(h):f=this.element(a,h)}else f=!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),n):this.node(t,e,n);if(null==f)throw new Error("Could not create any elements with: "+t);return f},u.prototype.insertBefore=function(t,e,n){var r;if(this.isRoot)throw new Error("Cannot insert elements at root level");return r=this.parent.children.indexOf(this),r=this.parent.children.splice(r),n=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,r),n},u.prototype.insertAfter=function(t,e,n){var r;if(this.isRoot)throw new Error("Cannot insert elements at root level");return r=this.parent.children.indexOf(this),r=this.parent.children.splice(r+1),n=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,r),n},u.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element");return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},u.prototype.node=function(t,e,n){var r;return null!=t&&(t=t.valueOf()),e=(e=e||{}).valueOf(),y(e)||(n=(r=[e,n])[0],e=r[1]),e=new o(this,t,e),null!=n&&e.text(n),this.children.push(e),e},u.prototype.text=function(t){t=new a(this,t);return this.children.push(t),this},u.prototype.cdata=function(t){t=new e(this,t);return this.children.push(t),this},u.prototype.comment=function(t){t=new n(this,t);return this.children.push(t),this},u.prototype.commentBefore=function(t){var e=this.parent.children.indexOf(this),e=this.parent.children.splice(e);this.parent.comment(t);return Array.prototype.push.apply(this.parent.children,e),this},u.prototype.commentAfter=function(t){var e=this.parent.children.indexOf(this),e=this.parent.children.splice(e+1);this.parent.comment(t);return Array.prototype.push.apply(this.parent.children,e),this},u.prototype.raw=function(t){t=new r(this,t);return this.children.push(t),this},u.prototype.instruction=function(t,e){var n,r,i,o;if(null!=t&&(t=t.valueOf()),null!=e&&(e=e.valueOf()),Array.isArray(t))for(i=0,o=t.length;i<o;i++)n=t[i],this.instruction(n);else if(y(t))for(n in t)m.call(t,n)&&(r=t[n],this.instruction(n,r));else d(e)&&(e=e.apply()),e=new s(this,t,e),this.children.push(e);return this},u.prototype.instructionBefore=function(t,e){var n=this.parent.children.indexOf(this),n=this.parent.children.splice(n);this.parent.instruction(t,e);return Array.prototype.push.apply(this.parent.children,n),this},u.prototype.instructionAfter=function(t,e){var n=this.parent.children.indexOf(this),n=this.parent.children.splice(n+1);this.parent.instruction(t,e);return Array.prototype.push.apply(this.parent.children,n),this},u.prototype.declaration=function(t,e,n){var r=this.document(),n=new i(r,t,e,n);return r.children[0]instanceof i?r.children[0]=n:r.children.unshift(n),r.root()||r},u.prototype.doctype=function(t,e){for(var n,r,i,o,s=this.document(),a=new h(s,t,e),u=s.children,c=n=0,l=u.length;n<l;c=++n)if(u[c]instanceof h)return s.children[c]=a;for(c=r=0,i=(o=s.children).length;r<i;c=++r)if(o[c].isRoot)return s.children.splice(c,0,a),a;return s.children.push(a),a},u.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},u.prototype.root=function(){for(var t=this;t;){if(t.isDocument)return t.rootObject;if(t.isRoot)return t;t=t.parent}},u.prototype.document=function(){for(var t=this;t;){if(t.isDocument)return t;t=t.parent}},u.prototype.end=function(t){return this.document().end(t)},u.prototype.prev=function(){var t=this.parent.children.indexOf(this);if(t<1)throw new Error("Already at the first node");return this.parent.children[t-1]},u.prototype.next=function(){var t=this.parent.children.indexOf(this);if(-1===t||t===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[t+1]},u.prototype.importDocument=function(t){t=t.root().clone();return t.parent=this,t.isRoot=!1,this.children.push(t),this},u.prototype.ele=function(t,e,n){return this.element(t,e,n)},u.prototype.nod=function(t,e,n){return this.node(t,e,n)},u.prototype.txt=function(t){return this.text(t)},u.prototype.dat=function(t){return this.cdata(t)},u.prototype.com=function(t){return this.comment(t)},u.prototype.ins=function(t,e){return this.instruction(t,e)},u.prototype.doc=function(){return this.document()},u.prototype.dec=function(t,e,n){return this.declaration(t,e,n)},u.prototype.dtd=function(t,e){return this.doctype(t,e)},u.prototype.e=function(t,e,n){return this.element(t,e,n)},u.prototype.n=function(t,e,n){return this.node(t,e,n)},u.prototype.t=function(t){return this.text(t)},u.prototype.d=function(t){return this.cdata(t)},u.prototype.c=function(t){return this.comment(t)},u.prototype.r=function(t){return this.raw(t)},u.prototype.i=function(t,e){return this.instruction(t,e)},u.prototype.u=function(){return this.up()},u.prototype.importXMLBuilder=function(t){return this.importDocument(t)},u)}).call(this)},{"./Utility":125,"./XMLCData":127,"./XMLComment":128,"./XMLDeclaration":133,"./XMLDocType":134,"./XMLElement":137,"./XMLProcessingInstruction":139,"./XMLRaw":140,"./XMLText":144}],139:[function(e,n,t){(function(){var t,i={}.hasOwnProperty;function r(t,e,n){if(r.__super__.constructor.call(this,t),null==e)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(e),n&&(this.value=this.stringify.insValue(n))}t=e("./XMLNode"),n.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.set(t).processingInstruction(this)},r)}).call(this)},{"./XMLNode":138}],140:[function(e,r,t){(function(){var t,i={}.hasOwnProperty;function n(t,e){if(n.__super__.constructor.call(this,t),null==e)throw new Error("Missing raw text");this.value=this.stringify.raw(e)}t=e("./XMLNode"),r.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.set(t).raw(this)},n)}).call(this)},{"./XMLNode":138}],141:[function(e,r,t){(function(){var l,h,s,a,u,c,f,p,d,y,m,_,t,g={}.hasOwnProperty;function n(t,e){n.__super__.constructor.call(this,e),this.stream=t}f=e("./XMLDeclaration"),p=e("./XMLDocType"),l=e("./XMLCData"),h=e("./XMLComment"),d=e("./XMLElement"),m=e("./XMLRaw"),_=e("./XMLText"),y=e("./XMLProcessingInstruction"),s=e("./XMLDTDAttList"),a=e("./XMLDTDElement"),u=e("./XMLDTDEntity"),c=e("./XMLDTDNotation"),t=e("./XMLWriterBase"),r.exports=(function(t,e){for(var n in e)g.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.document=function(t){for(var e,n,r,i,o,s=t.children,a=0,u=s.length;a<u;a++)(e=s[a]).isLastRootNode=!1;for(t.children[t.children.length-1].isLastRootNode=!0,o=[],n=0,r=(i=t.children).length;n<r;n++)switch(!1){case!((e=i[n])instanceof f):o.push(this.declaration(e));break;case!(e instanceof p):o.push(this.docType(e));break;case!(e instanceof h):o.push(this.comment(e));break;case!(e instanceof y):o.push(this.processingInstruction(e));break;default:o.push(this.element(e))}return o},n.prototype.attribute=function(t){return this.stream.write(" "+t.name+'="'+t.value+'"')},n.prototype.cdata=function(t,e){return this.stream.write(this.space(e)+"<![CDATA["+t.text+"]]>"+this.endline(t))},n.prototype.comment=function(t,e){return this.stream.write(this.space(e)+"\x3c!-- "+t.text+" --\x3e"+this.endline(t))},n.prototype.declaration=function(t,e){return this.stream.write(this.space(e)),this.stream.write('<?xml version="'+t.version+'"'),null!=t.encoding&&this.stream.write(' encoding="'+t.encoding+'"'),null!=t.standalone&&this.stream.write(' standalone="'+t.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(t))},n.prototype.docType=function(t,e){var n,r,i,o;if(e=e||0,this.stream.write(this.space(e)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),0<t.children.length){for(this.stream.write(" ["),this.stream.write(this.endline(t)),r=0,i=(o=t.children).length;r<i;r++)switch(!1){case!((n=o[r])instanceof s):this.dtdAttList(n,e+1);break;case!(n instanceof a):this.dtdElement(n,e+1);break;case!(n instanceof u):this.dtdEntity(n,e+1);break;case!(n instanceof c):this.dtdNotation(n,e+1);break;case!(n instanceof l):this.cdata(n,e+1);break;case!(n instanceof h):this.comment(n,e+1);break;case!(n instanceof y):this.processingInstruction(n,e+1);break;default:throw new Error("Unknown DTD node type: "+n.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(t))},n.prototype.element=function(t,e){var n,r,i,o,s,a,u,c;for(s in e=e||0,c=this.space(e),this.stream.write(c+"<"+t.name),a=t.attributes)g.call(a,s)&&(n=a[s],this.attribute(n));if(0===t.children.length||t.children.every(function(t){return""===t.value}))this.allowEmpty?this.stream.write("></"+t.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&1===t.children.length&&null!=t.children[0].value)this.stream.write(">"),this.stream.write(t.children[0].value),this.stream.write("</"+t.name+">");else{for(this.stream.write(">"+this.newline),i=0,o=(u=t.children).length;i<o;i++)switch(!1){case!((r=u[i])instanceof l):this.cdata(r,e+1);break;case!(r instanceof h):this.comment(r,e+1);break;case!(r instanceof d):this.element(r,e+1);break;case!(r instanceof m):this.raw(r,e+1);break;case!(r instanceof _):this.text(r,e+1);break;case!(r instanceof y):this.processingInstruction(r,e+1);break;default:throw new Error("Unknown XML node type: "+r.constructor.name)}this.stream.write(c+"</"+t.name+">")}return this.stream.write(this.endline(t))},n.prototype.processingInstruction=function(t,e){return this.stream.write(this.space(e)+"<?"+t.target),t.value&&this.stream.write(" "+t.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(t))},n.prototype.raw=function(t,e){return this.stream.write(this.space(e)+t.value+this.endline(t))},n.prototype.text=function(t,e){return this.stream.write(this.space(e)+t.value+this.endline(t))},n.prototype.dtdAttList=function(t,e){return this.stream.write(this.space(e)+"<!ATTLIST "+t.elementName+" "+t.attributeName+" "+t.attributeType),"#DEFAULT"!==t.defaultValueType&&this.stream.write(" "+t.defaultValueType),t.defaultValue&&this.stream.write(' "'+t.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(t))},n.prototype.dtdElement=function(t,e){return this.stream.write(this.space(e)+"<!ELEMENT "+t.name+" "+t.value),this.stream.write(this.spacebeforeslash+">"+this.endline(t))},n.prototype.dtdEntity=function(t,e){return this.stream.write(this.space(e)+"<!ENTITY"),t.pe&&this.stream.write(" %"),this.stream.write(" "+t.name),t.value?this.stream.write(' "'+t.value+'"'):(t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.nData&&this.stream.write(" NDATA "+t.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(t))},n.prototype.dtdNotation=function(t,e){return this.stream.write(this.space(e)+"<!NOTATION "+t.name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.pubID?this.stream.write(' PUBLIC "'+t.pubID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(t))},n.prototype.endline=function(t){return t.isLastRootNode?"":this.newline},n)}).call(this)},{"./XMLCData":127,"./XMLComment":128,"./XMLDTDAttList":129,"./XMLDTDElement":130,"./XMLDTDEntity":131,"./XMLDTDNotation":132,"./XMLDeclaration":133,"./XMLDocType":134,"./XMLElement":137,"./XMLProcessingInstruction":139,"./XMLRaw":140,"./XMLText":144,"./XMLWriterBase":145}],142:[function(n,r,t){(function(){var y,m,a,u,c,l,s,h,_,g,b,v,t,w={}.hasOwnProperty;function e(t){e.__super__.constructor.call(this,t)}s=n("./XMLDeclaration"),h=n("./XMLDocType"),y=n("./XMLCData"),m=n("./XMLComment"),_=n("./XMLElement"),b=n("./XMLRaw"),v=n("./XMLText"),g=n("./XMLProcessingInstruction"),a=n("./XMLDTDAttList"),u=n("./XMLDTDElement"),c=n("./XMLDTDEntity"),l=n("./XMLDTDNotation"),t=n("./XMLWriterBase"),r.exports=(function(t,e){for(var n in e)w.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),e.prototype.document=function(t){var e,n,r,i,o;for(this.textispresent=!1,i="",n=0,r=(o=t.children).length;n<r;n++)e=o[n],i+=function(){switch(!1){case!(e instanceof s):return this.declaration(e);case!(e instanceof h):return this.docType(e);case!(e instanceof m):return this.comment(e);case!(e instanceof g):return this.processingInstruction(e);default:return this.element(e,0)}}.call(this);return this.pretty&&i.slice(-this.newline.length)===this.newline&&(i=i.slice(0,-this.newline.length)),i},e.prototype.attribute=function(t){return" "+t.name+'="'+t.value+'"'},e.prototype.cdata=function(t,e){return this.space(e)+"<![CDATA["+t.text+"]]>"+this.newline},e.prototype.comment=function(t,e){return this.space(e)+"\x3c!-- "+t.text+" --\x3e"+this.newline},e.prototype.declaration=function(t,e){e=this.space(e);return e+='<?xml version="'+t.version+'"',null!=t.encoding&&(e+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(e+=' standalone="'+t.standalone+'"'),e+=this.spacebeforeslash+"?>",e+=this.newline},e.prototype.docType=function(t,e){var n,r,i,o,s;if(e=e||0,o=this.space(e),o+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?o+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(o+=' SYSTEM "'+t.sysID+'"'),0<t.children.length){for(o+=" [",o+=this.newline,r=0,i=(s=t.children).length;r<i;r++)n=s[r],o+=function(){switch(!1){case!(n instanceof a):return this.dtdAttList(n,e+1);case!(n instanceof u):return this.dtdElement(n,e+1);case!(n instanceof c):return this.dtdEntity(n,e+1);case!(n instanceof l):return this.dtdNotation(n,e+1);case!(n instanceof y):return this.cdata(n,e+1);case!(n instanceof m):return this.comment(n,e+1);case!(n instanceof g):return this.processingInstruction(n,e+1);default:throw new Error("Unknown DTD node type: "+n.constructor.name)}}.call(this);o+="]"}return o+=this.spacebeforeslash+">",o+=this.newline},e.prototype.element=function(t,e){var n,r,i,o,s,a,u,c,l,h,f,p,d;for(u in e=e||0,d=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),c="",c+=(p=this.space(e))+"<"+t.name,l=t.attributes)w.call(l,u)&&(n=l[u],c+=this.attribute(n));if(0===t.children.length||t.children.every(function(t){return""===t.value}))this.allowEmpty?c+="></"+t.name+">"+this.newline:c+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&1===t.children.length&&null!=t.children[0].value)c+=">",c+=t.children[0].value,c+="</"+t.name+">"+this.newline;else{if(this.dontprettytextnodes)for(i=0,s=(h=t.children).length;i<s;i++)if(null!=(r=h[i]).value){this.textispresent++,d=!0;break}for(this.textispresent&&(this.newline="",this.pretty=!1,p=this.space(e)),c+=">"+this.newline,o=0,a=(f=t.children).length;o<a;o++)r=f[o],c+=function(){switch(!1){case!(r instanceof y):return this.cdata(r,e+1);case!(r instanceof m):return this.comment(r,e+1);case!(r instanceof _):return this.element(r,e+1);case!(r instanceof b):return this.raw(r,e+1);case!(r instanceof v):return this.text(r,e+1);case!(r instanceof g):return this.processingInstruction(r,e+1);default:throw new Error("Unknown XML node type: "+r.constructor.name)}}.call(this);d&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),c+=p+"</"+t.name+">"+this.newline}return c},e.prototype.processingInstruction=function(t,e){e=this.space(e)+"<?"+t.target;return t.value&&(e+=" "+t.value),e+=this.spacebeforeslash+"?>"+this.newline},e.prototype.raw=function(t,e){return this.space(e)+t.value+this.newline},e.prototype.text=function(t,e){return this.space(e)+t.value+this.newline},e.prototype.dtdAttList=function(t,e){e=this.space(e)+"<!ATTLIST "+t.elementName+" "+t.attributeName+" "+t.attributeType;return"#DEFAULT"!==t.defaultValueType&&(e+=" "+t.defaultValueType),t.defaultValue&&(e+=' "'+t.defaultValue+'"'),e+=this.spacebeforeslash+">"+this.newline},e.prototype.dtdElement=function(t,e){return this.space(e)+"<!ELEMENT "+t.name+" "+t.value+this.spacebeforeslash+">"+this.newline},e.prototype.dtdEntity=function(t,e){e=this.space(e)+"<!ENTITY";return t.pe&&(e+=" %"),e+=" "+t.name,t.value?e+=' "'+t.value+'"':(t.pubID&&t.sysID?e+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(e+=' SYSTEM "'+t.sysID+'"'),t.nData&&(e+=" NDATA "+t.nData)),e+=this.spacebeforeslash+">"+this.newline},e.prototype.dtdNotation=function(t,e){e=this.space(e)+"<!NOTATION "+t.name;return t.pubID&&t.sysID?e+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?e+=' PUBLIC "'+t.pubID+'"':t.sysID&&(e+=' SYSTEM "'+t.sysID+'"'),e+=this.spacebeforeslash+">"+this.newline},e.prototype.openNode=function(t,e){var n,r,i,o;if(e=e||0,t instanceof _){for(r in i=this.space(e)+"<"+t.name,o=t.attributes)w.call(o,r)&&(n=o[r],i+=this.attribute(n));return i+=(t.children?">":"/>")+this.newline}return i=this.space(e)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),i+=(t.children?" [":">")+this.newline},e.prototype.closeNode=function(t,e){switch(e=e||0,!1){case!(t instanceof _):return this.space(e)+"</"+t.name+">"+this.newline;case!(t instanceof h):return this.space(e)+"]>"+this.newline}},e)}).call(this)},{"./XMLCData":127,"./XMLComment":128,"./XMLDTDAttList":129,"./XMLDTDElement":130,"./XMLDTDEntity":131,"./XMLDTDNotation":132,"./XMLDeclaration":133,"./XMLDocType":134,"./XMLElement":137,"./XMLProcessingInstruction":139,"./XMLRaw":140,"./XMLText":144,"./XMLWriterBase":145}],143:[function(t,e,n){(function(){var s={}.hasOwnProperty;function t(t){var e,n,r,i,o;for(r in this.assertLegalChar=(e=this.assertLegalChar,n=this,function(){return e.apply(n,arguments)}),t=t||{},this.noDoubleEncoding=t.noDoubleEncoding,i=t.stringify||{})s.call(i,r)&&(o=i[r],this[r]=o)}e.exports=(t.prototype.eleName=function(t){return t=""+t||"",this.assertLegalChar(t)},t.prototype.eleText=function(t){return t=""+t||"",this.assertLegalChar(this.elEscape(t))},t.prototype.cdata=function(t){return t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t)},t.prototype.comment=function(t){if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return""+t||""},t.prototype.attName=function(t){return""+t||""},t.prototype.attValue=function(t){return t=""+t||"",this.attEscape(t)},t.prototype.insTarget=function(t){return""+t||""},t.prototype.insValue=function(t){if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return t},t.prototype.xmlVersion=function(t){if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return t},t.prototype.xmlStandalone=function(t){return t?"yes":"no"},t.prototype.dtdPubID=function(t){return""+t||""},t.prototype.dtdSysID=function(t){return""+t||""},t.prototype.dtdElementValue=function(t){return""+t||""},t.prototype.dtdAttType=function(t){return""+t||""},t.prototype.dtdAttDefault=function(t){return null!=t?""+t||"":t},t.prototype.dtdEntityValue=function(t){return""+t||""},t.prototype.dtdNData=function(t){return""+t||""},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e=t.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/);if(e)throw new Error("Invalid character in string: "+t+" at index "+e.index);return t},t.prototype.elEscape=function(t){var e=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g;return t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},t.prototype.attEscape=function(t){var e=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g;return t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},t)}).call(this)},{}],144:[function(e,r,t){(function(){var t,i={}.hasOwnProperty;function n(t,e){if(n.__super__.constructor.call(this,t),null==e)throw new Error("Missing element text");this.value=this.stringify.eleText(e)}t=e("./XMLNode"),r.exports=(function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.set(t).text(this)},n)}).call(this)},{"./XMLNode":138}],145:[function(t,e,n){(function(){var s={}.hasOwnProperty;function t(t){var e,n,r,i,o;for(e in t=t||{},this.pretty=t.pretty||!1,this.allowEmpty=null!=(n=t.allowEmpty)&&n,this.pretty?(this.indent=null!=(r=t.indent)?r:"  ",this.newline=null!=(r=t.newline)?r:"\n",this.offset=null!=(r=t.offset)?r:0,this.dontprettytextnodes=null!=(r=t.dontprettytextnodes)?r:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=null!=(r=t.spacebeforeslash)?r:"",!0===this.spacebeforeslash&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,i=t.writer||{})s.call(i,e)&&(o=i[e],this[e]=o)}e.exports=(t.prototype.set=function(t){var e,n,r;for(e in"pretty"in(t=t||{})&&(this.pretty=t.pretty),"allowEmpty"in t&&(this.allowEmpty=t.allowEmpty),this.pretty?(this.indent="indent"in t?t.indent:"  ",this.newline="newline"in t?t.newline:"\n",this.offset="offset"in t?t.offset:0,this.dontprettytextnodes="dontprettytextnodes"in t?t.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in t?t.spacebeforeslash:"",!0===this.spacebeforeslash&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,n=t.writer||{})s.call(n,e)&&(r=n[e],this[e]=r);return this},t.prototype.space=function(t){var e;return this.pretty&&0<(e=(t||0)+this.offset+1)?new Array(e).join(this.indent):""},t)}).call(this)},{}],146:[function(r,u,t){(function(){var t=r("./Utility"),i=t.assign,o=t.isFunction,s=r("./XMLDocument"),a=r("./XMLDocumentCB"),e=r("./XMLStringWriter"),n=r("./XMLStreamWriter");u.exports.create=function(t,e,n,r){if(null==t)throw new Error("Root element needs a name");return r=i({},e,n,r),t=(n=new s(r)).element(t),r.headless||(n.declaration(r),null==r.pubID&&null==r.sysID||n.doctype(r)),t},u.exports.begin=function(t,e,n){var r;return o(t)&&(e=(r=[t,e])[0],n=r[1],t={}),e?new a(t,e,n):new s(t)},u.exports.stringWriter=function(t){return new e(t)},u.exports.streamWriter=function(t,e){return new n(t,e)}}).call(this)},{"./Utility":125,"./XMLDocument":135,"./XMLDocumentCB":136,"./XMLStreamWriter":141,"./XMLStringWriter":142}]},{},[1])(1)});
//# sourceMappingURL=jsforce.min.js.map
